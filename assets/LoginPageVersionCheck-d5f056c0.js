import{R as N,e as T,u as re,o as e,l as A,T as ae,U as ne,m as E,a5 as K,a6 as z}from"./index-179efefa.js";import{u as O,a as le,b as oe,N as M,M as ie,F as Y,c as G,L as ce,B as ue,d as de,P as me,e as V,f as pe,g as xe,h as fe,i as he,j as ge,k as je,l as be}from"./App-5691a897.js";var U=function(a){return typeof a=="object"&&a!==null},ve=function(a){var l=a.value,o=l===void 0?"":l,i=a.numInputs,n=i===void 0?4:i,s=a.onChange,m=a.onPaste,h=a.renderInput,g=a.shouldAutoFocus,p=g===void 0?!1:g,j=a.inputType,I=j===void 0?"text":j,P=a.renderSeparator,w=a.placeholder,S=a.containerStyle,x=a.inputStyle,L=a.skipDefaultStyles,D=L===void 0?!1:L,v=N.useState(0),u=v[0],F=v[1],f=N.useRef([]),k=function(){return o?o.toString().split(""):[]},B=I==="number"||I==="tel";N.useEffect(function(){f.current=f.current.slice(0,n)},[n]),N.useEffect(function(){var t;p&&((t=f.current[0])===null||t===void 0||t.focus())},[p]);var J=function(){if(typeof w=="string"){if(w.length===n)return w;w.length>0&&console.error("Length of the placeholder should be equal to the number of inputs.")}},R=function(t){var r=B?!isNaN(Number(t)):typeof t=="string";return r&&t.trim().length===1},W=function(t){var r=t.target.value;R(r)&&(C(r),y(u+1))},X=function(t){var r=t.nativeEvent,c=t.target.value;if(!R(c)){if(c.length===n){var d=c.split("").some(function(b){return!R(b)});d||(q(c.split("")),y(n-1))}r.data===null&&r.inputType==="deleteContentBackward"&&(t.preventDefault(),C(""),y(u-1)),t.target.value=""}},Z=function(t){return function(r){F(r),t.target.select()}},$=function(){F(u-1)},ee=function(t){var r=k();[t.code,t.key].includes("Backspace")?(t.preventDefault(),C(""),y(u-1)):t.code==="Delete"?(t.preventDefault(),C("")):t.code==="ArrowLeft"?(t.preventDefault(),y(u-1)):t.code==="ArrowRight"||t.key===r[u]?(t.preventDefault(),y(u+1)):(t.code==="Spacebar"||t.code==="Space"||t.code==="ArrowUp"||t.code==="ArrowDown")&&t.preventDefault()},y=function(t){var r,c,d=Math.max(Math.min(n-1,t),0);f.current[d]&&((r=f.current[d])===null||r===void 0||r.focus(),(c=f.current[d])===null||c===void 0||c.select(),F(d))},C=function(t){var r=k();r[u]=t[0],q(r)},q=function(t){var r=t.join("");s(r)},te=function(t){var r;t.preventDefault();var c=k(),d=u,b=t.clipboardData.getData("text/plain").slice(0,n-u).split("");if(!(B&&b.some(function(se){return isNaN(Number(se))}))){for(var _=0;_<n;++_)_>=u&&b.length>0&&(c[_]=(r=b.shift())!==null&&r!==void 0?r:"",d++);y(d),q(c)}};return N.createElement("div",{style:Object.assign({display:"flex",alignItems:"center"},U(S)&&S),className:typeof S=="string"?S:void 0,onPaste:m},Array.from({length:n},function(t,r){return r}).map(function(t){var r,c,d;return N.createElement(N.Fragment,{key:t},h({value:(r=k()[t])!==null&&r!==void 0?r:"",placeholder:(d=(c=J())===null||c===void 0?void 0:c[t])!==null&&d!==void 0?d:void 0,ref:function(b){return f.current[t]=b},onChange:W,onFocus:function(b){return Z(b)(t)},onBlur:$,onKeyDown:ee,onPaste:te,autoComplete:"off","aria-label":"Please enter OTP character ".concat(t+1),style:Object.assign(D?{}:{width:"1em",textAlign:"center"},U(x)?x:{}),className:typeof x=="string"?x:void 0,type:I,inputMode:B?"numeric":"text",onInput:X},t),t<n-1&&(typeof P=="function"?P(t):P))}))};const Q=({redirectTo:a=null})=>{const[l,o]=T.useState(!1),[i,n]=T.useState(""),[s,m]=T.useState(!1),{state:h}=O(),{email:g,password:p,member_id:j}=h||{},{axiosInstance:I}=le(),P=re(),w=oe();if(!g||!p||!j)return e.jsx(M,{to:"/login",from:{redirectTo:a}});const S=async x=>{var L,D;if(x.preventDefault(),!!i){o(!0);try{const v=await I.post("/user/secure-login-otp",{email:g,password:p,member_id:j,otp:i,save_device:s?"yes":"no"});if(((L=v.data)==null?void 0:L.status)==="success"){const{login_key:u,member_id:F,token:f}=v.data;localStorage.setItem("user_info",JSON.stringify({login_key:u,member_id:F,token:f})),A.update(k=>{k.token=f}),P.invalidateQueries({queryKey:["USER_INFO"]}),ae(),a&&w(a)}else throw new Error(((D=v.data)==null?void 0:D.reason)||"Something wrong!")}catch(v){ne("error","Failed!",v.message)}finally{o(!1)}}};return l?e.jsx(ie,{}):e.jsxs("form",{onSubmit:S,children:[e.jsx("p",{className:"mb-8 text-sm text-center text-neutral/80",children:"Please enter the OTP, sent to your email"}),e.jsxs("div",{className:"flex flex-col w-full gap-y-4",children:[e.jsx("div",{className:"flex items-center justify-center mb-3",children:e.jsx(ve,{value:i,onChange:n,numInputs:5,renderSeparator:e.jsx("span",{}),renderInput:x=>e.jsx("input",{...x,className:"!w-12 rounded input input-bordered !outline-0 bg-transparent mx-1"})})}),e.jsx("div",{className:"flex justify-between",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-neutral",children:[e.jsx("input",{type:"checkbox",className:"toggle border-primary bg-primary",checked:s,onChange:x=>m(x.target.checked)}),e.jsx("span",{children:"Save device"})]})}),e.jsxs("button",{type:"submit",className:"h-10 min-h-0 font-normal normal-case transition-all duration-300 rounded-full shadow-lg btn btn-primary shadow-primary/50 hover:shadow-none",children:["Log In ",e.jsx(Y,{})]})]})]})},ye=()=>{const{isLoading:a,user_data:l}=A.useState(),{site_title:o,intro_video:i,intro_banner:n,system_config:s,logo:m}=E.useState(),[h]=G(),g=h.get("otp_required"),{state:p}=O(),j=(p==null?void 0:p.pathname)||"/";return a?e.jsx(K,{}):l!=null&&l.login_key?e.jsx(M,{to:j}):e.jsxs("div",{style:{backgroundImage:"linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))",backgroundSize:"cover",backgroundBlendMode:"multiply"},children:[e.jsx(z,{children:e.jsxs("title",{children:["Login",o?" - "+o:""]})}),i&&e.jsx("video",{id:"background-video",src:i,poster:n,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,children:"Your browser does not support the video tag."}),e.jsxs("main",{className:"grid min-h-screen mx-auto md:grid-cols-2 lg:grid-cols-3 max-w-screen-2xl",children:[e.jsx("div",{className:"lg:col-span-2"}),e.jsxs("div",{className:"flex flex-col items-center justify-between min-h-screen px-8 py-4 md:px-12 bg-base-200/70",children:[e.jsxs("div",{className:"my-auto",children:[e.jsxs("div",{className:"flex flex-col items-center mb-5",children:[e.jsx("div",{className:"flex items-center justify-center w-16 h-16 mb-2 overflow-hidden border rounded-full border-neutral/10",children:e.jsx("img",{src:m,alt:"logo",className:"object-cover object-center w-full"})}),e.jsx("h1",{className:"text-xl font-semibold",children:o})]}),g==="yes"?e.jsx(Q,{redirectTo:j}):e.jsx(ce,{redirectTo:j}),((s==null?void 0:s.support_contact_no)||(s==null?void 0:s.support_email))&&e.jsxs("div",{className:"mt-8 text-center justify-self-end text-neutral",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx("hr",{className:"w-16 border-secondary"}),e.jsx("span",{className:"text-secondary",children:"Contact"}),e.jsx("hr",{className:"w-16 border-secondary"})]}),(s==null?void 0:s.support_contact_no)&&e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"inline-flex items-center justify-center p-1 border rounded-full border-secondary text-secondary",children:e.jsx(ue,{})}),e.jsx("p",{className:"text-sm text-neutral",children:s==null?void 0:s.support_contact_no})]}),(s==null?void 0:s.support_email)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"inline-flex items-center justify-center p-1 border rounded-full border-secondary text-secondary",children:[" ",e.jsx(de,{})]}),e.jsx("p",{className:"text-sm text-neutral",children:s==null?void 0:s.support_email})]})]})]}),e.jsx("div",{className:"pt-5 text-sm text-center justify-self-end text-neutral/90",children:e.jsxs("p",{children:[" ","Copyright ",new Date().getFullYear()," Â© ",s==null?void 0:s.copyright]})})]})]})]})},H=({redirectTo:a=null})=>{var n;const{component_version:l}=E.useState(),[o,i]=T.useState(!1);return e.jsxs("div",{children:[e.jsx("p",{className:"mb-8 text-sm text-center text-neutral/80",children:"Please login to continue"}),((n=l==null?void 0:l.general)==null?void 0:n.dashboard)==="3"&&e.jsx("div",{className:"relative p-3 mb-3 border rounded border-warning/50 bg-warning/10 text-warning",children:e.jsxs("p",{className:"text-xs",children:["If you are having trouble logging in with your old password, please"," ",e.jsx(V,{to:"/forgot-password",className:"text-secondary",children:"RESET"})," ","your password."]})}),e.jsx(pe,{redirectTo:a,children:e.jsxs("div",{className:"flex flex-col w-full gap-y-4",children:[e.jsxs("label",{className:"gap-2 form-control",children:[e.jsx("span",{className:"text-[13px] text-neutral",children:"Email"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("input",{autoComplete:"off",type:"email",name:"email",className:"flex-1 h-10 pr-10 text-sm border rounded-full input input-bordered border-base-content/10 bg-base-200 focus:outline-0 min-h-8 focus:border-primary",placeholder:"Enter Email"}),e.jsx("span",{className:"absolute flex items-center justify-center w-8 h-8 text-lg rounded-full right-1.5 bg-base-100 text-neutral",children:e.jsx(xe,{})})]})]}),e.jsxs("label",{className:"gap-2 form-control",children:[e.jsx("span",{className:"text-[13px] text-neutral",children:"Password"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("input",{autoComplete:"off",type:o?"text":"password",name:"password","data-type":"password",className:"flex-1 h-10 pr-10 text-sm border rounded-full input input-bordered border-base-content/10 bg-base-200 focus:outline-0 min-h-8 focus:border-primary",placeholder:"Password"}),e.jsx("span",{className:"absolute flex items-center justify-center w-8 h-8 text-lg rounded-full right-1.5 bg-base-100 text-neutral",children:e.jsx(fe,{})})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer text-neutral",children:[e.jsx("input",{type:"checkbox",className:"toggle toggle-xs border-neutral bg-neutral",checked:o,onChange:s=>i(s.target.checked)}),e.jsx("span",{children:"Show Password"})]}),e.jsxs(V,{to:"/forgot-password",className:"text-sm text-neutral",children:[e.jsx(he,{})," Forgot password?"]})]}),e.jsxs("button",{type:"submit",className:"h-10 min-h-0 font-normal normal-case transition-all duration-300 rounded-full shadow-lg btn btn-primary shadow-primary/50 hover:shadow-none",children:["Log In ",e.jsx(Y,{})]})]})})]})};H.propTypes={redirectTo:me.string};const Ne=()=>{const{isLoading:a,user_data:l}=A.useState(),{site_title:o,intro_video:i,intro_banner:n,logo:s}=E.useState(),{state:m}=O(),h=!(m!=null&&m.pathname)||m.pathname==="/"?"/":m.pathname,[g]=G(),p=g.get("otp_required");return a?e.jsx(K,{}):l!=null&&l.login_key?e.jsx(M,{to:h}):e.jsxs("div",{style:{backgroundImage:"linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))",backgroundSize:"cover",backgroundBlendMode:"multiply"},children:[e.jsx(z,{children:e.jsxs("title",{children:["Login",o?" - "+o:""]})}),i&&e.jsx("video",{id:"background-video",src:i,poster:n,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,children:"Your browser does not support the video tag."}),e.jsx("main",{className:"flex items-center justify-center min-h-screen gap-4 px-5 py-16",children:e.jsxs("div",{className:"w-full max-w-lg",children:[e.jsxs("div",{className:"relative w-full p-8 mb-4 shadow-lg rounded-2xl bg-base-200",children:[e.jsx("div",{className:"absolute top-0 z-10 flex items-center justify-center p-1 mb-2 overflow-hidden -translate-x-1/2 -translate-y-1/2 border rounded-lg h-14 border-neutral/10 left-1/2 bg-base-200",children:e.jsx("img",{src:s,alt:"logo",className:"object-cover object-center w-full h-full"})}),e.jsx("div",{className:"flex flex-col items-center pt-4 mt-2 mb-3",children:e.jsxs("h1",{className:"text-xl font-semibold",children:["Let's Get Started ",o]})}),p==="yes"?e.jsx(Q,{redirectTo:h}):e.jsx(H,{redirectTo:h})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-3",children:[e.jsx("hr",{className:"w-20 border-b-2 border-primary"}),e.jsx("span",{className:"text-white",children:"Or Login With"}),e.jsx("hr",{className:"w-20 border-b-2 border-primary"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx("span",{className:"flex items-center justify-center text-white bg-blue-500 rounded-full cursor-pointer hover:bg-blue-400 w-9 h-9",children:e.jsx(ge,{})}),e.jsx("span",{className:"flex items-center justify-center text-white rounded-full cursor-pointer w-9 h-9 bg-cyan-500 hover:bg-cyan-400",children:e.jsx(je,{})}),e.jsx("span",{className:"flex items-center justify-center text-white bg-pink-500 rounded-full cursor-pointer hover:bg-pink-400 w-9 h-9",children:e.jsx(be,{})})]}),e.jsx("div",{className:"flex items-center justify-center gap-2 mt-5 mb-3",children:e.jsx("span",{className:"text-white",children:"Or"})}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"my-animated-button",children:e.jsx(V,{to:"/register",children:"Apply for an Agent Account"})})})]})]})})]})},ke=()=>{const{isLoading:a,user_data:l}=A.useState(),{general:o}=E.useState(s=>s.component_version)||{},{state:i}=O(),n=(i==null?void 0:i.pathname)||"/";return a?e.jsx(K,{}):l!=null&&l.login_key?e.jsx(M,{to:n}):(o==null?void 0:o.login)==="2"?e.jsx(Ne,{}):e.jsx(ye,{})};export{ke as default};
