import{m as F,l as M,e as k,o as s,a6 as D,Q as E}from"./index-179efefa.js";import{a as H,w as P,ap as q}from"./App-5691a897.js";const B=()=>{const{site_title:p,system_config:S}=F.useState(),{axiosInstance:v}=H(),{user_data:{login_key:f,member_id:j}}=M.useState(),[g,d]=k.useState([]),{data:b={},isLoading:W,error:N}=P({queryKey:["ACCESS_LOGS",f,j],queryFn:async()=>{const t=await v.post("/user/team-members-logs",{login_key:f,member_id:j});return d(t.data),t.data}}),A=t=>{var w,L,C,y;const r=t.target.value.toLowerCase();if(r.trim().length>0){const m=[],h=[],x=[],u=[],_=[];for(const e of b){const c=(w=e==null?void 0:e.fullname)==null?void 0:w.toLowerCase(),o=(L=e==null?void 0:e.ip_address)==null?void 0:L.toLowerCase(),l=(C=e==null?void 0:e.ip_location)==null?void 0:C.toLowerCase(),n=(y=e==null?void 0:e.ip_country_code)==null?void 0:y.toLowerCase(),I=`${c} ${o} ${l} ${n}`;if(c!=null&&c.startsWith(r))m.push(e);else if(o!=null&&o.startsWith(r))h.push(e);else if(l!=null&&l.startsWith(r))x.push(e);else if(n!=null&&n.startsWith(r))u.push(e);else{const i=r.trim().split(" ").filter(a=>!!a.trim());i.some(a=>c==null?void 0:c.startsWith(a))?m.push(e):i.some(a=>o==null?void 0:o.startsWith(a))?h.push(e):i.some(a=>l==null?void 0:l.startsWith(a))?x.push(e):i.some(a=>n==null?void 0:n.startsWith(a))?u.push(e):i.some(a=>I.includes(a))&&_.push(e)}const $=m.concat(h,x,u,_);d($)}}else d(b)};if(N)throw N;return s.jsxs(s.Fragment,{children:[s.jsx(D,{children:s.jsxs("title",{children:["Access Logs",p?" - "+p:""]})}),s.jsx("div",{className:"mb-8 sm:col-span-3 lg:col-span-4",children:W?s.jsxs("div",{className:"flex items-center justify-center h-full gap-2 text-xl min-h-[400px]",children:[s.jsx(q,{className:"mr-2 animate-spin text-primary"})," ","Loading..."]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between py-3 mb-1",children:[s.jsxs("div",{children:[s.jsx("h5",{className:"text-lg font-medium",children:"Access Logs"}),s.jsx("p",{className:"text-sm text-neutral",children:"Team member login history"})]}),s.jsx("input",{autoComplete:"off",type:"text",name:"search",onChange:A,placeholder:"Search by Name/IP/Country",className:"h-10 min-h-0 text-sm rounded md:w-60 join-item input input-bordered focus:outline-0 focus:ring-1 focus:ring-primary"})]}),s.jsx("div",{className:"w-full mb-8 overflow-x-auto",children:s.jsxs("table",{className:"table text-sm booking-list-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-sm border",children:"Sl"}),s.jsx("th",{className:"text-sm border",children:"Name"}),s.jsx("th",{className:"text-sm border",children:"IP Address"}),s.jsx("th",{className:"text-sm border",children:"Date & Time"}),s.jsx("th",{className:"text-sm border",children:"Platform"})]})}),s.jsx("tbody",{children:g.length>0?g.map((t,r)=>s.jsxs("tr",{children:[s.jsx("th",{className:"text-sm border",children:r+1}),s.jsx("td",{className:"text-xs border",children:t.fullname}),s.jsxs("td",{className:"text-xs border",children:[s.jsx("p",{children:t.ip_address}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("img",{src:`/flags/${t.ip_country_code}.jpg`,alt:t.ip_location,className:"w-4"}),s.jsx("p",{children:t.ip_location})]})]}),s.jsx("td",{className:"text-xs border",children:E(new Date(t.timestamp*1e3)).format(`${S.default_date_format_print} H:mm:ss`)}),s.jsxs("td",{className:"text-xs border",children:[t.browser,"-",t.platform]})]},t.Id)):s.jsx("tr",{children:s.jsx("td",{colSpan:"100%",children:s.jsx("p",{className:"py-6 text-center",children:"No data found"})})})})]})})]})})]})};export{B as default};
