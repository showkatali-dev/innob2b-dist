import{m as z,an as C,l as Y,e as f,o as e,ao as V,Q as we,ap as N,I as ee,y as ke,aq as Fe,ar as Ce,as as Ie,U as Z,ac as Me,at as se,u as Te,a1 as oe,G as H,a5 as De,a6 as Ee}from"./index-3f51aa04.js";import{P as D,K as Pe,O as qe,Q as Re,S as Ae,a as le,T as Be,H as Oe,U as ce,V as Ve,W as Ue,X as Le,Y as He,Z as ge,w as xe,b as Ye,_ as ae,$ as de,a0 as me,a1 as Qe,c as Ge}from"./App-7d2219c6.js";import{S as We,a as ze,b as Je,F as Ke,Q as $e,c as Xe}from"./index-e501f6c6.js";import{A as Ze,a as ue}from"./AccordionItem-b3042e55.js";import{T as W}from"./TextInputCheckout-7543485c.js";import{I as re}from"./InputContainerCheckout-7ecc4452.js";import{P as be}from"./PhoneNumberSelect-3f8344a6.js";import{D as te}from"./DateInputCheckout-c9f301c0.js";import{D as ea}from"./DropDownSelectCheckout-494022be.js";import{R as pe}from"./RadioInputCheckout-b5d6d7eb.js";import{C as aa}from"./CountryWithCodeSelect-bc665df2.js";import{S as ta,E as sa,A as ra,a as la,b as na,c as ia,F as oa,d as ca}from"./FlightCancellationPolicyModal-354ed66b.js";import{S as da,M as he,a as ma}from"./MultipleFlight2-838c19a3.js";import{P as ua}from"./PrimaryTabsWithIcon-2ef7eb54.js";import{F as pa}from"./FlightItineraryData-9a06484c.js";import{S as ha}from"./SessionTimeOut-5f3f7846.js";import"./InputDate-4bfbb72f.js";import"./shortcut-buttons-flatpickr.min-7f1fff53.js";import"./SingleSelect-d84b87ba.js";import"./pp-6c8b1b89.js";const ga=()=>{const{checkout_form_email_modify:a,checkout_form_contact_modify:o}=z.useState().booking_manage||{},{isd_code:u,contact_no:x,email_address:c}=C.useState(),{user_data:{member_id:t,mobile:p,email:h,isd_code:d}}=Y.useState(s=>s);return f.useEffect(()=>{const s=location.origin;C.update(i=>{i.member_id=t,i.contact_no=p,i.email_address=h,i.isd_code=d,i.redirect_url=`${s}/booking-details/flight`})},[t,p,h,d]),e.jsxs("div",{className:"grid grid-cols-1 gap-3 p-3 sm:grid-cols-2",children:[e.jsx(re,{label:"Mobile Number",isRequired:!0,defaultValue:String(u||"")+String(x||""),action:s=>C.update(i=>{i.isd_code=s.isd_code||"",i.contact_no=s.mobile||""}),placeholder:"Enter Mobile Number",Input:be,readOnly:(o==null?void 0:o.toUpperCase())==="DISABLE"&&!!u}),e.jsx(W,{type:"email",label:"E-mail",action:s=>C.update(i=>{i.email_address=s.target.value}),defaultValue:c,placeholder:"example@mail.com",readOnly:(a==null?void 0:a.toUpperCase())==="DISABLE"&&!!c})]})},fe=({pax_id:a,pax_type:o,pax_options:u,isDocOptional:x,age:c})=>{var k,P,q,R,A,B,M,U,F,g,L,J,K,$,X;const{location_info:{country_code:t,isd_code:p}}=z.useState(),{doc_required:h,frequent_flyer_selection:d,wheelchair_selection:s,pax_dob_required:i,seat_selection:b,meal_selection:v,baggage_selection:S,passport_scan_selection:I,pax_search_selection:E,pax_email_contact_selection:T}=u||{},[w,l]=f.useState(!1),[r,_]=f.useState(!1),{passenger:m}=V.useState(n=>n),Q=["MRS","MISS","MS"],j=we().subtract(c,"years").format("YYYY-MM-DD");return f.useEffect(()=>{N(a,{gender:"M",wheelchair_required:"no",pax_id:a,first_name:"",last_name:"",dob:j,doc_no:"",doc_dateofexpiry:"",doc_dateofissue:"",frequent_flyer:"",contact_no:"",email_address:""})},[a,j]),f.useEffect(()=>{N(a,{title:o==="ADT"?"MR":"MSTR",pax_type:o,doc_country:t||"",isd_code:p||""})},[a,o,t,p]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-3",children:[e.jsxs("h6",{className:"mb-4 font-medium",children:[o==="ADT"?e.jsx(Pe,{className:"mr-0.5"}):o==="CNN"?e.jsx(qe,{className:"mr-0.5"}):e.jsx(Re,{className:"mr-0.5"})," ",o==="ADT"?"Adult":o==="CNN"?"Child":"Infant"," ","Traveler ",a]}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"grid gap-3 sm:col-span-2 sm:grid-cols-2 lg:col-span-3 lg:grid-cols-4",children:[e.jsx(pe,{label:"Title",isRequired:!0,defaultValue:((P=(k=m[a])==null?void 0:k.title)==null?void 0:P.toUpperCase())||"MR",action:n=>{N(a,{title:n.target.value,gender:Q.includes(n.target.value)?m[a].gender!=="F"?"F":m[a].gender:"M"})},options:o==="ADT"?[{label:"Mr",value:"MR"},{label:"Mrs",value:"MRS"},{label:"Ms",value:"MS"}]:[{label:"Mstr",value:"MSTR"},{label:"Miss",value:"MISS"}]}),e.jsx(pe,{label:"Gender",isRequired:!0,defaultValue:((q=m[a])==null?void 0:q.gender)||"M",action:n=>N(a,{gender:n.target.value,title:n.target.value==="F"?Q.includes(m[a].title)===!1?m[a].pax_type==="ADT"?"MRS":"MISS":m[a].title:m[a].pax_type==="ADT"?"MR":"MSTR"}),options:[{label:"Male",value:"M"},{label:"Female",value:"F"}]}),e.jsxs("div",{className:"flex gap-3 sm:col-span-2 max-lg:-order-1 lg:justify-end",children:[S==="active"&&e.jsx("button",{type:"button",onClick:()=>document.getElementById("baggage_modal").showModal(),className:"normal-case shadow btn btn-square btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Additional Baggage",children:e.jsx(ee,{path:ke,size:1.1})}),b==="active"&&e.jsx("button",{type:"button",onClick:()=>document.getElementById("seat_modal").showModal(),className:"normal-case shadow btn btn-square btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Select Seat",children:e.jsx(ee,{path:Fe,size:1.1})}),v==="active"&&e.jsx("button",{type:"button",onClick:()=>document.getElementById("meal_modal").showModal(),className:"normal-case shadow btn btn-square btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Select Meal",children:e.jsx(Ae,{className:"w-6 h-6"})}),I==="active"&&e.jsx("button",{type:"button",onClick:()=>l(!0),className:"normal-case shadow btn btn-square btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Scan Passport",children:e.jsx(ee,{path:Ce,size:1.1})}),E==="active"&&e.jsx("button",{type:"button",onClick:()=>_(!0),className:"normal-case shadow btn btn-ghost bg-primary/5 text-primary hover:bg-primary/20 btn-square tooltip tooltip-left tooltip-primary","data-tip":"Existing Passenger",children:e.jsx(ee,{path:Ie,size:1.1})})]})]}),e.jsx(W,{label:"First/Given Name",isRequired:!0,action:n=>N(a,{first_name:n.target.value}),isUpperCase:!0,defaultValue:((R=m[a])==null?void 0:R.first_name)||"",placeholder:"John",maxLength:30}),e.jsx(W,{label:"Surname/Family/Last Name",isRequired:!0,action:n=>N(a,{last_name:n.target.value}),isUpperCase:!0,defaultValue:((A=m[a])==null?void 0:A.last_name)||"",placeholder:"Doe",maxLength:30}),i!=="no"&&e.jsx(te,{label:"Date of Birth",isRequired:i!=="optional",action:n=>N(a,{dob:n}),placeholder:"Select Date of birth",defaultValue:(B=m[a])==null?void 0:B.dob}),h!=="no"&&!x&&e.jsxs(e.Fragment,{children:[e.jsx(re,{label:"Document Issue Country",isRequired:h!=="optional",action:n=>{var O;return N(a,{doc_country:((O=n[0])==null?void 0:O.value)||""})},defaultValue:(M=m[a])==null?void 0:M.doc_country,placeholder:"Select Country",Input:aa}),e.jsx(W,{label:"Document Number",isRequired:h!=="optional",action:n=>N(a,{doc_no:n.target.value}),isUpperCase:!0,defaultValue:((U=m[a])==null?void 0:U.doc_no)||"",placeholder:"A0123456789"}),e.jsx(te,{label:"Expiration Date",isRequired:h!=="optional",action:n=>N(a,{doc_dateofexpiry:n}),placeholder:"Select Date",defaultValue:(F=m[a])==null?void 0:F.doc_dateofexpiry}),e.jsx(te,{label:"Date of Document Issuance",action:n=>N(a,{doc_dateofissue:n}),defaultValue:(g=m[a])==null?void 0:g.doc_dateofissue,placeholder:"Select Date"})]}),(d==="active"||d==="optional")&&e.jsx(W,{label:"Frequent Flyer Number",isRequired:d==="active",action:n=>N(a,{frequent_flyer:n.target.value}),isUpperCase:!0,defaultValue:((L=m[a])==null?void 0:L.frequent_flyer)||"",placeholder:"Type frequent flyer number"}),(s==="active"||s==="optional")&&e.jsx(ea,{label:"Wheelchair Required",isRequired:s==="active",options:[{label:"Yes",value:"yes"},{label:"No",value:"no"}],action:n=>{var O;return N(a,{wheelchair_required:((O=n[0])==null?void 0:O.value)||""})},defaultValue:(J=m[a])==null?void 0:J.wheelchair_required,placeholder:"Select"}),T!=="disable"&&e.jsxs(e.Fragment,{children:[e.jsx(re,{label:"Mobile Number",isRequired:!1,defaultValue:String(((K=m[a])==null?void 0:K.isd_code)||"")+String((($=m[a])==null?void 0:$.contact_no)||""),action:n=>N(a,{isd_code:(n==null?void 0:n.isd_code)||"",contact_no:(n==null?void 0:n.mobile)||""}),placeholder:"Enter Mobile Number",Input:be}),e.jsx(W,{type:"email",label:"E-mail",action:n=>N(a,{email_address:n.target.value}),placeholder:"example@mail.com",defaultValue:((X=m[a])==null?void 0:X.email_address)||""})]})]})]}),e.jsx(ta,{isOpenScanPassportModal:w,setIsOpenScanPassportModal:l,pax_id:a}),e.jsx(sa,{isOpenExistingPassengerModal:r,setIsOpenExistingPassengerModal:_,pax_id:a})]})};fe.propTypes={pax_id:D.number,pax_type:D.string,pax_options:D.object};const xa=()=>{const{save_pax:a}=V.useState(),{booking_tracking_id:o,passenger:u}=V.useState(d=>d),[x,c]=f.useState(!1),{member_id:t}=Y.useState(d=>d.user_data)||{},{axiosInstance:p}=le(),h=async()=>{var s;if(x)return;c(!0);const d={booking_tracking_id:o,member_id:t,save_pax:"yes",passenger:Object.values(u)};try{const i=await p.post("/flight/update-travellers",d);((s=i==null?void 0:i.data)==null?void 0:s.status)==="success"&&Z("success","Saved!",i.data.reason)}catch(i){Z("error","Failed!",i.message)}finally{c(!1)}};return e.jsxs("div",{className:"flex justify-end gap-4 px-3 py-4",children:[e.jsxs("label",{htmlFor:"save_pax",className:"flex items-center align-middle",children:[e.jsx("input",{autoComplete:"off",type:"checkbox",id:"save_pax",defaultChecked:a==="yes",onChange:d=>V.update(s=>{s.save_pax=d.target.checked?"yes":"no"}),className:"w-3.5 h-3.5 rounded-sm checkbox checkbox-primary"}),e.jsx("span",{className:"text-xs select-none",children:"Save Passenger Information for later"})]}),e.jsx("button",{onClick:h,className:"font-normal normal-case rounded btn btn-sm btn-primary",children:x?e.jsx(Be,{className:"animate-spin"}):"Save Passenger"})]})},je=({flight_data:a})=>{const{search_parameter:{travelers_adult:o,travelers_adult_age:u,travelers_child:x,travelers_child_age:c,travelers_infants:t,travelers_infants_age:p},pax_options:h,supplier:d,flight_group:s}=a||{},i=d==null?void 0:d.currency,b=s==null?void 0:s.every(w=>{var l;return(l=w==null?void 0:w.routes)==null?void 0:l.every(r=>{var _,m;return((_=r==null?void 0:r.origin_airport)==null?void 0:_.country)==="Bangladesh"&&((m=r==null?void 0:r.destination_airport)==null?void 0:m.country)==="Bangladesh"})}),{seat_selection:v,meal_selection:S,baggage_selection:I,pax_save_option:E}=h||{},T=o+x+t;return e.jsxs(e.Fragment,{children:[e.jsxs(Ze,{className:"w-full mb-8 bg-base-200 shadow-md",children:[e.jsxs(ue,{isOpen:!0,header:"Enter Traveler Details",children:[Array(T).fill("").map((w,l)=>{const r=l+1,_=r<=o?"ADT":r-o<=x?"CNN":"INF";return e.jsx(fe,{pax_id:r,pax_type:_,pax_options:h,isDocOptional:(i==null?void 0:i.toLowerCase())==="bdt"&&b,age:_==="ADT"?(u==null?void 0:u.at(l))||30:_==="CNN"?(c==null?void 0:c.at(l-o))||10:(p==null?void 0:p.at(l-o-x))||2},Me())}),E==="active"&&e.jsx(xa,{})]}),e.jsx(ue,{isOpen:!0,header:"Enter Contact Details",children:e.jsx(ga,{})})]}),I==="active"&&e.jsx(ra,{}),v==="active"&&e.jsx(la,{}),S==="active"&&e.jsx(na,{})]})};je.propTypes={flight_data:D.object.isRequired};const ba=[{id:1,name:"Flight Itinerary",value:"flight_itinerary",icon:e.jsx(He,{})},{id:2,name:"Fare Summary",value:"fare_summary",icon:e.jsx(ge,{})}],fa=[{id:2,name:"Fare Summary",value:"fare_summary",icon:e.jsx(ge,{})}],ye=({flight_data:a})=>{const{user_data:{user_access_level:o}={}}=Y.useState(),{system_config:u,supplier_option:x}=z.useState(),{search_result_version:c}=u||{},t=["1","4","5","7"].includes(c)?ba:fa,{show_supplier_option:p}=x||{},[h,d]=f.useState(t[0].value),{flight_group:s,price_breakdown:i}=a||{},[b,v]=f.useState(!1),S=f.useRef(),I=()=>{S.current.style.maxHeight=0,v(!1)},E=()=>{S.current.style.maxHeight=S.current.scrollHeight+"px",v(!0)},T=()=>{b?I():E()},w=Oe.useMediaQuery({query:"(max-width: 640px)"});return e.jsxs("div",{className:"relative px-3 py-4 mb-8 border-t rounded-lg shadow-md border-base-300 bg-base-200",children:[e.jsxs("div",{className:"flex flex-col gap-5 justify-evenly sm:flex-row sm:items-center",children:[c==="1"&&e.jsx("div",{className:"w-full",children:s.map((l,r)=>e.jsxs("div",{children:[r>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(da,{singleFlightData:l})]},r))}),c==="2"&&e.jsx("div",{className:"w-full",children:s.map((l,r)=>e.jsxs("div",{className:"flex flex-col gap-8",children:[r>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(he,{singleFlightData:l})]},r))}),["3","6"].includes(c)&&e.jsx(e.Fragment,{children:w?e.jsx("div",{className:"w-full",children:s.map((l,r)=>e.jsxs("div",{className:"flex flex-col gap-8",children:[r>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(he,{singleFlightData:l})]},r))}):e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-5 p-1 mb-2 text-sm font-semibold text-center rounded sm:items-center bg-neutral/5 text-neutral",children:[e.jsx("div",{children:"Airline"}),e.jsx("div",{children:"Details"}),e.jsx("div",{children:"Departure"}),e.jsx("div",{children:"Arrival"}),e.jsx("div",{children:"Duration"}),e.jsx("div",{children:"Baggage"})]}),s.map((l,r)=>e.jsxs("div",{className:"flex flex-col gap-4",children:[r>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(ma,{singleFlightData:l})]},r))]})}),c==="4"&&e.jsx("div",{className:"w-full",children:s.map((l,r)=>e.jsxs("div",{children:[r>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(We,{singleFlightData:l})]},r))}),c==="5"&&e.jsx("div",{className:"w-full space-y-2",children:s.map((l,r)=>e.jsx("div",{children:e.jsx(ze,{singleFlightData:l})},r))}),c==="7"&&e.jsx("div",{className:"w-full space-y-2",children:s.map((l,r)=>e.jsx("div",{children:e.jsx(Je,{singleFlightData:l})},r))}),e.jsx("div",{className:"flex items-center flex-shrink-0 gap-3 justify-evenly",children:e.jsx("div",{className:"flex gap-2 text-center",children:e.jsx("button",{onClick:T,className:"viewDetailsBtn text-nowrap shadow-sm absolute left-1/2 top-full -translate-x-1/2 bg-white text-xs p-0.5 before:content-[''] before:absolute before:top-0 before:left-[-30px] before:border-r-[30px] before:border-r-white before:border-b-[20px] before:border-b-transparent after:content-[''] after:absolute after:top-0 after:right-[-30px] after:border-l-[30px] after:border-l-white after:border-b-[20px] after:border-b-transparent",children:b?e.jsxs(e.Fragment,{children:["Hide Details ",e.jsx(ce,{})]}):e.jsxs(e.Fragment,{children:["View Details ",e.jsx(Ve,{})]})})})})]}),e.jsx("div",{className:"flex items-center justify-end mt-4",children:(u==null?void 0:u.show_cart_quotes)==="YES"&&e.jsxs("button",{onClick:()=>se("quotes",a),className:"addToCartBtn normal-case font-normal btn btn-primary btn-outline border-[#ccc] btn-xs",children:["Quotes",e.jsx(Ue,{})]})}),e.jsx("div",{ref:S,className:"overflow-hidden duration-500 details",style:{maxHeight:0},children:e.jsxs("div",{className:"px-3 py-3 content",children:[e.jsx("hr",{className:"my-4 border"}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between mb-5",children:[e.jsx(ua,{items:["supernsn","administrator"].includes(o)&&p==="YES"?[...t,{id:3,name:"Debug",value:"debug",icon:e.jsx(Le,{})}]:t,activeTab:h,action:l=>{d(l),setTimeout(()=>{S.current.style.maxHeight=S.current.scrollHeight+"px"},100)}}),e.jsxs("button",{onClick:I,className:"ml-auto text-xs normal-case hideDetailsBtn btn btn-sm rounded-3xl",children:["Hide Details",e.jsx(ce,{})]})]}),h==="flight_itinerary"&&["1","4","5","7"].includes(c)&&e.jsx(pa,{flight_group:s}),h==="fare_summary"&&e.jsx(Ke,{price_breakdown:i}),h==="debug"&&p==="YES"&&e.jsx("div",{className:"p-3 border rounded-lg",children:e.jsx("pre",{children:JSON.stringify(a,null,3)})})]})})]})};ye.propTypes={flight_data:D.object.isRequired};const ve=({validation_data:a})=>{const{data:o}=a;return e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx(ye,{flight_data:o}),e.jsx(je,{flight_data:o}),e.jsx($e,{})]})};ve.propTypes={validation_data:D.object.isRequired};const _e=({isExpired:a,isChecked:o,hold_possible:u})=>{const x=C.useState(j=>j),{axiosInstance:c}=le(),[t,p]=f.useState(!1),{payment_type:h}=C.useState(),{booking_tracking_id:d,save_pax:s,passenger:i}=V.useState(j=>j),{user_data:{login_key:b,member_id:v,user_access_level:S}={}}=Y.useState(),{data:I,isLoading:E,isError:T}=xe({queryKey:["SERVICE_STATUS",b,v],queryFn:async()=>{var j;try{const k=await c.post("/reports/service-status",{login_key:b,member_id:v});return((j=k==null?void 0:k.data)==null?void 0:j.service_status)||null}catch(k){console.error(k)}}}),w=Ye(),l=Te(),r=async()=>{var j,k,P,q,R,A,B;if(!t)try{if(p(!0),o.terms_conditions===!1)throw new Error("Please accept Terms & Conditions");if(o.cancellation_policy===!1)throw new Error("Please accept Cancellation Policy");const M=await c.post("/user/profile",JSON.parse(localStorage.getItem("user_info")));if(!M.data||((j=M.data)==null?void 0:j.status)!=="success"){localStorage.removeItem("user_info"),Y.update(g=>{g.token=null,g.user_data=null}),l.invalidateQueries(["SITE_CONFIG"]);return}const U={booking_tracking_id:d,member_id:v,save_pax:s,passenger:Object.values(i)},F=await c.post("/flight/update-travellers",U);if(((k=F==null?void 0:F.data)==null?void 0:k.status)==="success")try{const g=await c.post("/flight/create-booking",x);if(((P=g==null?void 0:g.data)==null?void 0:P.status)==="success")(R=(q=g==null?void 0:g.data)==null?void 0:q.general)!=null&&R.tracking_id?(w(`/booking-details/flight?tracking_id=${g.data.general.tracking_id}`,{replace:!0}),Z("success","Booking Successful",F.data.reason),V.replace(V._getInitialState()),C.replace(C._getInitialState()),oe.replace(oe._getInitialState())):(await de.fire({title:"Pay Now",html:"Kindly click the <b>Pay Now</b> button to proceed with your payment. Upon successful payment, your booking will be automatically confirmed.",icon:"success",showCancelButton:!1,confirmButtonColor:"hsl(var(--p)/1)",confirmButtonText:"Pay Now",allowOutsideClick:!1})).isConfirmed&&window.location.replace((A=g.data)==null?void 0:A.payment_link);else throw S==="supernsn"?new Error(g.data.reason+`
`+((B=g.data)==null?void 0:B.reason_admin)):new Error(g.data.reason)}catch(g){(await de.fire({title:"Booking Failed!",html:g.message,icon:"error",showCancelButton:!1,showCloseButton:!1,confirmButtonColor:"hsl(var(--p)/1)",confirmButtonText:"Go Back",allowOutsideClick:!1})).isConfirmed&&w(-1,{replace:!0})}else throw new Error(F==null?void 0:F.data.reason)}catch(M){console.error(M),Z("error","Failed!",M.message)}finally{p(!1)}};if(E||T)return e.jsxs("button",{className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",children:[e.jsx(ae,{className:"mr-2 animate-spin"})," Loading..."]});const{block_status:_,flight_block:m,reason:Q}=I;return _==="yes"&&m==="yes"?e.jsx("div",{className:"p-3 text-sm border rounded-lg border-error bg-error/10",children:e.jsx("p",{className:"text-error inner-html",dangerouslySetInnerHTML:{__html:Q}})}):h?e.jsx(e.Fragment,{children:h==="account_balance"?e.jsx("button",{onClick:r,className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",disabled:a,children:t?e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"mr-2 animate-spin"})," Loading..."]}):u==="yes"?"Hold Flight":"Instant Purchase"}):e.jsx("button",{onClick:r,disabled:a,className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",children:t?e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"mr-2 animate-spin"})," Loading..."]}):"Pay and Reserve"})}):e.jsx("div",{className:"p-3 text-sm border rounded-lg border-error bg-error/10",children:e.jsx("p",{className:"text-error",children:"You don't have enough balance."})})};_e.propTypes={isExpired:D.bool,isChecked:D.object,hold_possible:D.string};const Ne=({validation_data:a})=>{var R,A,B,M,U,F,g,L,J,K,$,X,n,O,ne,ie;const{price_change:o,search_price:u,validation_price:x,session_expire:c,data:{sell:t,hold_possible:p,pax_options:h},terms:d,cancellation_terms:s,booking_tracking_id:i}=a,{terms_selection:b,cancellation_selection:v}=h||{},[S,I]=f.useState(!1),[E,T]=f.useState(!1),{payment_type:w}=C.useState(),{user_data:l}=Y.useState(),[r,_]=f.useState({terms_conditions:!1,cancellation_policy:!1}),[m,Q]=f.useState(!1),{price_view:{online_payment_option:j,show_flight_fare_rules:k,show_sell_price:P}={}}=z.useState();f.useEffect(()=>{var y;((y=t==null?void 0:t.total)==null?void 0:y.amount)>(l==null?void 0:l.balance)&&p==="no"&&(j==="ACTIVE"?C.update(G=>{G.payment_type="card"}):C.update(G=>{G.payment_type=null}))},[(R=t==null?void 0:t.total)==null?void 0:R.amount,l==null?void 0:l.balance,p,j]),f.useEffect(()=>{_({terms_conditions:b==="check"||b==="hide",cancellation_policy:v==="check"||v==="hide"})},[b,v]);const q=y=>{var G;((G=t==null?void 0:t.total)==null?void 0:G.amount)>(l==null?void 0:l.balance)&&p==="no"?(y.preventDefault(),y.target.value==="account_balance"?Z("error","Insufficient Balance","Please add balance to your account"):y.target.click()):C.update(Se=>{Se.payment_type=y.target.value})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("div",{className:"p-3 mb-3 border-t rounded-lg shadow-md border-base-300 bg-base-200",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-3 text-xs text-center border rounded bg-primary/10 max-sm:hidden",children:[e.jsx("span",{className:"font-medium py-1.5 px-1 bg-base-300",children:"Search Ref:"})," ",e.jsx("input",{type:"text",value:i,readOnly:!0,className:"bg-transparent cursor-pointer focus:outline-none",onClick:y=>{navigator.clipboard.writeText(i),y.target.value="Copied",setTimeout(()=>{y.target.value=i},3e3)}})]}),(P==null?void 0:P.toUpperCase())==="YES"&&e.jsxs("div",{className:"p-3 mb-3 text-sm rounded-lg bg-primary/10",children:[e.jsxs("h6",{className:"mb-2 font-semibold",children:[e.jsx(me,{className:"mr-1"})," Price: ",o]}),e.jsxs("p",{children:["Updated Price: ",H(x.currency)," ",x.amount]}),e.jsxs("p",{children:["Search Price: ",H(u.currency)," ",u.amount]})]}),k==="YES"&&e.jsxs("div",{className:"p-3 mb-3 text-sm rounded-lg bg-base-300",children:[e.jsxs("h6",{className:"mb-2 font-semibold",children:[e.jsx(me,{className:"mr-1"})," Fare Rules & Policy"]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("button",{onClick:()=>se("fare_rules",a),className:"inline-flex text-primary hover:underline",children:"Penalty and Cancellation Information"}),e.jsx("button",{onClick:()=>se("fare_rules",a),className:"inline-flex text-primary hover:underline",children:"Flight Fare rules"})]})]}),e.jsx(ha,{session_expire:c,action:y=>Q(y)}),e.jsxs("div",{className:"p-3 mb-3 text-sm rounded-lg bg-base-300",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Fare/Pax type"}),e.jsx("p",{className:"font-medium",children:"Amount"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Base Fare"}),e.jsxs("p",{className:"font-medium",children:[H((A=t==null?void 0:t.base_fare)==null?void 0:A.currency)," ",(M=Number((B=t==null?void 0:t.base_fare)==null?void 0:B.amount))==null?void 0:M.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Tax"}),e.jsxs("p",{className:"font-medium",children:[H((U=t==null?void 0:t.tax)==null?void 0:U.currency)," ",(g=Number((F=t==null?void 0:t.tax)==null?void 0:F.amount))==null?void 0:g.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Total"}),e.jsxs("p",{className:"font-medium",children:[H((L=t==null?void 0:t.total)==null?void 0:L.currency)," ",(K=Number((J=t==null?void 0:t.total)==null?void 0:J.amount))==null?void 0:K.toFixed(2)]})]}),e.jsx("hr",{className:"mb-3 border border-neutral/20"}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Total Fare"}),e.jsx("p",{className:"font-medium",children:"Amount"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("p",{children:"Total Published Fare"}),e.jsxs("p",{className:"font-medium",children:[H(($=t==null?void 0:t.total)==null?void 0:$.currency)," ",(n=Number((X=t==null?void 0:t.total)==null?void 0:X.amount))==null?void 0:n.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 mb-3 rounded-lg bg-primary/10 text-primary",children:[e.jsx("p",{children:"Total Payable"}),e.jsxs("p",{className:"font-medium fs-4",children:[H((O=t==null?void 0:t.total)==null?void 0:O.currency)," ",(ie=Number((ne=t==null?void 0:t.total)==null?void 0:ne.amount))==null?void 0:ie.toFixed(2)]})]}),e.jsxs("div",{className:"grid gap-3 mb-3 sm:grid-flow-col lg:grid-flow-row xl:grid-flow-col payment-selection",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("input",{autoComplete:"off",type:"radio",className:"absolute -translate-y-1/2 radio radio-xs radio-primary left-2 top-1/2 peer",name:"payment",id:"balance",value:"account_balance",defaultChecked:w==="account_balance",onClick:q}),e.jsx("label",{htmlFor:"balance",className:"block px-2 py-4 pl-8 text-nowrap bg-primary/10 peer-checked:bg-primary peer-checked:text-white",children:"Account Balance"})]}),j==="ACTIVE"&&e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("input",{autoComplete:"off",type:"radio",className:"absolute -translate-y-1/2 radio radio-primary radio-xs top-1/2 left-2 peer",name:"payment",id:"card",value:"card",defaultChecked:w==="card",onClick:q}),e.jsxs("label",{className:"block px-2 py-4 pl-8 bg-primary/10 peer-checked:bg-primary peer-checked:text-white",htmlFor:"card",children:["Card ",e.jsx(Qe,{className:"ml-1"})]})]})]}),b!=="hide"&&e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",checked:r.terms_conditions,id:"terms",onChange:y=>_({...r,terms_conditions:y.target.checked})}),e.jsxs("label",{className:"text-sm font-medium form-check-label",htmlFor:"terms",children:["I have read and accept all"," ",e.jsx("button",{onClick:()=>(d==null?void 0:d.status)==="active"&&I(!0),className:"inline text-primary",children:"Terms & Conditions"})]})]}),v!=="hide"&&e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",checked:r.cancellation_policy,id:"policies",onChange:y=>_({...r,cancellation_policy:y.target.checked})}),e.jsxs("label",{className:"text-sm font-medium form-check-label",htmlFor:"policies",children:["I agree and understand the"," ",e.jsx("button",{onClick:()=>(s==null?void 0:s.status)==="active"&&T(!0),className:"inline text-primary",children:"Cancellation Policies"})]})]}),e.jsx(_e,{isExpired:m,isChecked:r,hold_possible:p}),e.jsx(ia,{})]})}),e.jsx(oa,{isActive:S,setIsActive:I,data:d}),e.jsx(ca,{isActive:E,setIsActive:T,data:s})]})};Ne.propTypes={validation_data:D.object.isRequired};const Oa=()=>{const[a]=Ge(),{site_title:o}=z.useState(),u=a.get("tracking_id"),{price_view:{show_flight_fare_rules:x}={}}=z.useState(),{user_data:{member_id:c}}=Y.useState(),{axiosInstance:t}=le(),{data:p,isLoading:h,error:d}=xe(["VALIDATION_DATA",u,c],async()=>{var i,b;const s=await t.post("/flight/validation-get-status",{booking_tracking_id:u,member_id:c});if(((i=s.data)==null?void 0:i.status)==="success")return s.data;throw{...s,message:((b=s.data)==null?void 0:b.reason)||"Request failed!"}});if(f.useEffect(()=>{V.update(s=>{s.booking_tracking_id=u}),C.update(s=>{s.booking_tracking_id=u})},[u]),h)return e.jsx(De,{});if(d)throw d;return e.jsxs(e.Fragment,{children:[e.jsx(Ee,{children:e.jsxs("title",{children:["Flight Checkout",o?" - "+o:""]})}),e.jsxs("main",{className:"container min-h-screen pt-20",children:[e.jsx("h5",{className:"mb-4 text-xl font-medium",children:"Flight Details"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 mb-8 lg:grid-cols-3",children:[e.jsx(ve,{validation_data:p}),e.jsx(Ne,{validation_data:p})]})]}),x==="YES"&&e.jsx(Xe,{})]})};export{Oa as default};
