import{e as d,u as M,m as q,o as A,P as K,q as e,T as F,am as H}from"./index-a3ec2d78.js";import{b as V,E as $}from"./pp-b306ecc3.js";import{P as g,d as I,V as L,R as Q,b as Y,a6 as X,o as W,aK as Z,O as ee}from"./App-87fdd66a.js";import{I as B}from"./InputDate-4c684fae.js";import{S as se}from"./SingleSelect-477c2196.js";import{P as ae}from"./PhoneNumberSelect-7c529eca.js";const te=["JPG","JPEG","PNG","PDF"],ne=({passenger:o,isOpenScanPassportModal:p,setIsOpenScanPassportModal:c})=>{const{title:m,first_name:b,last_name:_,doc_country:v,doc_no:x,dob:f,gender:n,doc_dateofissue:u,doc_dateofexpiry:t,pax_id:y,pax_type:j,tracking_id:w}=o||{},[s,r]=d.useState({title:m,first_name:b,last_name:_,doc_country:v,doc_no:x,dob:f,gender:n,doc_dateofissue:u,doc_dateofexpiry:t}),[h,a]=d.useState(null),[i,N]=d.useState(!1),[S,O]=d.useState(!1),G=M(),{axiosInstance:T}=I(),{member_id:R}=q.useState().user_data||{},{country_code:z}=A.useState().location_info||{};d.useEffect(()=>{s.doc_country||r({...s,doc_country:z})},[z]),d.useEffect(()=>{(!s.doc_dateofexpiry||s.doc_dateofexpiry==="0000-00-00")&&r(l=>({...l,doc_dateofexpiry:K().add(1,"year").format("YYYY-MM-DD")}))},[s.doc_dateofexpiry]);const U=async l=>{var k,D,P;N(!0);try{if(l){a(URL.createObjectURL(l));const C=new FormData;C.append("documents_image_url",l),C.append("image_type","file"),C.append("member_id",R),C.append("booking_tracking_id",w),C.append("documents_type","passport"),C.append("pax_id",y);const E=await T.post("/tools/document-scan",C);((k=E==null?void 0:E.data)==null?void 0:k.status)==="success"&&r({...s,...E.data.data,doc_dateofissue:(P=(D=E==null?void 0:E.data)==null?void 0:D.data)==null?void 0:P.doc_issuedate})}}catch(C){console.error(C)}finally{N(!1)}},J=async l=>{var k;if(l.preventDefault(),!(!s||S)){O(!0);try{const D={passenger:[{...s,pax_id:y,pax_type:j}],member_id:R,tracking_id:w,action_type:"doc"},P=await T.post("/flight/update-pax-passport",D);if(c(!1),a(null),((k=P==null?void 0:P.data)==null?void 0:k.status)==="success")F("success","Updated!",P.data.reason),G.invalidateQueries(["FLIGHT_BOOKING_DETAILS",w,R]);else throw new Error(P.data.reason)}catch(D){console.error(D),F("error","Failed!",D.message)}finally{O(!1)}}};return e.jsx("div",{className:"modal",open:p,children:e.jsxs("div",{className:"max-w-4xl modal-box",children:[e.jsx("div",{className:"sticky top-0 z-20 bg-base-200",children:e.jsx("button",{onClick:()=>c(!1),className:"absolute -top-2 -right-2 btn btn-sm btn-circle btn-ghost",children:"✕"})}),e.jsxs("form",{onSubmit:J,children:[e.jsxs("div",{className:"grid gap-8 mb-4 md:grid-cols-2",children:[e.jsxs("div",{className:"relative flex flex-col items-center justify-center h-full bg-center bg-no-repeat bg-contain",style:{backgroundImage:`url("${h||V}")`},children:[e.jsx($,{handleChange:U,name:"file",label:" Upload or drop your doc right here",types:te,classes:"!h-full !min-h-[420px] !py-0 !min-w-0 !w-full !max-w-full !items-end !pb-4 scan_passport"}),i&&e.jsx("div",{className:"absolute z-10 bg-center bg-no-repeat bg-contain opacity-100 inset-[1px] bg-base-200",style:{backgroundImage:"url(https://i.pinimg.com/originals/1e/d5/47/1ed547006742581be6daece42fb2fd34.gif)"}})]}),e.jsxs("div",{className:"space-y-3 font-medium",children:[e.jsxs("h5",{className:"mb-4 font-semibold uppercase",children:["For"," ",j==="ADT"?"Adult":j==="CHD"?"Child":"Infant"," ","- Passenger No ",y]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"text-sm capitalize",children:"Title"}),e.jsx("input",{autoComplete:"off",type:"text",className:"w-full p-2 text-sm uppercase border-l-2 rounded-md bg-neutral/10 border-primary focus:outline-0",value:s==null?void 0:s.title,readOnly:!0})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"text-sm capitalize",children:"First name"}),e.jsx("input",{autoComplete:"off",type:"text",className:"w-full p-2 text-sm uppercase border-l-2 rounded-md bg-neutral/10 border-primary focus:outline-0",value:s==null?void 0:s.first_name,readOnly:!0})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"text-sm capitalize",children:"Last name"}),e.jsx("input",{autoComplete:"off",type:"text",className:"w-full p-2 text-sm uppercase border-l-2 rounded-md bg-neutral/10 border-primary focus:outline-0",value:s==null?void 0:s.last_name,readOnly:!0})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"text-sm capitalize",children:"Country"}),e.jsx("input",{autoComplete:"off",type:"text",onChange:l=>r({...s,doc_country:l.target.value}),className:"w-full p-2 text-sm uppercase border-l-2 rounded-md bg-neutral/10 border-primary focus:outline-0",value:s==null?void 0:s.doc_country})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"text-sm capitalize",children:"Passport number"}),e.jsx("input",{autoComplete:"off",type:"text",onChange:l=>r({...s,doc_no:l.target.value}),className:"w-full p-2 text-sm uppercase border-l-2 rounded-md bg-neutral/10 border-primary focus:outline-0",value:s==null?void 0:s.doc_no})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"text-sm capitalize",children:"Birth date"}),e.jsx(B,{action:l=>r({...s,dob:l}),className:"w-full p-2 text-sm uppercase border-0 border-l-2 rounded-md bg-neutral/10 border-primary focus:outline-0 h-9",defaultValue:s==null?void 0:s.dob})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"text-sm capitalize",children:"Birth place"}),e.jsx("input",{autoComplete:"off",type:"text",onChange:l=>r({...s,birth_place:l.target.value}),className:"w-full p-2 text-sm uppercase border-l-2 rounded-md bg-neutral/10 border-primary focus:outline-0",value:(s==null?void 0:s.birth_place)||(s==null?void 0:s.doc_country)})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"text-sm capitalize",children:"Gender"}),e.jsx(se,{options:[{label:"Male",value:"M"},{label:"Female",value:"F"}],className:"w-full p-2 text-sm !border-0 !border-l-2 !rounded-md bg-neutral/10 !border-primary focus:outline-0 h-9",defaultValue:s==null?void 0:s.gender,action:l=>{var k;return r({...s,gender:(k=l==null?void 0:l.at(0))==null?void 0:k.value})}})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"text-sm capitalize",children:"Expiry date"}),e.jsx(B,{action:l=>r({...s,doc_dateofexpiry:l}),className:"w-full p-2 text-sm uppercase border-0 border-l-2 rounded-md bg-neutral/10 border-primary focus:outline-0 h-9",defaultValue:s==null?void 0:s.doc_dateofexpiry})]})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:!s,children:S?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"animate-spin"})," Updating..."]}):"Update"})})]})]})})};ne.propTypes={isOpenScanPassportModal:g.bool.isRequired,setIsOpenScanPassportModal:g.func.isRequired,passenger:g.object.isRequired};const re=({passenger:o,isOpenContactModal:p,setIsOpenContactModal:c})=>{const{isd_code:m,contact_no:b,email_address:_,pax_id:v,pax_type:x,tracking_id:f}=o||{},[n,u]=d.useState({isd_code:m,contact_no:b,email_address:_}),[t,y]=d.useState(!1),j=M(),{axiosInstance:w}=I(),{member_id:s}=q.useState().user_data||{},{isd_code:r}=A.useState().location_info||{};d.useEffect(()=>{n.isd_code||u({...n,isd_code:r})},[r]);const h=async a=>{var i;if(a.preventDefault(),!(!n||t)){y(!0);try{const N={passenger:[{...n,pax_id:v,pax_type:x}],member_id:s,tracking_id:f,action_type:"contact"},S=await w.post("/flight/update-pax-passport",N);if(c(!1),((i=S==null?void 0:S.data)==null?void 0:i.status)==="success")F("success","Updated!",S.data.reason),j.invalidateQueries(["FLIGHT_BOOKING_DETAILS",f,s]);else throw new Error(S.data.reason)}catch(N){console.error(N),F("error","Failed!",N.message)}finally{y(!1)}}};return e.jsx("div",{className:"modal",open:p,children:e.jsxs("div",{className:"max-w-4xl modal-box",children:[e.jsx("div",{className:"sticky top-0 z-20 bg-base-200",children:e.jsx("button",{onClick:()=>c(!1),className:"absolute -top-2 -right-2 btn btn-sm btn-circle btn-ghost",children:"✕"})}),e.jsxs("form",{onSubmit:h,children:[e.jsxs("div",{className:"mb-4 font-medium",children:[e.jsxs("h5",{className:"mb-3 font-semibold",children:["For"," ",x==="ADT"?"Adult":x==="CHD"?"Child":"Infant"," ","- Passenger No ",v]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-44",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"text-sm capitalize",children:"Contact No"}),e.jsx(ae,{placeholder:"Enter Mobile Number",className:"!w-full p-2 text-sm rounded-md !border-transparent !bg-neutral/10 !border-l-primary focus:outline-0",defaultValue:String(n.isd_code||"")+String(n.contact_no||""),action:a=>u({...n,isd_code:(a==null?void 0:a.isd_code)||"",contact_no:(a==null?void 0:a.mobile)||""}),isRequired:!0})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"text-sm capitalize",children:"Email Address"}),e.jsx("input",{autoComplete:"off",type:"text",onChange:a=>u({...n,email_address:a.target.value}),className:"w-full p-2 text-sm border-l-2 rounded-md bg-neutral/10 border-primary focus:outline-0",value:n==null?void 0:n.email_address})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:t?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"animate-spin"})," Updating..."]}):"Update"})})]})]})})};re.propTypes={isOpenContactModal:g.bool.isRequired,setIsOpenContactModal:g.func.isRequired,passenger:g.object.isRequired};const le=["JPG","JPEG","PNG","PDF"],oe=({passenger:o,isOpen:p,setIsOpen:c})=>{const[m,b]=d.useState(),[_,v]=d.useState(null),[x,f]=d.useState(!1),[n,u]=d.useState(!1),t=M(),{axiosInstance:y}=I(),{member_id:j}=q.useState().user_data||{},w=async r=>{var h;f(!0);try{if(r){b(URL.createObjectURL(r));const a=new FormData;a.append("documents_image_url",r),a.append("member_id",j),a.append("image_type","file"),a.append("category","profile_picture");const i=await y.post("/tools/upload-cdn",a);if(((h=i==null?void 0:i.data)==null?void 0:h.status)==="success"){const{ObjectURL:N}=i.data;v(N)}}}catch(a){console.error(a)}finally{f(!1)}},s=async r=>{var h;if(r.preventDefault(),!n){u(!0);try{const a={passenger:[{...o,passport_copy:_}],member_id:j,tracking_id:o==null?void 0:o.tracking_id,action_type:"all"},i=await y.post("/flight/update-pax-passport",a);if(c(!1),b(null),((h=i==null?void 0:i.data)==null?void 0:h.status)==="success")F("success","Updated!",i.data.reason),t.invalidateQueries(["FLIGHT_BOOKING_DETAILS",o==null?void 0:o.tracking_id,j]);else throw new Error(i.data.reason)}catch(a){console.error(a),F("error","Failed!",a.message)}finally{u(!1)}}};return e.jsx("div",{className:"modal",open:p,children:e.jsxs("div",{className:"max-w-xl rounded modal-box",children:[e.jsx("div",{className:"sticky top-0 z-20 bg-base-200",children:e.jsx("button",{onClick:()=>c(!1),className:"absolute -top-2 -right-2 btn btn-sm btn-circle btn-ghost",children:"✕"})}),e.jsxs("form",{onSubmit:s,children:[e.jsxs("div",{className:"relative flex flex-col items-center justify-center h-full bg-center bg-no-repeat bg-contain",style:{backgroundImage:`url("${m||V}")`},children:[e.jsx($,{handleChange:w,name:"file",label:" Upload or drop your doc right here",types:le,classes:"!h-full !min-h-[420px] !py-0 !min-w-0 !w-full !max-w-full !items-end !pb-4 scan_passport"}),x&&e.jsx("div",{className:"absolute z-10 bg-center bg-no-repeat bg-contain opacity-100 inset-[1px] bg-base-200",style:{backgroundImage:"url(https://i.pinimg.com/originals/1e/d5/47/1ed547006742581be6daece42fb2fd34.gif)"}})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{type:"submit",className:"min-h-0 font-normal rounded btn btn-primary h-11",disabled:!_,children:n?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"animate-spin"})," Updating..."]}):"Update"})})]})]})})},ie=({passenger:o})=>{const[p,c]=d.useState(!1);return e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-3",children:[e.jsxs("button",{onClick:()=>c(!0),className:"text-white normal-case rounded btn btn-info btn-xs",children:[e.jsx(Q,{className:"text-base"})," Upload Passport"]}),e.jsx(oe,{isOpen:p,setIsOpen:c,passenger:o})]})};ie.propTypes={passenger:g.object.isRequired};const ce=({isActive:o,setIsActive:p,tracking_id:c,primary_customer_data:m})=>{var s,r,h;const{system_config:b}=A.useState(),{title:_,first_name:v,last_name:x}=(m==null?void 0:m.customer)||{},f=_+" "+v+" "+x,{email_address:n}=(m==null?void 0:m.contact)||{},[u,t]=d.useState(!1),{member_id:y}=((s=q.useState())==null?void 0:s.user_data)||{},{axiosInstance:j}=I(),w=async a=>{var T,R,z;if(a.preventDefault(),u)return;t(!0);const i=a.target,N=i.platform_type.value,S=i.receiver_id.value,O=i.name.value,G={member_id:y,tracking_id:c,platform_type:N,receiver_id:S,name:O};try{const U=await j.post("/finance/partner-customer-send-invoice",G);if(p(!1),((T=U.data)==null?void 0:T.status)==="success")F("success","Sent!",(R=U.data)==null?void 0:R.reason);else throw new Error(((z=U.data)==null?void 0:z.reason)||"Something happen wrong. Sending Failed!")}catch(U){console.error(U),F("error","Sending Failed!",U.message)}finally{t(!1)}};return e.jsx("div",{className:"modal",open:o,children:e.jsxs("form",{onSubmit:w,className:"max-w-md p-0 rounded-md modal-box bg-base-200",children:[e.jsxs("div",{className:"sticky top-0 flex items-start justify-between px-4 py-2 text-white rounded-t-md bg-primary-focus",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Send Customer Invoice"}),e.jsx("button",{type:"button",onClick:()=>p(!1),className:"btn btn-sm btn-circle btn-ghost",children:e.jsx(Y,{})})]}),e.jsx("div",{className:"px-5 max-h-[70vh] h-full overflow-auto",children:e.jsxs("div",{className:"grid gap-4 py-3",children:[e.jsxs("label",{htmlFor:"",className:"gap-2 form-control",children:[e.jsx("span",{className:"text-sm",children:"Enter Platform Type"}),e.jsx("select",{type:"text",className:"h-10 min-h-0 capitalize bg-transparent rounded select select-bordered select-primary focus:outline-none",name:"platform_type",children:(h=(r=b==null?void 0:b.support_send_alert_platform_type)==null?void 0:r.data)==null?void 0:h.map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsxs("label",{htmlFor:"",className:"gap-2 form-control",children:[e.jsx("span",{className:"text-sm",children:"Enter Receiver ID"}),e.jsx("input",{autoComplete:"off",type:"text",className:"h-10 min-h-0 bg-transparent rounded input input-bordered input-primary focus:outline-none",name:"receiver_id",defaultValue:n})]}),e.jsxs("label",{htmlFor:"",className:"gap-2 form-control",children:[e.jsx("span",{className:"text-sm",children:"Enter Receiver Name"}),e.jsx("input",{autoComplete:"off",type:"text",className:"h-10 min-h-0 bg-transparent rounded input input-bordered input-primary focus:outline-none",name:"name",defaultValue:f})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3 px-4 py-2 mt-2 border-t bg-base-300",children:[e.jsx("button",{type:"submit",className:"h-10 min-h-0 normal-case btn btn-primary",children:u?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"animate-spin"})," Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{})," Send"]})}),e.jsx("button",{type:"button",onClick:()=>p(!1),className:"h-10 min-h-0 normal-case bg-white btn hover:bg-white border-primary hover:border-primary",children:"Close"})]})]})})};ce.propTypes={isActive:g.bool.isRequired,setIsActive:g.func.isRequired,tracking_id:g.string,primary_customer_data:g.object};const de=({booking_details:o})=>{const{search_parameter:p}=(o==null?void 0:o.flight)||{},[c,m]=d.useState(!1),{axiosInstance:b}=I(),_=W(),v=async()=>{var x,f,n,u;if(!c){m(!0);try{const t=await b.post("/flight/search",p);if(((x=t==null?void 0:t.data)==null?void 0:x.status)==="success")H.update(()=>H._getInitialState()),_(`/flight/search?tracking_id=${t.data.tracking_id}`,{replace:!1});else throw new Error(((f=t==null?void 0:t.data)==null?void 0:f.reason)||((u=(n=t==null?void 0:t.response)==null?void 0:n.data)==null?void 0:u.message))}catch(t){console.error(t),F("error","Failed!",t.message)}}};return e.jsx("button",{onClick:v,className:"h-10 min-h-0 font-normal normal-case rounded btn btn-outline btn-primary flex-nowrap whitespace-nowrap border-neutral/30",children:c?e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"animate-spin"})," Searching..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"text-lg"})," Search Again"]})})};de.propTypes={booking_details:g.object.isRequired};export{de as R,ne as S,re as U,ie as a,ce as b};
