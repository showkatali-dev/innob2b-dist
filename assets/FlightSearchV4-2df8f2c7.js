import{e as g,o as e,bj as Za,ak as v,m as Ve,G as D,am as ke,b1 as De,l as lt,b0 as ct,Q as Ie,au as _e,U as et,al as at,bk as we,a1 as tt,a6 as ot,at as dt}from"./index-179efefa.js";import{a as pt}from"./index.esm-3d5568e8.js";import{cm as mt,x as ae,dl as ut,dm as xt,dn as ht,dp as ft,dq as _t,dr as bt,P as rt,a as Ye,w as Qe,ds as jt,dt as gt,d0 as yt,du as vt,v as Ge,co as Nt,c2 as wt,cn as kt,cl as St,b5 as Ct,cy as Ft,cz as $t,aV as Ot,cA as At,dv as Et,c as Bt,b as Tt,G as zt,H as It,dw as Mt}from"./App-5691a897.js";import{R as Ht,S as Lt,b as qt,a as Rt,P as Pt,F as Dt,c as Vt,d as Ut}from"./Searchbox3-30e2fc98.js";import{f as Qt,h as Yt}from"./index.esm-c1c027b2.js";import{d as Gt,R as Wt}from"./RangeSliderInput-0d8e8b2e.js";import{C as ee}from"./Checkbox-5b2bbb6a.js";import{F as nt,S as Xt,a as Jt}from"./SearchboxSkeleton-253c186f.js";import{z as Kt,B as Zt,c as er}from"./index.esm-ce8af5e8.js";import{a as ar}from"./index.esm-94007475.js";import{f as tr}from"./SuppliersSelection2-dfa5a5b5.js";import{F as rr}from"./FlightItineraryData-023b5d41.js";import{F as sr}from"./index-7569d28f.js";import"./MultipleFlight2-98c98de9.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./sweetalert2-react-content.es-bda22d70.js";import"./FareTypeSection-36b5f91e.js";import"./SingleSelect-2525a2fe.js";import"./InputDate-9187c7fb.js";import"./shortcut-buttons-flatpickr.min-b052b26a.js";import"./PrimaryTabsWithIcon-67c1c525.js";import"./index.esm-450c376a.js";const st=({min:p,max:n,defaultValue:l,value:c,action:x})=>{const[m,o]=g.useState({min:0,max:0});return g.useEffect(()=>{o({min:c[0]||p,max:c[1]||n})},[c,p,n]),e.jsxs("div",{className:"p-1 pt-2",children:[e.jsx("div",{className:"relative min-h-[30px] slider-container",children:e.jsx(Gt,{min:p,max:n,defaultValue:l,onInput:function(f){this.value=f,o({min:f[0],max:f[1]})},rangeSlideDisabled:!0,onThumbDragEnd:function(){x(this.value)},className:"h-1"})}),e.jsxs("div",{className:"flex items-center justify-between text-sm slider-value",children:[e.jsxs("span",{children:["Fri ",Za(m.min)]}),e.jsx("span",{children:Za(m.max)})]})]})},nr=({departureAirport:p,arrivalAirport:n})=>{const[l,c]=g.useState("takeoff"),{take_off:x,landing:m}=v.useState(o=>o.time);return e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(mt,{}),"Time"]})}),e.jsxs("div",{className:"px-0 mt-3 collapse-content",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-1 mb-2",children:[e.jsx("div",{onClick:()=>c("takeoff"),className:ae("cursor-pointer flex items-center justify-center text-sm py-1 rounded border",l==="takeoff"&&"bg-primary text-primary-content border-primary"),children:"Take off"}),e.jsx("div",{onClick:()=>c("landing"),className:ae("cursor-pointer flex items-center justify-center text-sm py-1 rounded border",l==="landing"&&"bg-primary text-primary-content border-primary"),children:"Landing"})]}),l==="takeoff"&&e.jsxs("div",{className:"space-y-2 v3",children:[e.jsxs("h2",{className:"text-sm",children:["Take-off from ",e.jsx("strong",{children:p})]}),e.jsx(st,{min:0,max:86399,defaultValue:[x.min_time,x.max_time],value:[x.min_time,x.max_time],action:o=>v.update(f=>{f.time.take_off={min_time:o[0],max_time:o[1]}})})]}),l==="landing"&&e.jsxs("div",{className:"space-y-2 v3",children:[e.jsxs("h2",{className:"text-sm",children:["Landing to ",e.jsx("strong",{children:n})]}),e.jsx(st,{min:0,max:86399,defaultValue:[m.min_time,m.max_time],value:[m.min_time,m.max_time],action:o=>v.update(f=>{f.time.landing={min_time:o[0],max_time:o[1]}})})]})]})]})},ir=()=>{const{refundable:p,non_refundable:n}=v.useState(l=>l.fare_type);return e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(ut,{}),"Fare Type"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsxs("div",{className:"flex flex-col gap-2 text-xs",children:[e.jsx(ee,{label:"Refundable",defaultChecked:p,action:l=>v.update(c=>{c.fare_type.refundable=l})}),e.jsx(ee,{label:"Non Refundable",defaultChecked:n,action:l=>v.update(c=>{c.fare_type.non_refundable=l})})]})})]})},lr=()=>e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(xt,{}),"Fare Assistant"]})}),e.jsxs("div",{className:"px-0 mt-3 collapse-content",children:[e.jsxs("label",{className:"gap-2 mb-2 form-control",children:[e.jsx("h2",{className:"text-sm",children:"Payment Method"}),e.jsxs("select",{className:"w-full rounded select select-sm focus:outline-0",children:[e.jsx("option",{value:"",disabled:!0,defaultChecked:!0,children:"Choose an option"}),e.jsx("option",{value:"1",children:"Option 1"}),e.jsx("option",{value:"2",children:"Option 2"})]})]}),e.jsxs("div",{className:"gap-2 form-control",children:[e.jsx("h2",{className:"text-sm",children:"Credit Card Fee"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center text-xs",children:[e.jsx("input",{type:"checkbox",className:"rounded-sm checkbox checkbox-xs checkbox-primary"}),e.jsx("span",{children:"Yes"})]}),e.jsxs("label",{className:"flex items-center text-xs",children:[e.jsx("input",{type:"checkbox",className:"rounded-sm checkbox checkbox-xs checkbox-primary"}),e.jsx("span",{children:"No"})]})]})]})]})]}),cr=({suppliers:p,priceBySuppliers:n,currency:l})=>{const{supplier_option:c}=Ve.useState(),{provider:x}=v.useState();if((c==null?void 0:c.status)==="YES")return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(ht,{}),"Providers"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsx("div",{className:"flex flex-col gap-2 text-xs",children:Object.entries(x).sort().map(([m,o])=>{const{title:f,logo:N}=p.find(M=>M.supplier_code===m)||{};return e.jsx(ee,{label:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("img",{src:N,alt:"",className:"w-5 h-5 p-0.5 rounded-full border"}),e.jsx("span",{className:"line-clamp-1",children:f}),e.jsxs("span",{className:"font-medium whitespace-nowrap text-[10px] ml-auto",children:[D(l)," ",n[m]]})]}),defaultChecked:o,action:M=>v.update(H=>{H.provider[m]=M})},m)})})})]}),e.jsx("hr",{className:"mb-2 -mt-1"})]})},or=()=>e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(ft,{}),"Flexible Flight Tickets"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsx("div",{className:"flex flex-col gap-2 text-xs",children:e.jsx(ee,{label:"No Change Fees",defaultChecked:!1,action:p=>console.log(p)})})})]}),dr=()=>e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0"}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(_t,{}),"Connecting Airports"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsxs("div",{className:"flex flex-col gap-2 text-xs",children:[e.jsx(ee,{label:"Vienna (VIE)",defaultChecked:!1,action:p=>console.log(p)}),e.jsx(ee,{label:"Manama (BAH)",defaultChecked:!1,action:p=>console.log(p)}),e.jsx(ee,{label:"Brussels (BRU)",defaultChecked:!1,action:p=>console.log(p)})]})})]}),pr=({filterOptions:p,updateFilterOptions:n})=>{const[l,c]=g.useState(!1),[x,m]=g.useState(null),o=(w,$)=>{m($),w.dataTransfer.setData("text/plain","")},f=()=>{m(null)},N=w=>{w.preventDefault()},M=(w,$)=>{if(!x)return;const Y=p.indexOf(x),V=p.indexOf($);if(Y!==-1&&V!==-1){const G=[...p];G.splice(Y,1),G.splice(V,0,x),n(G)}},H=g.useRef();return g.useEffect(()=>{const w=$=>{H.current&&!H.current.contains($.target)&&c(!1)};return document.addEventListener("click",w),()=>document.removeEventListener("mousedown",w)},[]),e.jsxs("div",{className:"relative",ref:H,children:[e.jsx("button",{onClick:()=>c(!l),className:"duration-200 rounded-md btn-xs btn-warning btn btn-square hover:scale-125",children:e.jsx(bt,{className:"animate-spin",style:{animation:"spin 2.5s linear infinite"}})}),e.jsx("div",{className:ae("absolute top-full mt-1 w-fit -translate-x-1/2 bg-base-200 rounded shadow-md",l?"block":"hidden"),children:e.jsx("ul",{className:"rounded join join-vertical border-x",children:p.map(w=>e.jsxs("li",{draggable:!0,onDragStart:$=>o($,w),onDragEnd:f,onDragOver:N,onDrop:$=>M($,w),style:{opacity:x===w?.5:1},className:"justify-between font-normal capitalize btn-xs btn join-item border-y-base-content/20 min-w-44",children:[w," ",e.jsx(ar,{className:"text-neutral"})]},w))})})]})},Ue=["price","stops","time","fare type","duration","fare assistant","flexible flight ticket","providers","baggage","airlines","cabin","aircraft","connecting airports"],it=({filterData:p,additionalData:n})=>{const{flight_search_sidebar:{mobile:{isActive:l}}}=ke.useState(),{axiosInstance:c}=Ye(),{data:x=[],isLoading:m}=Qe("AIRLINES",async()=>{const b=await c.get("/tools/airlines-data");return Object.entries(b.data.data).map(([j,d])=>({value:j,name:d.airline_name}))}),{price:o,duration:f,no_stop_summery:N,baggage_summery:M,operating:H,cabin_class:w,aircraft_names:$}=v.useState(b=>b),{min_price:Y,max_price:V,priceByStops:G,priceBySuppliers:me,priceByAirlines:W,currency:A,departureAirport:Se,arrivalAirport:k}=p,{min_duration:E,max_duration:U}=p,{supplier_option:q}=Ve.useState(),Q=g.useMemo(()=>{var b;return((b=q==null?void 0:q.data)==null?void 0:b.filter(T=>(T==null?void 0:T.supplier_type)==="FLIGHT"&&((n==null?void 0:n.supplier_uid)==="all"||(T==null?void 0:T.supplier_uid)===(n==null?void 0:n.supplier_uid))))||[]},[q==null?void 0:q.data,n==null?void 0:n.supplier_uid]);g.useEffect(()=>{const{min_price:b,max_price:T,min_duration:j,max_duration:d,cabin_class:F,aircraft_names:z,no_stop_summery:O,baggage_summery:oe,departure:xe,arrival:ge,carrier:y,priceBySuppliers:K}=p;v.update(I=>{I.price={min_price:b-5,max_price:T+5},I.duration={min_duration:j-5,max_duration:d+5},Object.keys(K||{}).forEach(h=>{I.provider[h]=!1}),Object.values(O).forEach(h=>{I.no_stop_summery[h!=null&&h.includes("1")?1:h!=null&&h.includes("2")?2:h!=null&&h.includes("3")?3:0]=!1}),Object.values(F).forEach(h=>{I.cabin_class[h]=!1}),Object.values(z).forEach(h=>{I.aircraft_names[h]=!1}),Object.values(oe).forEach(h=>{I.baggage_summery[h]=!1}),Object.values(xe.timing_slot).forEach(h=>{I.departure[h]&&(I.departure[h].value=!1)}),Object.values(ge.timing_slot).forEach(h=>{I.arrival[h]&&(I.arrival[h].value=!1)}),Object.values(y.operating).forEach(h=>{I.operating[h]=!1})})},[p]);const[X,te]=g.useState(!1),[t,B]=g.useState(!1),[ue,re]=g.useState(!1),[le,be]=g.useState(!0),[_,J]=g.useState(!0),[se,ce]=g.useState(Ue);g.useEffect(()=>{try{const b=localStorage.getItem("__ff"),T=atob(b),j=JSON.parse(T);ce(j||Ue)}catch{ce(Ue)}},[]);const je=b=>{ce(b)};return m?e.jsx(nt,{}):e.jsxs(e.Fragment,{children:[!_&&e.jsxs("button",{onClick:()=>J(!0),className:"flex items-center h-10 gap-4 pl-2 pr-3 text-sm border rounded-md border-primary w-fit",style:{background:"linear-gradient(73deg, hsl(var(--p)/1) 27%, #fff 29%)"},children:[e.jsx(jt,{className:"text-lg text-warning"})," ",e.jsx("span",{children:"Search Filter"})]}),e.jsxs("aside",{className:ae("filter-section fixed lg:translate-x-0 max-w-xs lg:max-w-full max-lg:top-0 max-lg:left-0 max-lg:bottom-0 overflow-visible duration-500 z-30 lg:z-0 bg-base-200 lg:bg-transparent lg:sticky lg:top-20 h-fit lg:rounded-lg lg:shadow-custom2 lg:mb-16 mx-auto",l?"translate-x-0":"translate-x-[-400px]",le?"w-full":"w-[80%]",_?"block":"hidden"),children:[e.jsxs("div",{className:"absolute top-0 left-0 z-10 flex justify-center w-full gap-1 -translate-y-1/2 max-sm:hidden",children:[e.jsx("button",{onClick:()=>be(!le),className:"duration-200 rounded-md btn-xs btn-warning btn btn-square hover:scale-125",children:le?e.jsx(Kt,{}):e.jsx(Zt,{})}),(n==null?void 0:n.journey_type)!=="MultiCity"&&e.jsx("button",{onClick:()=>ke.update(b=>{b.price_calendar.isActive=!b.price_calendar.isActive}),className:"duration-200 rounded-md btn-xs btn-warning btn btn-square hover:scale-125",children:l?e.jsx(gt,{}):e.jsx(yt,{})}),e.jsx("button",{onClick:()=>J(!1),className:"duration-200 rounded-md btn-xs btn-warning btn btn-square hover:scale-125",children:e.jsx(vt,{})}),e.jsx(pr,{filterOptions:se,updateFilterOptions:je})]}),e.jsxs("div",{className:"py-4 rounded-lg lg:shadow-lg lg:bg-base-200 max-h-screen lg:max-h-[calc(100vh-80px)] overflow-auto custom-scrollbar px-4 pt-5",children:[e.jsx("button",{onClick:()=>ke.update(b=>{b.flight_search_sidebar.mobile.isActive=!1}),className:"absolute z-30 flex ml-auto btn btn-sm btn-ghost btn-circle bg-red-500/20 hover:bg-red-500 hover:text-white lg:hidden top-1 right-1",children:e.jsx(Ge,{})}),se.map((b,T)=>{let j=null;switch(b){case"price":{j=e.jsxs("div",{className:"-mt-1 rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(Ct,{className:"mr-1"}),"Price Range"]})}),e.jsx("div",{className:"px-0 mt-2 collapse-content v3",children:e.jsx(Wt,{min:Y-5,max:V+5,defaultValue:[Y-5,V+5],value:[o==null?void 0:o.min_price,o==null?void 0:o.max_price],action:d=>v.update(F=>{F.price={min_price:d[0],max_price:d[1]}})})})]});break}case"stops":{j=e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(St,{className:"mr-1"}),"Stops"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsx("div",{className:"flex gap-2 text-xs",children:Object.entries(N).sort().map(([d,F])=>e.jsxs("label",{className:"flex flex-col items-center justify-center",children:[e.jsx("input",{type:"checkbox",className:"hidden peer",checked:F,onChange:z=>{v.update(O=>{O.no_stop_summery[d]=z.target.checked})}}),e.jsx("span",{className:"flex items-center justify-center w-8 h-6 text-sm border rounded-sm peer-checked:bg-primary peer-checked:text-primary-content peer-checked:border-primary",children:d}),e.jsxs("span",{className:"text-[8px] text-center tracking-tight",children:[D(A)," ",G[d]]})]},d))})})]});break}case"time":{j=e.jsx(nr,{departureAirport:Se,arrivalAirport:k});break}case"duration":{j=e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(kt,{className:"mr-1"}),"Duration"]})}),e.jsx("div",{className:"px-0 mt-2 collapse-content v3",children:e.jsx(Ht,{min:E>5?E-5:E,max:U+5,defaultValue:[E-5,U+5],value:[f==null?void 0:f.min_duration,f==null?void 0:f.max_duration],action:d=>v.update(F=>{F.duration={min_duration:d[0],max_duration:d[1]}})})})]});break}case"fare type":{j=e.jsx(ir,{});break}case"fare assistant":{j=e.jsx(lr,{});break}case"flexible flight tickets":{j=e.jsx(or,{});break}case"providers":{j=e.jsx(cr,{suppliers:Q,priceBySuppliers:me,currency:A});break}case"baggage":{j=e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(wt,{className:"mr-1"}),"Baggage"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsxs("div",{className:"flex flex-col gap-2 text-xs",children:[Object.entries(M).sort().slice(0,ue?void 0:3).map(([d,F])=>e.jsx(ee,{label:d,defaultChecked:F,action:z=>v.update(O=>{O.baggage_summery[d]=z})},d)),!ue&&Object.entries(M).length>3&&e.jsxs("button",{onClick:()=>re(!0),className:"font-medium text-left text-primary",children:["+",Object.entries(M).length-3," ","Baggage Options"]})]})})]});break}case"airlines":{j=e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(Yt,{}),"Airlines"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsxs("div",{className:"flex flex-col gap-2 text-xs",children:[Object.entries(H).sort().slice(0,t?void 0:4).map(([d,F])=>{var z;return e.jsx(ee,{label:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"line-clamp-1",children:((z=x.find(O=>O.value===d))==null?void 0:z.name)||d}),e.jsxs("span",{className:"font-medium whitespace-nowrap text-[10px]",children:[D(A)," ",W[d]]})]}),defaultChecked:F,action:O=>v.update(oe=>{oe.operating[d]=O})},d)}),!t&&Object.entries(H).length>4&&e.jsxs("button",{onClick:()=>B(!0),className:"font-medium text-left text-primary",children:["+",Object.entries(H).length-4," Airlines"]})]})})]});break}case"cabin":{j=e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(Nt,{className:"mr-1"}),"Cabin"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsx("div",{className:"flex flex-col gap-2 text-xs",children:Object.entries(w).sort().map(([d,F])=>e.jsx(ee,{label:d,defaultChecked:F,action:z=>v.update(O=>{O.cabin_class[d]=z})},d))})})]});break}case"aircraft":{j=e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0"}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(Qt,{className:"mr-1"}),"Aircraft"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsxs("div",{className:"flex flex-col gap-2 text-xs",children:[Object.entries($).sort().slice(0,X?void 0:4).map(([d,F])=>e.jsx(ee,{label:d,defaultChecked:F,action:z=>v.update(O=>{O.aircraft_names[d]=z})},d)),!X&&Object.entries($).length>4&&e.jsxs("button",{onClick:()=>te(!0),className:"font-medium text-left text-primary",children:["+",Object.entries($).length-4," ","Aircraft"]})]})})]});break}case"connecting airports":{j=e.jsx(dr,{});break}}return e.jsxs(g.Fragment,{children:[j,T!==se.length-1&&e.jsx("hr",{className:"mb-2 -mt-1"})]},b)})]})]}),l&&e.jsx("div",{onClick:()=>ke.update(b=>{b.flight_search_sidebar.mobile.isActive=!1}),className:"fixed top-0 bottom-0 left-0 right-0 z-20 lg:hidden bg-black/10 backdrop-blur-[2px]"})]})};it.propTypes={filterData:rt.object.isRequired,additionalData:rt.object.isRequired};const mr=()=>{const{active:p}=ke.useState(k=>k.modal),{data:n}=De.useState(),[l,c]=g.useState(!1),[x,m]=g.useState(!1),[o,f]=g.useState(!1),{user_data:N}=lt.useState(),{member_id:M,partner_from_email_full_name:H,partner_from_email_address:w}=N||{},[$,Y]=Ft(),V=g.useRef(),{axiosInstance:G}=Ye(),{system_config:me}=Ve.useState(),W=()=>{ct(),m(!1)},A=async k=>{var E,U,q;if(k.preventDefault(),!l){c(!0);try{const Q=k.target,X=Q.name.value,te=Q.email.value,t=Q.message.value,B=await G.post("/tools/send-email",{email_subject:"Multiple Flight Sharing with you",email_body:`<!DOCTYPE html>
        <html lang="en">
        
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <style>
                * {
                    padding: 0;
                    margin: 0;
                    box-sizing: border-box;
                    font-size: inherit;
        
                }
        
                body {
                    font-size: 16px;
                    line-height: 20px;
                }
            </style>
        
        </head>
        
        <body>
        
        
            <div
                style="min-height: 100vh; font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; color: #60636b; font-size: 15px;">
        
                <div style="width: 100%; border-radius: 5px; background-color: #fff; font-weight: 500; overflow: hidden;">
        
                    <div style="margin-bottom: 14px; padding: 1rem 1rem 0 1rem;">
                        <h5 style="font-weight: bold; margin-bottom: 10px; font-size: 16px;">Hi, ${X}</h5>
                        <p style="font-size: 14px;">${t}</p>
                    </div>
        
                    <div style="padding: 1rem;">
                        ${n.map(({flight_group:ue,price_breakdown:re})=>{var le,be;return`
                        <div style="padding: 12px; border-radius: 8px; border: 1px solid #f0f0f0;">
        
                            <div style="border: 1px solid #E5E7EB; border-radius: 8px; margin-bottom: 30px;">
                                ${ue.map(_=>`
                                <div>
                                    <div style="padding: 12px; border-bottom: 1px solid #E5E7EB;">
                                        <h6 style="font-weight: 500;">${_.routes[0].origin_airport.city} to
                                            ${_.routes.at(-1).destination_airport.city},
                                            ${Ie(_.routes[0].departure_time).format(me.default_date_format_print)}</h6>
                                    </div>
                                    <div style="padding: 12px;">
                                        ${_.routes.map(J=>{var I,h,Ce,Fe,$e,Oe,Ae,Ee,Be,Te;const{lay_over:se,operating:{carrier_name:ce,carrier:je,flight_number:b,carrier_logo:T},aircraft:{name:j},departure_time:d,origin_airport:{name:F},origin_terminal:z,arrival_time:O,destination_airport:{name:oe,destination_terminal:xe},flight_time:ge,baggages:y,booking_class:K}=J;return`
                                        <div>
        
                                            ${se!=="not-applicable"?`
                                            <div
                                                style="background-color: #f4f4f4; border-radius: 8px; padding: 4px 8px; margin-top: 30px; margin-bottom: 30px; width: fit-content; margin-left: auto; margin-right: auto;">
                                                <p style="text-align: center; font-size: 12px;"><span
                                                        style="color: #dfa33a; font-weight: 700;">Change
                                                        of Airport</span> • Change of planes • ${_e(se)} layover in ${F}</p>
                                            </div>
                                            `:""}
        
                                            <div style="display: flex; margin-bottom: 16px;">
                                                <img style="border: 1px solid #f0f0f0; width: 2.4rem; height: 2.4rem; border-radius: 50%; margin-right: 12px;"
                                                    src="https://gtrs-airlineimages.s3.ap-southeast-1.amazonaws.com/icon/${T}"
                                                    alt="" />
                                                <h6 style="font-weight: 500;">${ce} <span
                                                        style="color: #9BA0B2;">${je} | ${b}</span></h6>
                                            </div>
                                            <table style="width: 100%; margin-bottom: 16px;">
                                                <tr>
                                                    <td>
                                                        <div style="text-align: center;">
                                                            <h4 style="font-size: 24px; font-weight: 600px;">${Ie(d).format("HH:mm")}</h4>
                                                            <p style="font-size: 12px; color: #7a7a7a;">${Ie(d).format(me.default_date_format_print)}</p>
                                                            <p style="font-size: 12px; color: #7a7a7a;">
                                                                ${F}
                                                            </p>
                                                            ${z?`
                                                            <p style="font-size: 10px; color: #b6b6b6;">Terminal
                                                                ${z}</p>
                                                            `:""}
        
                                                        </div>
        
        
                                                    </td>
                                                    <td>
                                                        <div style="flex-shrink: 0; text-align: center;">
                                                            <h6
                                                                style="margin-left: auto; margin-right: auto; font-size: 12px; font-weight: 500; width: fit-content;">
                                                                ${_e(ge)}</h6>
        
                                                            <div
                                                                style="width: 56px; height: 2px; margin-left: auto; margin-right: auto; margin-top: 8px; margin-bottom: 8px; display: flex; background-color: #f97316;">
        
                                                            </div>
        
        
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <div style="text-align: center;">
                                                            <h4 style="font-size: 24px; font-weight: 600px;">${Ie(O).format("HH:mm")}</h4>
                                                            <p style="font-size: 12px; color: #7a7a7a;">${Ie(O).format(me.default_date_format_print)}</p>
                                                            <p style="font-size: 12px; color: #7a7a7a;">
                                                                ${oe}</p>
        
                                                            ${xe?`
                                                            <p style="font-size: 10px; color: #b6b6b6;">Terminal
                                                                ${xe}</p>
                                                            `:""}
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                            <table style="width: 100%;">
                                                <tr>
                                                    <td style="width: 100%;">
                                                        <div>
                                                            <div
                                                                style="display: flex; gap: 8px; font-size: 12px; color: #0FA976;">
                                                                <p style="font-weight: 500; margin-right: 2px;">
                                                                    Baggage:
                                                                </p>
                                                                <p>
                                                                    ${(h=(I=y==null?void 0:y.checked)==null?void 0:I.ADT)!=null&&h.title?y.checked.ADT.title:"0 pieces"} for ADT
                                                                </p>
        
                                                                ${(Fe=(Ce=y==null?void 0:y.checked)==null?void 0:Ce.CNN)!=null&&Fe.title?`
                                                                <p>
                                                                    ${y.checked.CNN.title}{" "}
                                                                    for CNN
                                                                </p>
                                                                `:""}
        
                                                                ${(Oe=($e=y==null?void 0:y.checked)==null?void 0:$e.INF)!=null&&Oe.title?`
                                                                <p>
                                                                    ${y.checked.INF.title}{" "}
                                                                    for INF
                                                                </p>
                                                                `:""}
                                                            </div>
                                                            <div
                                                                style="display: flex; gap: 8px; font-size: 12px; color: #078db6;">
                                                                <p style="font-weight: 500; margin-right: 2px;">Hand
                                                                    Baggage: ${(Ee=(Ae=y==null?void 0:y.carry_on)==null?void 0:Ae.ADT)!=null&&Ee.title?y.carry_on.ADT.title:"7 kg*"} for ADT</p>
        
                                                              
                                                                <p style="font-weight: 500; margin-right: 2px;">
                                                                    ${((Te=(Be=y==null?void 0:y.carry_on)==null?void 0:Be.CNN)==null?void 0:Te.title)||"7 kg*"}{" "}
                                                                    for
                                                                    CNN
                                                                </p>
                                                            </div>
                                                        </div>
        
                                                    </td>
                                                    <td style="width: fit-content; white-space: nowrap;">
                                                        <div>
                                                            <div style="display: flex; font-size: 12px; color: #eab308;">
                                                                <p style="font-weight: 500; margin-right: 8px;">Cabin Class:
                                                                    <span class="capitalize">${K!=null&&K.cabin_class?K==null?void 0:K.cabin_class:"N/A"}</span>
                                                                </p>
                                                            </div>
                                                            <div style="display: flex; font-size: 12px; color: #078db6;">
                                                                <p
                                                                    style="margin-right: 8px; font-weight: 500; display: flex; align-items: center;">
                                                                    Aircraft: ${j||"N/A"}
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                        `}).join(`
`)}
        
                                    </div>
                                </div>
                                `).join(`
`)}
        
                            </div>
        
        
                            ${o?`
                            <div style="border: 1px solid #e0e0e0; border-radius: 8px; margin-bottom: 30px;">
                                <div style="padding: 12px; border-bottom: 1px solid #e0e0e0;">
                                    <h6 style="font-weight: 500;">Fare breakdown</h6>
                                </div>
                                <div style="width: 100%; padding: 12px; overflow-x: auto;">
                                    <table style="font-size: 14px; border-collapse: collapse; text-align: center; width: 100%;">
                                        <thead>
                                            <tr>
                                                <th style="padding: 8px; border: 1px solid #e0e0e0;">Fare Summary</th>
                                                <th style="padding: 8px; border: 1px solid #e0e0e0;">Base Fare</th>
                                                <th style="padding: 8px; border: 1px solid #e0e0e0;">Taxes + Fees</th>
                                                <th style="padding: 8px; border: 1px solid #e0e0e0;">Per Passenger</th>
                                                <th style="padding: 8px; border: 1px solid #e0e0e0;">Total</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${re==null?void 0:re.map(_=>`
                                            <tr>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;">${_.passenger_type}
                                                </td>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;">
                                                    ${D(_.base_fare.currency)}
                                                    ${_.base_fare.amount}</td>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;">
                                                    ${D(_.tax.currency)} ${_.tax.amount}
                                                </td>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;">
                                                    ${D(_.total.currency)} (
                                                    ${_.total.amount/_.passenger_total} x
                                                    ${_.passenger_total})</td>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;">
                                                    ${D(_.total.currency)} ${_.total.amount}</td>
                                            </tr>
                                            `).join(`
`)}
                                        </tbody>
                                        <tfoot>
                                            <tr>
                                                <th
                                                    style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;text-align: start;">
                                                    Total (
                                                    ${re.map(_=>_.passenger_total).reduce((_,J)=>_+J,0)}
                                                    Travelers)</th>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;"></td>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;"></td>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;"></td>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;">
                                                    ${D((be=(le=re[0])==null?void 0:le.total)==null?void 0:be.currency)}
                                                    ${re.map(_=>_.total.amount).reduce((_,J)=>_+J,0)}</td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                            `:""}
        
                        </div>
        
        
                        `}).join(`
`)}
                    </div>
                </div>
            </div>
        
        </body>
        
        </html>`,email_to:{full_name:X,email_addresss:te},email_from:{full_name:H,email_addresss:w}});if(W(),((E=B==null?void 0:B.data)==null?void 0:E.status)==="success")et("success","Sent!",(U=B==null?void 0:B.data)==null?void 0:U.reason);else throw new Error((q=B==null?void 0:B.data)==null?void 0:q.reason)}catch(Q){et("error","Failed!",Q.message)}finally{c(!1)}}},Se=async()=>{var k;try{const E=$||await Y(V.current),U=E==null?void 0:E.match(/^data:image\/([^;]+)/),q=U?U[1]:null,Q=E.replace(/^data:image\/[^;]+;base64,/,""),X=await G.post("/tools/upload-base64-file",{image_type:"data",category:"flight_details",fileExtension:q,documents_image_url:Q,member_id:M});if(((k=X.data)==null?void 0:k.status)==="success"){const{ObjectURL:te}=X.data;navigator.clipboard.writeText(te),m(!0)}}catch(E){console.error(E)}};return e.jsx("div",{className:"modal",open:p==="multiple_flight_share",children:e.jsxs("form",{onSubmit:A,className:"max-w-5xl p-0 rounded-md modal-box bg-base-200",children:[e.jsxs("div",{className:"sticky top-0 flex items-start justify-between px-4 py-2 text-white rounded-t-md bg-primary-focus",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Flight Share"}),e.jsx("button",{onClick:W,type:"button",className:"btn btn-sm btn-circle btn-ghost",children:e.jsx(Ge,{})})]}),e.jsxs("div",{className:"p-5 max-h-[70vh] h-full overflow-auto",children:[e.jsx("div",{className:"grid gap-4",ref:V,children:n.map(k=>{const{flight_group:E,price_breakdown:U}=k;return e.jsxs("div",{className:"p-3 space-y-4 border rounded-lg",children:[e.jsx(rr,{flight_group:E}),o&&e.jsx(sr,{price_breakdown:U})]},k==null?void 0:k.flight_key)})}),e.jsxs("div",{className:"grid grid-cols-3 gap-5 mt-8",children:[e.jsxs("div",{className:"gap-2 form-control",children:[e.jsx("label",{children:"Name:"}),e.jsx("input",{autoComplete:"off",type:"text",className:"h-10 min-h-0 bg-transparent rounded input input-bordered focus:outline-none focus:border-primary",name:"name",placeholder:"Name",required:!0})]}),e.jsxs("div",{className:"gap-2 form-control",children:[e.jsx("label",{children:"Email:"}),e.jsx("input",{autoComplete:"off",type:"email",className:"h-10 min-h-0 bg-transparent rounded input input-bordered focus:outline-none focus:border-primary",name:"email",placeholder:"Email",required:!0})]}),e.jsxs("div",{className:"gap-2 form-control",children:[e.jsx("label",{children:"Price Include"}),e.jsxs("select",{className:"h-10 min-h-0 bg-transparent rounded select select-bordered focus:outline-none focus:border-primary",required:!0,value:o?"yes":"no",onChange:k=>f(k.target.value==="yes"),children:[e.jsx("option",{value:"no",children:"No"}),e.jsx("option",{value:"yes",children:"Yes"})]})]}),e.jsxs("div",{className:"col-span-3 gap-2 form-control",children:[e.jsx("label",{children:"Message:"}),e.jsx("textarea",{className:"py-2 bg-transparent rounded min-h-16 input input-bordered focus:outline-none focus:border-primary",name:"message",placeholder:"Message",required:!0})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 px-4 py-2 mt-2 border-t bg-base-300",children:[e.jsxs("div",{className:"dropdown dropdown-top dropdown-end",children:[e.jsxs("div",{tabIndex:0,role:"button",className:"min-h-0 normal-case btn btn-primary h-11",children:[e.jsx(tr,{})," Share"]}),e.jsx("ul",{tabIndex:0,className:"dropdown-content mb-2 z-[1] menu p-2 shadow bg-base-100 rounded-box w-52",children:e.jsx("li",{className:"flex items-center justify-center px-3 py-3",children:e.jsxs("button",{type:"button",tabIndex:-1,onClick:Se,className:"flex flex-col items-center justify-center gap-2 text-center duration-100 hover:!bg-primary/10 focus:!bg-primary/10 active:scale-90",children:[e.jsx($t,{className:"text-xl text-primary"})," ",e.jsx("span",{className:"text-xs",children:x?"Copied":"Copy Link to Clipboard"})]})})})]}),e.jsx("button",{type:"submit",className:"min-h-0 normal-case btn btn-secondary h-11",children:l?e.jsxs(e.Fragment,{children:[e.jsx(Ot,{className:"animate-spin"})," Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(At,{})," Send Email"]})})]})]})})},ur=({filterData:p})=>{const{sortBy:n}=v.useState(N=>N.sorting),{lowestPrice:l,fastestFlight:c,earliestArrivalTime:x,earliestDepartureTime:m,highestPrice:o,currency:f}=p||{};return e.jsxs("div",{className:"grid grid-cols-6 gap-2 mb-5",children:[e.jsxs("div",{onClick:()=>v.update(N=>{N.sorting.sortBy="cheapest"}),className:ae("p-1 border rounded shadow cursor-pointer bg-secondary/20 shadow-secondary/20 border-transparent",n==="cheapest"&&"border-secondary"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Low Price"}),e.jsx("img",{src:`https://gtrs-airlineimages.s3.ap-southeast-1.amazonaws.com/icon/${l==null?void 0:l.carrier_operating}.png`,alt:"Sabre HE9L - Sandbox",className:"w-4 h-4 border rounded-full"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("h4",{className:"text-xs font-medium",children:[D(f)," ",l==null?void 0:l.total_price]}),e.jsx("span",{className:"text-[10px] text-neutral",children:"|"}),e.jsx("p",{className:"text-[10px] text-neutral",children:_e(l==null?void 0:l.duration)})]})]}),e.jsxs("div",{onClick:()=>v.update(N=>{N.sorting.sortBy="fastest"}),className:ae("p-1 border rounded shadow cursor-pointer bg-success/20 shadow-success/20 border-transparent",n==="fastest"&&"border-success"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Quickest"}),e.jsx("img",{src:`https://gtrs-airlineimages.s3.ap-southeast-1.amazonaws.com/icon/${c==null?void 0:c.carrier_operating}.png`,alt:"Sabre HE9L - Sandbox",className:"w-4 h-4 border rounded-full"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("h4",{className:"text-xs font-medium",children:[D(f)," ",c==null?void 0:c.total_price]}),e.jsx("span",{className:"text-[10px] text-neutral",children:"|"}),e.jsx("p",{className:"text-[10px] text-neutral",children:_e(c==null?void 0:c.duration)})]})]}),e.jsxs("div",{onClick:()=>v.update(N=>{N.sorting.sortBy="arrival_time"}),className:ae("p-1 border rounded shadow cursor-pointer bg-warning/20 shadow-warning/20 border-transparent",n==="arrival_time"&&"border-warning"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Arrival Time"}),e.jsx("img",{src:`https://gtrs-airlineimages.s3.ap-southeast-1.amazonaws.com/icon/${x==null?void 0:x.carrier_operating}.png`,alt:"Sabre HE9L - Sandbox",className:"w-4 h-4 border rounded-full"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("h4",{className:"text-xs font-medium",children:[D(f)," ",x==null?void 0:x.total_price]}),e.jsx("span",{className:"text-[10px] text-neutral",children:"|"}),e.jsx("p",{className:"text-[10px] text-neutral",children:_e(x==null?void 0:x.duration)})]})]}),e.jsxs("div",{onClick:()=>v.update(N=>{N.sorting.sortBy="departure_time"}),className:ae("p-1 border rounded shadow cursor-pointer bg-info/20 shadow-info/20 border-transparent",n==="departure_time"&&"border-info"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Depart Time"}),e.jsx("img",{src:`https://gtrs-airlineimages.s3.ap-southeast-1.amazonaws.com/icon/${m==null?void 0:m.carrier_operating}.png`,alt:"Sabre HE9L - Sandbox",className:"w-4 h-4 border rounded-full"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("h4",{className:"text-xs font-medium",children:[D(f)," ",m==null?void 0:m.total_price]}),e.jsx("span",{className:"text-[10px] text-neutral",children:"|"}),e.jsx("p",{className:"text-[10px] text-neutral",children:_e(m==null?void 0:m.duration)})]})]}),e.jsxs("div",{onClick:()=>v.update(N=>{N.sorting.sortBy="highest_price"}),className:ae("p-1 border rounded shadow cursor-pointer bg-primary/20 shadow-primary/20 border-transparent",n==="highest_price"&&"border-primary"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Highest Price"}),e.jsx("img",{src:`https://gtrs-airlineimages.s3.ap-southeast-1.amazonaws.com/icon/${o==null?void 0:o.carrier_operating}.png`,alt:"Sabre HE9L - Sandbox",className:"w-4 h-4 border rounded-full"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("h4",{className:"text-xs font-medium",children:[D(f)," ",o==null?void 0:o.total_price]}),e.jsx("span",{className:"text-[10px] text-neutral",children:"|"}),e.jsx("p",{className:"text-[10px] text-neutral",children:_e(o==null?void 0:o.duration)})]})]}),e.jsx("div",{className:"p-1 rounded shadow bg-error/30 shadow-error/30",children:e.jsxs("div",{className:"flex items-center justify-center h-full font-medium",children:[e.jsx(Et,{className:"text-xl"})," Other sort"]})})]})},Ir=()=>{var _,J,se,ce,je,b,T,j,d,F,z,O,oe,xe,ge,y,K,I,h,Ce,Fe,$e,Oe,Ae,Ee,Be,Te,We,Xe,Je,Ke,Ze,ea,aa,ta,ra,sa,na,ia;const{axiosInstance:p}=Ye(),{filteredData:n}=at.useState(r=>r),{price:l,duration:c,baggage_summery:x,no_stop_summery:m,cabin_class:o,aircraft_names:f,departure:N,arrival:M,operating:H,sorting:w,provider:$,time:{take_off:Y,landing:V}}=v.useState(r=>r),{site_title:G,login_required:me,system_config:W,component_version:A}=Ve.useState(),[Se]=Bt(),k=Se.get("tracking_id"),E=Tt(),[U,q]=g.useState(!0),[Q,X]=g.useState(null),{data:te=[]}=Qe(["AIRPORTS_DATA"],async()=>(await p.get("/tools/airport-autosuggetion-data")).data),{data:t,isLoading:B,error:ue}=Qe(["SEARCH_RESULT",k],async()=>{var s,i,S,R,ne,he,de,fe,pe,ie,Me,He,Le,qe,Re,Pe;const r=await p.get(`/flight_logs?tracking_id=${k}&base_url=${W!=null&&W.supplier_logs_file_base_url?W==null?void 0:W.supplier_logs_file_base_url:""}&login_required=${me}`);if(!k)return E("/"),null;if(((s=r==null?void 0:r.data)==null?void 0:s.status)==="success"){ke.update(a=>{var ze;a.modal.data=(ze=r.data)==null?void 0:ze.data[0]}),X((i=r.data)==null?void 0:i.message);const ye={},ve={},Ne={},Z={},u={},C={},P={},L={};return(S=r.data)==null||S.data.forEach(a=>{var ca,oa,da,pa,ma,ua,xa,ha,fa,_a,ba,ja,ga,ya,va,Na,wa,ka,Sa,Ca,Fa,$a,Oa,Aa,Ea,Ba,Ta,za,Ia,Ma,Ha,La,qa,Ra,Pa,Da,Va,Ua,Qa,Ya,Ga,Wa,Xa,Ja,Ka;(!ye[(ca=a==null?void 0:a.filter)==null?void 0:ca.no_of_stops]||ye[(oa=a==null?void 0:a.filter)==null?void 0:oa.no_of_stops]>((da=a==null?void 0:a.filter)==null?void 0:da.price))&&(ye[(pa=a==null?void 0:a.filter)==null?void 0:pa.no_of_stops]=(ma=a==null?void 0:a.filter)==null?void 0:ma.price),(!ve[(ua=a==null?void 0:a.supplier)==null?void 0:ua.supplier_code]||ve[(xa=a==null?void 0:a.supplier)==null?void 0:xa.supplier_code]>((ha=a==null?void 0:a.filter)==null?void 0:ha.price))&&(ve[(fa=a==null?void 0:a.supplier)==null?void 0:fa.supplier_code]=(_a=a==null?void 0:a.filter)==null?void 0:_a.price),(!Ne[(ba=a==null?void 0:a.filter)==null?void 0:ba.carrier_operating]||Ne[(ja=a==null?void 0:a.filter)==null?void 0:ja.carrier_operating]>((ga=a==null?void 0:a.filter)==null?void 0:ga.price))&&(Ne[(ya=a==null?void 0:a.filter)==null?void 0:ya.carrier_operating]=(va=a==null?void 0:a.filter)==null?void 0:va.price),(!Z.total_price||Z.total_price>((Na=a==null?void 0:a.filter)==null?void 0:Na.price))&&(Z.total_price=(wa=a==null?void 0:a.filter)==null?void 0:wa.price,Z.duration=(Sa=(ka=a==null?void 0:a.filter)==null?void 0:ka.journey)==null?void 0:Sa.duration,Z.carrier_operating=(Ca=a==null?void 0:a.filter)==null?void 0:Ca.carrier_operating),(!L.total_price||L.total_price<((Fa=a==null?void 0:a.filter)==null?void 0:Fa.price))&&(L.total_price=($a=a==null?void 0:a.filter)==null?void 0:$a.price,L.duration=(Aa=(Oa=a==null?void 0:a.filter)==null?void 0:Oa.journey)==null?void 0:Aa.duration,L.carrier_operating=(Ea=a==null?void 0:a.filter)==null?void 0:Ea.carrier_operating),(!u.duration_seconds||u.duration_seconds>((Ta=(Ba=a==null?void 0:a.filter)==null?void 0:Ba.journey)==null?void 0:Ta.duration_seconds))&&(u.total_price=(za=a==null?void 0:a.filter)==null?void 0:za.price,u.duration_seconds=(Ma=(Ia=a==null?void 0:a.filter)==null?void 0:Ia.journey)==null?void 0:Ma.duration_seconds,u.duration=(La=(Ha=a==null?void 0:a.filter)==null?void 0:Ha.journey)==null?void 0:La.duration,u.carrier_operating=(qa=a==null?void 0:a.filter)==null?void 0:qa.carrier_operating);const ze=new Date((Pa=(Ra=a==null?void 0:a.filter)==null?void 0:Ra.arrival_departure_time)==null?void 0:Pa.slice(0,16)).getTime();(!C.time||C.time>ze)&&(C.time=ze,C.total_price=(Da=a==null?void 0:a.filter)==null?void 0:Da.price,C.duration=(Ua=(Va=a==null?void 0:a.filter)==null?void 0:Va.journey)==null?void 0:Ua.duration,C.carrier_operating=(Qa=a==null?void 0:a.filter)==null?void 0:Qa.carrier_operating);const la=new Date((Ga=(Ya=a==null?void 0:a.filter)==null?void 0:Ya.departure_departure_time)==null?void 0:Ga.slice(0,16)).getTime();(!P.time||P.time>la)&&(P.time=la,P.total_price=(Wa=a==null?void 0:a.filter)==null?void 0:Wa.price,P.duration=(Ja=(Xa=a==null?void 0:a.filter)==null?void 0:Xa.journey)==null?void 0:Ja.duration,P.carrier_operating=(Ka=a==null?void 0:a.filter)==null?void 0:Ka.carrier_operating)}),r.data.filter_data={...r.data.filter_data,priceByStops:ye,priceBySuppliers:ve,priceByAirlines:Ne,currency:(de=(he=(ne=(R=r.data)==null?void 0:R.data[0])==null?void 0:ne.price)==null?void 0:he.total)==null?void 0:de.currency,departureAirport:(Me=(ie=(pe=(fe=r.data)==null?void 0:fe.data[0])==null?void 0:pe.search_parameter)==null?void 0:ie.departure_airport)==null?void 0:Me.at(0),arrivalAirport:(Re=(qe=(Le=(He=r.data)==null?void 0:He.data[0])==null?void 0:Le.search_parameter)==null?void 0:qe.arrival_airport)==null?void 0:Re.at(-1),lowestPrice:Z,highestPrice:L,fastestFlight:u,earliestArrivalTime:C,earliestDepartureTime:P},r.data}else throw{...r,message:((Pe=r.data)==null?void 0:Pe.reason)||"Request failed!"}});g.useEffect(()=>{if(!B){if(t){let r=[...t.data];r=r.filter(s=>s.filter.price>l.min_price&&s.filter.price<l.max_price||!l.min_price||!l.max_price),r=r.filter(s=>!(c!=null&&c.min_duration)||s.filter.journey.duration_seconds>c.min_duration&&s.filter.journey.duration_seconds<c.max_duration),r=r.filter(s=>{var S;const i=we((S=s.filter.departure_departure_time)==null?void 0:S.slice(11,16));return i?i>=Y.min_time&&i<=Y.max_time:!0}),r=r.filter(s=>{var S;const i=we((S=s.filter.arrival_departure_time)==null?void 0:S.slice(11,16));return i?i>=V.min_time&&i<=V.max_time:!0}),r=r.filter(s=>Object.values($).every(i=>i===!1)?!0:$[s.supplier.supplier_code]===!0),r=r.filter(s=>Object.values(x).every(i=>i===!1)?!0:x[s.filter.baggage_summery]===!0),r=r.filter(s=>{var i,S;return Object.values(m).every(R=>R===!1)?!0:m[s.filter.no_stop_summery.includes("1")?1:(i=s.filter.no_stop_summery)!=null&&i.includes("2")?2:(S=s.filter.no_stop_summery)!=null&&S.includes("3")?3:0]===!0}),r=r.filter(s=>{var i;return Object.values(N).every(S=>S.value===!1)?!0:((i=N[s.filter.departure_timing_slot])==null?void 0:i.value)===!0}),r=r.filter(s=>{var i;return Object.values(M).every(S=>S.value===!1)?!0:((i=M[s.filter.arrival_timing_slot])==null?void 0:i.value)===!0}),r=r.filter(s=>Object.values(H).every(i=>i===!1)?!0:H[s.filter.carrier_operating]===!0),r=r.filter(s=>Object.values(o).every(i=>i===!1)?!0:o[s.filter.cabin_class]===!0),r=r.filter(s=>Object.values(f).every(i=>i===!1)?!0:f[s.filter.aircraft_name]===!0),r=r.map(s=>{var S;return{...s,package_count:((S=[...r].filter(R=>(R==null?void 0:R.filter_unique_filter_code)===(s==null?void 0:s.filter_unique_filter_code)))==null?void 0:S.length)||1}}),r.sort((s,i)=>{var S,R,ne,he,de,fe,pe,ie;return w.sortBy==="cheapest"?s.filter.price-i.filter.price:w.sortBy==="fastest"?s.filter.journey.duration_seconds-i.filter.journey.duration_seconds:w.sortBy==="arrival_time"?we((R=(S=s==null?void 0:s.filter)==null?void 0:S.arrival_departure_time)==null?void 0:R.slice(11,16))-we((he=(ne=i==null?void 0:i.filter)==null?void 0:ne.arrival_departure_time)==null?void 0:he.slice(11,16)):w.sortBy==="departure_time"?we((fe=(de=s==null?void 0:s.filter)==null?void 0:de.departure_departure_time)==null?void 0:fe.slice(11,16))-we((ie=(pe=i==null?void 0:i.filter)==null?void 0:pe.departure_departure_time)==null?void 0:ie.slice(11,16)):i.filter.price-s.filter.price}),at.update(s=>{s.filteredData=r})}q(!1)}},[l,c,t,x,m,N,M,H,w,f,o,B,$,Y,V]),g.useEffect(()=>{var r;if(((r=t==null?void 0:t.data)==null?void 0:r.length)>0&&te.length>0){const{search_parameter:{journey_type:s,non_stop_flight:i,baggage_option:S,booking_class:R,segment:ne,travelers_adult:he,travelers_child:de,travelers_child_age:fe,travelers_infants:pe,travelers_infants_age:ie,preferred_carrier:Me,supplier_uid:He,fare_type:Le,fare_corporate_code:qe,travelers_ptc:Re,fare_option:Pe,fare_account_code:ye,partner_id:ve}}=t.data[0],Ne=window.location.origin,Z=te.reduce((u,C)=>(u[C.code]=C,u),{});tt.update(u=>{u.partner_id=ve,u.fare_type=Le,u.fare_corporate_code=qe,u.fare_account_code=ye,u.travelers_ptc=Re,u.fare_option=Pe,u.journey_type=s,u.non_stop_flight=i,u.baggage_option=S,u.booking_class=R,u.travelers_adult=Number(he)||0,u.travelers_child=Number(de)||0,u.travelers_child_age=fe.slice(0,Number(de))||[],u.travelers_infants=Number(pe)||0,u.travelers_infants_age=(ie==null?void 0:ie.slice(0,Number(pe)))||[],ne.forEach((C,P)=>{u.segment[P]={...C,departure_airport_type:C.departure_airport_type,departure_airport:C.departure_airport_type==="AIRPORT"?Z[C.departure_airport]:Object.values(Z).find(L=>L.city_code===C.departure_airport),arrival_airport_type:C.arrival_airport_type,arrival_airport:C.arrival_airport_type==="AIRPORT"?Z[C.arrival_airport]:Object.values(Z).find(L=>L.city_code===C.arrival_airport)}}),u.flight_count=ne.length>2?ne.length:2,u.supplier_uid=He}),zt.get(`${Ne}/airlines_list.json`).then(u=>{const C=Object.keys(u.data.data).map(P=>{const{iata_code:L,airline_name:a}=u.data.data[P];return{label:`${a} (${L})`,value:L}});tt.update(P=>{P.preferred_carrier=Me.map(L=>C.find(a=>a.value===L))||[]})}),le(!1)}},[t,te]),It.useMediaQuery({query:"(max-width: 640px)"});const[re,le]=g.useState(!1),{isActive:be}=De.useState();if(ue)throw ue;return e.jsxs("main",{className:"container min-h-screen pt-20",children:[e.jsx(ot,{children:e.jsxs("title",{children:["Flight Search",G?" - "+G:""]})}),!B&&(t!=null&&t.filter_data)?((_=A==null?void 0:A.flight)==null?void 0:_.search_box)==="2"?e.jsx(Lt,{}):((J=A==null?void 0:A.flight)==null?void 0:J.search_box)==="3"?e.jsx(qt,{}):e.jsx(Rt,{}):e.jsx(Xt,{}),((je=(ce=(se=t==null?void 0:t.data)==null?void 0:se.at(0))==null?void 0:ce.search_parameter)==null?void 0:je.journey_type)!=="MultiCity"&&((b=t==null?void 0:t.data)==null?void 0:b.length)>0&&e.jsx(Pt,{search_parameter:(T=t==null?void 0:t.data[0])==null?void 0:T.search_parameter}),!B&&(t==null?void 0:t.filter_data)&&Q&&e.jsx("div",{className:"mb-4 overflow-hidden border rounded-md shadow bg-base-200 border-warning animate-pulse",children:e.jsxs("div",{className:"relative px-3 py-2 bg-warning/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"py-1 text-warning",children:e.jsx(er,{className:"text-xl"})}),e.jsx("div",{children:e.jsx("p",{className:"text-xs font-normal",children:Q})})]}),e.jsx("button",{onClick:()=>X(null),className:"absolute top-1 right-1 btn btn-ghost btn-circle btn-sm !bg-transparent",children:e.jsx(Ge,{})})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 mt-5 mb-5 lg:grid-cols-4",children:[!B&&(t!=null&&t.filter_data)?((j=A==null?void 0:A.flight)==null?void 0:j.search_filter)==="3"?e.jsx(it,{filterData:t.filter_data,additionalData:{date:(F=(d=t.data[0])==null?void 0:d.search_parameter)==null?void 0:F.departure_date[0],departure_from:(O=(z=t.data[0])==null?void 0:z.search_parameter)==null?void 0:O.departure_airport[0],arrival_to:(ge=(xe=(oe=t.data[0])==null?void 0:oe.search_parameter)==null?void 0:xe.arrival_airport)==null?void 0:ge.at(-1),total_fight:(n==null?void 0:n.length)||0,journey_type:(K=(y=t.data[0])==null?void 0:y.search_parameter)==null?void 0:K.journey_type,tracking_id:k,supplier_uid:(h=(I=t.data[0])==null?void 0:I.search_parameter)==null?void 0:h.supplier_uid}}):((Ce=A==null?void 0:A.flight)==null?void 0:Ce.search_filter)==="2"?e.jsx(Dt,{filterData:t.filter_data,additionalData:{date:($e=(Fe=t.data[0])==null?void 0:Fe.search_parameter)==null?void 0:$e.departure_date[0],departure_from:(Ae=(Oe=t.data[0])==null?void 0:Oe.search_parameter)==null?void 0:Ae.departure_airport[0],arrival_to:(Te=(Be=(Ee=t.data[0])==null?void 0:Ee.search_parameter)==null?void 0:Be.arrival_airport)==null?void 0:Te.at(-1),total_fight:(n==null?void 0:n.length)||0,journey_type:(Xe=(We=t.data[0])==null?void 0:We.search_parameter)==null?void 0:Xe.journey_type,tracking_id:k}}):e.jsx(Vt,{filterData:t.filter_data,additionalData:{date:(Ke=(Je=t.data[0])==null?void 0:Je.search_parameter)==null?void 0:Ke.departure_date[0],departure_from:(ea=(Ze=t.data[0])==null?void 0:Ze.search_parameter)==null?void 0:ea.departure_airport[0],arrival_to:(ra=(ta=(aa=t.data[0])==null?void 0:aa.search_parameter)==null?void 0:ta.arrival_airport)==null?void 0:ra.at(-1),total_fight:(n==null?void 0:n.length)||0,journey_type:(na=(sa=t.data[0])==null?void 0:sa.search_parameter)==null?void 0:na.journey_type,tracking_id:k}}):e.jsx(nt,{}),e.jsxs("section",{className:"lg:col-span-3",children:[!B&&(t!=null&&t.filter_data)?e.jsx(ur,{filterData:t.filter_data,currency:t==null?void 0:t.currency,search_parameter:(ia=t==null?void 0:t.data[0])==null?void 0:ia.search_parameter}):e.jsx("div",{className:"h-20 mb-5 skeleton-box"}),U?e.jsx(Jt,{}):e.jsx(Ut,{})]})]}),e.jsx("div",{className:ae("fixed bottom-0 left-0 right-0 bg-base-200 shadow-[0_-10px_15px_-3px_rgb(0_0_0_/_0.1),_0_-4px_6px_-4px_rgb(0_0_0_/_0.1)] duration-200 transition-all",be?"translate-y-0":"translate-y-full"),children:e.jsxs("div",{className:"container flex items-center justify-end gap-4 py-4",children:[e.jsxs("button",{onClick:()=>{dt("multiple_flight_share",n==null?void 0:n.at(0)),De.update(r=>{r.isActive=!1})},className:"h-10 min-h-0 font-normal text-white normal-case rounded-md btn btn-warning",children:[e.jsx(Mt,{})," Share"]}),e.jsxs("button",{onClick:()=>De.update(r=>{r.isActive=!1}),className:"h-10 min-h-0 font-normal normal-case rounded-md hover:!text-white btn btn-warning btn-outline",children:[e.jsx(pt,{})," Cancel"]})]})}),e.jsx(mr,{})]})};export{Ir as default};
