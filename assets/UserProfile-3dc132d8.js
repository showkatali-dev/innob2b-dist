import{e as r,m as _,l as H,u as L,o as e,a5 as z,a6 as G,Q as K,aF as W,U as E}from"./index-f242fedc.js";import{I as J}from"./InputDate-d24e7bd2.js";import{C as T}from"./CountryWithCodeSelect-b68c8ddb.js";import{a as X,w as Z,x as $,aK as ee,aL as ae,aM as se}from"./App-89f3291c.js";import{P as te}from"./PhoneNumberSelect-8527307e.js";import"./shortcut-buttons-flatpickr.min-25284ad6.js";import"./SingleSelect-9930e593.js";const me=()=>{const[d,p]=r.useState({isd_code:"",mobile:""}),{site_title:b}=_.useState(),F=_.useState(a=>{var l,n;return(n=(l=a.component_version)==null?void 0:l.general)==null?void 0:n.dashboard}),[s,S]=r.useState(!1),{user_data:{login_key:i,member_id:c}}=H.useState(),[x,f]=r.useState(!1),{axiosInstance:h}=X(),k=L(),{data:t,isLoading:w,error:j}=Z(["USER_INFO",i,c],async()=>{var l,n;const a=await h.post("/user/profile",{login_key:i,member_id:c});if(((l=a.data)==null?void 0:l.status)==="success"){const{isd_code:m,mobile:u}=a.data.data;return p({isd_code:m,mobile:u}),a.data.data}else throw{...a,message:((n=a.data)==null?void 0:n.reason)||"Request failed!"}}),[P,N]=r.useState("");if(r.useEffect(()=>{t!=null&&t.country&&N(t==null?void 0:t.country)},[t==null?void 0:t.country]),w)return e.jsx(z,{});if(j)throw j;const{fullname:U,email:y,dob:M,gender:g,address:I,city:V,state:R,postal_code:A}=t,Q=async a=>{var v,C;if(a.preventDefault(),!s){S(!0);return}if(x)return;f(!0);const l=a.target,{fullname:n,dob:m,gender:u,address:Y,city:q,state:D,postal_code:O,country:B}=l;try{const o=await h.post("/user/profile-update",{login_key:i,member_id:c,fullname:n.value,email:y,dob:K(new Date(m.value)).format("YYYY-MM-DD"),gender:u.value,address:Y.value,city:q.value,state:D.value,postal_code:O.value,country:W(B.value),...d});if(((v=o.data)==null?void 0:v.status)==="success")E("success","Success!","Profile was successfully updated"),k.invalidateQueries(["USER_INFO"]);else throw new Error((C=o.data)==null?void 0:C.reason)}catch(o){E("error","Failed!",o.message)}finally{f(!1)}};return e.jsxs("form",{onSubmit:Q,className:$("grid grid-cols-1 gap-4 p-4 mb-8 rounded-md shadow lg:grid-cols-2 bg-base-200",F==="3"&&"shadow-none"),children:[e.jsx(G,{children:e.jsxs("title",{children:["User Profile",b?" - "+b:""]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"Email address"})}),e.jsx("input",{autoComplete:"off",type:"email",name:"email",placeholder:"Enter email address",className:"h-10 text-sm bg-transparent rounded input input-bordered focus:outline-0 min-h-8",readOnly:!0,value:y})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"Full name"})}),e.jsx("input",{autoComplete:"off",type:"text",name:"fullname",placeholder:"Enter you full name",className:"h-10 text-sm bg-transparent rounded input input-bordered focus:outline-0 min-h-8",required:!0,defaultValue:U,disabled:!s})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"Mobile"})}),e.jsx(te,{placeholder:"Enter Mobile Number",className:"!h-10 !text-sm !bg-transparent !rounded input !input-bordered focus:outline-0 min-h-8 !w-full",defaultValue:String(d.isd_code||"")+String(d.mobile||""),action:a=>p(a),disabled:!s})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"Date of Birth"})}),e.jsx(J,{name:"dob",placeholder:"Select your date of birth",className:"h-10 text-sm bg-transparent rounded input input-bordered focus:outline-0 min-h-8",action:()=>{},defaultValue:M,disabled:!s})]}),e.jsxs("div",{className:"form-control",name:"gender",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"Gender"})}),e.jsxs("label",{htmlFor:"male",className:"flex items-center mb-2 space-x-2 text-sm",children:[e.jsx("input",{autoComplete:"off",type:"radio",id:"male",name:"gender",className:"radio radio-sm radio-primary",value:"Male",defaultChecked:g==="Male",disabled:!s}),e.jsx("span",{children:"Male"})]}),e.jsxs("label",{htmlFor:"female",className:"flex items-center space-x-2 text-sm",children:[e.jsx("input",{autoComplete:"off",type:"radio",id:"female",name:"gender",className:"radio radio-sm radio-primary",value:"Female",defaultChecked:g==="Female",disabled:!s}),e.jsx("span",{children:"Female"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"Address"})}),e.jsx("input",{autoComplete:"off",type:"text",name:"address",placeholder:"Enter Address",className:"h-10 text-sm bg-transparent rounded input input-bordered focus:outline-0 min-h-8",defaultValue:I,disabled:!s})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"City"})}),e.jsx("input",{autoComplete:"off",type:"text",name:"city",placeholder:"Enter city name",className:"h-10 text-sm bg-transparent rounded input input-bordered focus:outline-0 min-h-8",defaultValue:V,disabled:!s})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"State"})}),e.jsx("input",{autoComplete:"off",type:"text",name:"state",placeholder:"Enter state name",className:"h-10 text-sm bg-transparent rounded input input-bordered focus:outline-0 min-h-8",defaultValue:R,disabled:!s})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"Country"})}),e.jsx(T,{placeholder:"Enter country name",name:"country",className:"!h-10 text-sm bg-transparent !rounded input input-bordered border-base-content/20 focus:!outline-0 !min-h-8",action:a=>{var l;return N((l=a==null?void 0:a.at(0))==null?void 0:l.value)},defaultValue:P,disabled:!s})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"Postal Code"})}),e.jsx("input",{autoComplete:"off",type:"text",name:"postal_code",placeholder:"Enter zip or postal code",className:"h-10 text-sm bg-transparent rounded input input-bordered focus:outline-0 min-h-8",defaultValue:A,disabled:!s})]})]}),e.jsx("button",{type:"submit",className:"w-full mt-4 normal-case rounded btn btn-sm btn-primary btn-outline",children:x?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"mr-2 animate-spin"})," Updating..."]}):s?e.jsxs(e.Fragment,{children:[e.jsx(ae,{})," Update Profile"]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{})," Edit Profile"]})})]})};export{me as default};
