import{o as w,u as W,e as G,q as e,m as v,Q as O,T as R,a4 as B,a5 as M}from"./index-d20e4767.js";import{P as Q,dP as U,d as z,o as K,L as h,ek as Y,el as D,em as H,en as J,ej as V,eo as X,ep as Z,dW as y,dX as $,dY as ee,W as se,n as te,dc as ae,eq as re}from"./App-e22994df.js";import{L as oe}from"./LoginOtp-df8330cb.js";const N=({redirectTo:n=null})=>{var g;const{component_version:t}=w.useState(),{status:l,firebaseAuth:i,auth_options:s}=U(),{axiosInstance:d}=z(),a=K(),o=W(),[c,u]=G.useState(!1),p=async r=>{var b,f;try{const{user:{uid:m,email:P,emailVerified:S,phoneNumber:F,displayName:I,isAnonymous:A,providerData:{0:{uid:E}}},providerId:_}=r,x=await d.post("/user/sso-login",{uid:m,providerId:_,providerUid:E,email:P,emailVerified:S,phoneNumber:F,displayName:I,isAnonymous:A},{headers:{"is-open":"yes"}});if(((b=x.data)==null?void 0:b.status)==="success"){const{login_key:C,member_id:q,token:j}=x.data;localStorage.setItem("user_info",JSON.stringify({login_key:C,member_id:q,token:j})),v.update(T=>{T.token=j}),o.invalidateQueries({queryKey:["USER_INFO"]}),O(),n&&a(n)}else throw new Error((f=x.data)==null?void 0:f.reason)}catch(m){R("error","Failed!",m.message)}},k=()=>{y(i,$).then(async r=>{await p(r)})},L=()=>{y(i,ee).then(async r=>{await p(r)})};return e.jsxs("div",{children:[e.jsx("p",{className:"mb-8 text-sm text-center text-neutral/80",children:"Please login to continue"}),((g=t==null?void 0:t.general)==null?void 0:g.dashboard)==="3"&&e.jsx("div",{className:"relative p-3 mb-3 border rounded border-warning/50 bg-warning/10 text-warning",children:e.jsxs("p",{className:"text-xs",children:["If you are having trouble logging in with your old password, please"," ",e.jsx(h,{to:"/forgot-password",className:"text-secondary",children:"RESET"})," ","your password."]})}),e.jsx(Y,{redirectTo:n,children:e.jsxs("div",{className:"flex flex-col w-full gap-y-4",children:[e.jsxs("label",{className:"gap-2 form-control",children:[e.jsx("span",{className:"text-[13px] text-neutral",children:"Email"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("input",{autoComplete:"off",type:"email",name:"email",className:"flex-1 h-10 pr-10 text-sm border rounded-full input input-bordered border-base-content/10 bg-base-200 focus:outline-0 min-h-8 focus:border-primary",placeholder:"Enter Email"}),e.jsx("span",{className:"absolute flex items-center justify-center w-8 h-8 text-lg rounded-full right-1.5 bg-base-100 text-neutral",children:e.jsx(D,{})})]})]}),e.jsxs("label",{className:"gap-2 form-control",children:[e.jsx("span",{className:"text-[13px] text-neutral",children:"Password"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("input",{autoComplete:"off",type:c?"text":"password",name:"password","data-type":"password",className:"flex-1 h-10 pr-10 text-sm border rounded-full input input-bordered border-base-content/10 bg-base-200 focus:outline-0 min-h-8 focus:border-primary",placeholder:"Password"}),e.jsx("span",{className:"absolute flex items-center justify-center w-8 h-8 text-lg rounded-full right-1.5 bg-base-100 text-neutral",children:e.jsx(H,{})})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer text-neutral",children:[e.jsx("input",{type:"checkbox",className:"toggle toggle-xs border-neutral bg-neutral",checked:c,onChange:r=>u(r.target.checked)}),e.jsx("span",{children:"Show Password"})]}),e.jsxs(h,{to:"/forgot-password",className:"text-sm text-neutral",children:[e.jsx(J,{})," Forgot password?"]})]}),e.jsxs("button",{type:"submit",className:"h-10 min-h-0 font-normal normal-case transition-all duration-300 rounded-full shadow-lg btn btn-primary shadow-primary/50 hover:shadow-none",children:["Log In ",e.jsx(V,{})]}),l==="active"&&e.jsxs(e.Fragment,{children:[(s==null?void 0:s.includes("google"))&&e.jsxs("button",{type:"button",onClick:k,className:"relative h-10 min-h-0 font-normal normal-case transition-all duration-300 rounded-full shadow-lg btn btn-primary shadow-primary/50 hover:shadow-none",children:[e.jsx(X,{className:"absolute text-lg -translate-y-1/2 left-3 top-1/2"})," ","Login with Google"]}),(s==null?void 0:s.includes("facebook"))&&e.jsxs("button",{type:"button",onClick:L,className:"relative h-10 min-h-0 font-normal normal-case transition-all duration-300 rounded-full shadow-lg btn btn-primary shadow-primary/50 hover:shadow-none",children:[e.jsx(Z,{className:"absolute text-lg -translate-y-1/2 left-3 top-1/2"})," ","Login with Facebook"]})]})]})})]})};N.propTypes={redirectTo:Q.string};const ce=()=>{const{isLoading:n,user_data:t}=v.useState(),{site_title:l,intro_video:i,intro_banner:s,logo:d}=w.useState(),{state:a}=se(),o=!(a!=null&&a.pathname)||a.pathname==="/"?"/":a.pathname,[c]=te(),u=c.get("otp_required");return n?e.jsx(B,{}):t!=null&&t.login_key?e.jsx(ae,{to:o}):e.jsxs("div",{style:{backgroundImage:"linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))",backgroundSize:"cover",backgroundBlendMode:"multiply"},children:[e.jsx(M,{children:e.jsxs("title",{children:["Login",l?" - "+l:""]})}),i&&e.jsx("video",{id:"background-video",src:i,poster:s,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,children:"Your browser does not support the video tag."}),e.jsx("main",{className:"flex items-center justify-center min-h-screen gap-4 px-5 py-16",children:e.jsxs("div",{className:"w-full max-w-lg",children:[e.jsxs("div",{className:"relative w-full p-8 mb-4 shadow-lg rounded-2xl bg-base-200",children:[e.jsx("div",{className:"absolute top-0 z-10 flex items-center justify-center p-1 mb-2 overflow-hidden -translate-x-1/2 -translate-y-1/2 border rounded-lg h-14 border-neutral/10 left-1/2 bg-base-200",children:e.jsx("img",{src:d,alt:"logo",className:"object-cover object-center w-full h-full"})}),e.jsx("div",{className:"flex flex-col items-center pt-4 mt-2 mb-3",children:e.jsxs("h1",{className:"text-xl font-semibold",children:["Let's Get Started ",l]})}),u==="yes"?e.jsx(oe,{redirectTo:o}):e.jsx(N,{redirectTo:o})]}),e.jsxs("div",{children:[e.jsx(re,{from:o}),e.jsx("div",{className:"flex items-center justify-center gap-2 mt-5 mb-3",children:e.jsx("span",{className:"text-white",children:"Or"})}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"my-animated-button",children:e.jsx(h,{to:"/register",children:"Apply for an Agent Account"})})})]})]})})]})};export{ce as default};
