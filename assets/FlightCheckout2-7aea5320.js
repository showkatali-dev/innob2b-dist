import{m as H,an as I,l as J,e as b,o as e,ao as G,ap as N,I as Z,y as Ce,aq as ke,ar as we,as as Fe,ac as Ie,at as ae,u as Te,U as se,a1 as ie,G as z,a5 as Ee,a6 as Me}from"./index-179efefa.js";import{P as E,K as De,O as qe,Q as Pe,S as Ae,a2 as Be,x as me,b as ue,a3 as Re,U as oe,V as Oe,W as Ve,X as Le,Y as Ue,Z as pe,a as he,w as xe,_ as ee,$ as le,a0 as ce,a1 as He,c as Ye}from"./App-5691a897.js";import{a as Qe,b as ze,S as Ge,F as We,Q as $e,c as Je}from"./index-7569d28f.js";import{A as Ke,a as de}from"./AccordionItem-2119f5d8.js";import{T as $}from"./TextInputCheckout-1f91a134.js";import{I as ne}from"./InputContainerCheckout-40e513e8.js";import{P as be}from"./PhoneNumberSelect-ac7bb8c7.js";import{D as te}from"./DateInputCheckout-d3911af4.js";import{D as Xe}from"./DropDownSelectCheckout-38f7c507.js";import{C as Ze}from"./CountryWithCodeSelect-846a549c.js";import{S as et,E as tt,A as at,a as st,b as nt,P as rt,c as it,F as ot,d as lt}from"./FlightCancellationPolicyModal-dd4b438b.js";import{P as ct}from"./PrimaryTabsWithIcon-67c1c525.js";import{F as dt}from"./FlightItineraryData-023b5d41.js";import{w as mt}from"./sweetalert2-react-content.es-bda22d70.js";import"./InputDate-9187c7fb.js";import"./shortcut-buttons-flatpickr.min-b052b26a.js";import"./SingleSelect-2525a2fe.js";import"./pp-a9ad117b.js";const ut=()=>{const{checkout_form_email_modify:a,checkout_form_contact_modify:i}=H.useState().booking_manage||{},{isd_code:l,contact_no:g,email_address:o}=I.useState(),{user_data:{member_id:t,mobile:m,email:d,isd_code:u}}=J.useState(r=>r);return b.useEffect(()=>{const r=location.origin;I.update(c=>{c.member_id=t,c.contact_no=m,c.email_address=d,c.isd_code=u,c.redirect_url=`${r}/booking-details/flight`})},[t,m,d,u]),e.jsxs("div",{className:"grid grid-cols-1 gap-3 p-3 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsx(ne,{label:"Mobile Number",isRequired:!0,defaultValue:String(l||"")+String(g||""),action:r=>I.update(c=>{c.isd_code=r.isd_code||"",c.contact_no=r.mobile||""}),placeholder:"Enter Mobile Number",Input:be,readOnly:(i==null?void 0:i.toUpperCase())==="DISABLE"&&!!l,autoFormat:!1}),e.jsx($,{type:"email",label:"E-mail",action:r=>I.update(c=>{c.email_address=r.target.value}),defaultValue:o,placeholder:"example@mail.com",readOnly:(a==null?void 0:a.toUpperCase())==="DISABLE"&&!!o})]})},ge=({pax_id:a,pax_type:i,pax_options:l,isDocOptional:g})=>{var A,B,R,_,C,O,V,L,U,D,Y,k,h;const{location_info:{isd_code:o}}=H.useState(),{doc_required:t,frequent_flyer_selection:m,wheelchair_selection:d,pax_dob_required:u,seat_selection:r,meal_selection:c,baggage_selection:x,passport_scan_selection:T,pax_search_selection:y,pax_email_contact_selection:q}=l||{},[P,M]=b.useState(!1),[f,p]=b.useState(!1),{passenger:n}=G.useState(s=>s),[v,j]=b.useState(!1),S=["MRS","MISS","MS"];return b.useEffect(()=>{N(a,{gender:"",wheelchair_required:"no",pax_id:a,first_name:"",last_name:"",dob:"",doc_no:"",doc_dateofexpiry:"",doc_dateofissue:"",frequent_flyer:"",contact_no:"",email_address:""})},[a]),b.useEffect(()=>{N(a,{title:i==="ADT"?"MR":"MSTR",pax_type:i,isd_code:o||""})},[a,i,o]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative p-3 pb-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-4",children:[e.jsxs("h6",{className:"font-medium",children:[i==="ADT"?e.jsx(De,{className:"mr-0.5"}):i==="CNN"?e.jsx(qe,{className:"mr-0.5"}):e.jsx(Pe,{className:"mr-0.5"})," ",i==="ADT"?"Adult":i==="CNN"?"Child":"Infant"," ","Traveler ",a]}),e.jsxs("div",{className:"flex gap-3 sm:col-span-2 max-lg:-order-1 lg:justify-end",children:[x==="active"&&e.jsx("button",{type:"button",onClick:()=>document.getElementById("baggage_modal").showModal(),className:"normal-case rounded shadow btn btn-square btn-sm btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Additional Baggage",children:e.jsx(Z,{path:Ce,size:1.1})}),r==="active"&&e.jsx("button",{type:"button",onClick:()=>document.getElementById("seat_modal").showModal(),className:"normal-case rounded shadow btn btn-square btn-sm btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Select Seat",children:e.jsx(Z,{path:ke,size:.8})}),c==="active"&&e.jsx("button",{type:"button",onClick:()=>document.getElementById("meal_modal").showModal(),className:"normal-case rounded shadow btn btn-square btn-sm btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Select Meal",children:e.jsx(Ae,{className:"w-6 h-6"})}),T==="active"&&e.jsx("button",{type:"button",onClick:()=>M(!0),className:"normal-case rounded shadow btn btn-square btn-sm btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Scan Passport",children:e.jsx(Z,{path:we,size:.8})}),y==="active"&&e.jsx("button",{type:"button",onClick:()=>p(!0),className:"normal-case rounded shadow btn btn-sm btn-ghost bg-primary/5 text-primary hover:bg-primary/20 btn-square tooltip tooltip-left tooltip-primary","data-tip":"Existing Passenger",children:e.jsx(Z,{path:Fe,size:.8})})]})]}),e.jsxs("div",{className:"grid grid-flow-col gap-1 pr-8 mb-3",children:[e.jsx($,{label:"Surname",isRequired:!0,action:s=>N(a,{last_name:s.target.value}),isUpperCase:!0,defaultValue:((A=n[a])==null?void 0:A.last_name)||"",placeholder:"Doe",maxLength:30}),e.jsx($,{label:"Name",isRequired:!0,action:s=>N(a,{first_name:s.target.value}),isUpperCase:!0,defaultValue:((B=n[a])==null?void 0:B.first_name)||"",placeholder:"John",maxLength:30}),u!=="no"&&e.jsx("div",{className:"max-w-[90px]",children:e.jsx(te,{label:"DOB",isRequired:u!=="optional",action:s=>N(a,{dob:s}),placeholder:"DOB",defaultValue:(R=n[a])==null?void 0:R.dob})}),e.jsx("div",{className:"max-w-[150px]",children:e.jsx(ne,{label:"Mobile",isRequired:!1,defaultValue:String(((_=n[a])==null?void 0:_.isd_code)||"")+String(((C=n[a])==null?void 0:C.contact_no)||""),action:s=>N(a,{isd_code:(s==null?void 0:s.isd_code)||"",contact_no:(s==null?void 0:s.mobile)||""}),action2:a===1?s=>{var K,X;const w=(K=Object.keys(n))==null?void 0:K.length;if(!(w<2))for(let Q=2;Q<=w;Q++)(X=n==null?void 0:n[Q])!=null&&X.contact_no||N(Q,{isd_code:(s==null?void 0:s.isd_code)||"",contact_no:(s==null?void 0:s.mobile)||""})}:null,placeholder:"Enter Mobile Number",Input:be,autoFormat:!1})}),e.jsxs("div",{className:"sb-input-container",children:[e.jsx("div",{className:"sb-label",children:"Gender"}),e.jsxs("select",{className:"sb-input min-w-12",value:((O=n[a])==null?void 0:O.gender)||"",onChange:s=>{N(a,{gender:s.target.value,title:s.target.value==="F"?S.includes(n[a].title)===!1?n[a].pax_type==="ADT"?"MRS":"MISS":n[a].title:n[a].pax_type==="ADT"?"MR":"MSTR"})},children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"M",children:"M"}),e.jsx("option",{value:"F",children:"F"})]})]})]}),e.jsx("div",{className:"overflow-visible collapse",open:v,children:e.jsx("div",{className:"p-0 collapse-content",children:e.jsxs("div",{className:"grid gap-1 pr-10 sm:grid-cols-2 lg:grid-cols-6",children:[t!=="no"&&!g&&e.jsxs(e.Fragment,{children:[e.jsx(ne,{label:"Country",isRequired:t!=="optional",action:s=>{var w;return N(a,{doc_country:((w=s[0])==null?void 0:w.value)||""})},defaultValue:(V=n[a])==null?void 0:V.doc_country,placeholder:"Country",Input:Ze}),e.jsx($,{label:"Document No.",isRequired:t!=="optional",action:s=>N(a,{doc_no:s.target.value}),isUpperCase:!0,defaultValue:((L=n[a])==null?void 0:L.doc_no)||"",placeholder:"A0123456789"}),e.jsx(te,{label:"Expiration Date",isRequired:t!=="optional",action:s=>N(a,{doc_dateofexpiry:s}),placeholder:"Expiration Date",defaultValue:(U=n[a])==null?void 0:U.doc_dateofexpiry}),e.jsx(te,{label:"Issue Date",action:s=>N(a,{doc_dateofissue:s}),defaultValue:(D=n[a])==null?void 0:D.doc_dateofissue,placeholder:"Issue Date"})]}),(m==="active"||m==="optional")&&e.jsx($,{label:"Frequent Flyer Number",isRequired:m==="active",action:s=>N(a,{frequent_flyer:s.target.value}),isUpperCase:!0,defaultValue:((Y=n[a])==null?void 0:Y.frequent_flyer)||"",placeholder:"Type frequent flyer number"}),(d==="active"||d==="optional")&&e.jsx(Xe,{label:"Wheelchair Required",isRequired:d==="active",options:[{label:"Yes",value:"yes"},{label:"No",value:"no"}],action:s=>{var w;return N(a,{wheelchair_required:((w=s[0])==null?void 0:w.value)||""})},defaultValue:(k=n[a])==null?void 0:k.wheelchair_required,placeholder:"Select"}),q!=="disable"&&e.jsx($,{type:"email",label:"E-mail",action:s=>N(a,{email_address:s.target.value}),placeholder:"example@mail.com",defaultValue:((h=n[a])==null?void 0:h.email_address)||""})]})})}),e.jsx("button",{onClick:()=>j(!v),className:"absolute border-2 rounded-md bottom-5 btn btn-square btn-secondary btn-xs h-7 w-7 right-2",children:e.jsx(Be,{className:me("duration-300 transition-all",v?"rotate-180":"rotate-0")})})]}),e.jsx(et,{isOpenScanPassportModal:P,setIsOpenScanPassportModal:M,pax_id:a}),e.jsx(tt,{isOpenExistingPassengerModal:f,setIsOpenExistingPassengerModal:p,pax_id:a})]})};ge.propTypes={pax_id:E.number,pax_type:E.string,pax_options:E.object};const pt=()=>{const{save_pax:a}=G.useState();return e.jsx("div",{className:"flex justify-end px-3 py-4",children:e.jsxs("label",{htmlFor:"save_pax",className:"flex items-center align-middle",children:[e.jsx("input",{autoComplete:"off",type:"checkbox",id:"save_pax",defaultChecked:a==="yes",onChange:i=>G.update(l=>{l.save_pax=i.target.checked?"yes":"no"}),className:"rounded-sm checkbox checkbox-xs checkbox-primary"}),e.jsx("span",{className:"text-sm select-none",children:"Save Passenger Information"})]})})},fe=({flight_data:a})=>{var p;const{component_version:i}=H.useState(),{search_parameter:{travelers_adult:l,travelers_adult_age:g,travelers_child:o,travelers_child_age:t,travelers_infants:m,travelers_infants_age:d},pax_options:u,supplier:r,flight_group:c}=a||{},x=r==null?void 0:r.currency,T=c==null?void 0:c.every(n=>{var v;return(v=n==null?void 0:n.routes)==null?void 0:v.every(j=>{var S,A;return((S=j==null?void 0:j.origin_airport)==null?void 0:S.country)==="Bangladesh"&&((A=j==null?void 0:j.destination_airport)==null?void 0:A.country)==="Bangladesh"})}),{seat_selection:y,meal_selection:q,baggage_selection:P,pax_save_option:M}=u||{},f=l+o+m;return e.jsxs(e.Fragment,{children:[e.jsxs(Ke,{className:`w-full mb-8 bg-base-200 ${((p=i==null?void 0:i.flight)==null?void 0:p.checkout)==="2"?"flight-checkout-v2":""}`,children:[e.jsxs(de,{isOpen:!0,header:"Enter Traveler Details",className:"border-0",disabled:!0,children:[Array(f).fill("").map((n,v)=>{const j=v+1,S=j<=l?"ADT":j-l<=o?"CNN":"INF";return e.jsx(ge,{pax_id:j,pax_type:S,pax_options:u,isDocOptional:(x==null?void 0:x.toLowerCase())==="bdt"&&T,age:S==="ADT"?(g==null?void 0:g.at(v))||30:S==="CNN"?(t==null?void 0:t.at(v-l))||10:(d==null?void 0:d.at(v-l-o))||2},Ie())}),M==="active"&&e.jsx(pt,{})]}),e.jsx(de,{isOpen:!0,header:"Enter Contact Details",className:"border-0",disabled:!0,children:e.jsx(ut,{})})]}),P==="active"&&e.jsx(at,{}),y==="active"&&e.jsx(st,{}),q==="active"&&e.jsx(nt,{})]})};fe.propTypes={flight_data:E.object.isRequired};const ht=[{id:1,name:"Flight Itinerary",value:"flight_itinerary",icon:e.jsx(Ue,{})},{id:2,name:"Fare Summary",value:"fare_summary",icon:e.jsx(pe,{})}],xt=[{id:2,name:"Fare Summary",value:"fare_summary",icon:e.jsx(pe,{})}],je=({flight_data:a})=>{const{user_data:{user_access_level:i}={}}=J.useState(),{system_config:l,supplier_option:g}=H.useState(),{search_result_version:o}=l||{},t=["1","4","5","7"].includes(o)?ht:xt,{show_supplier_option:m}=g||{},[d,u]=b.useState(t[0].value),{flight_group:r,price_breakdown:c}=a||{},[x,T]=b.useState(!1),y=b.useRef(),q=()=>{y.current.style.maxHeight=0,T(!1)},P=()=>{y.current.style.maxHeight=y.current.scrollHeight+"px",T(!0)},M=()=>{x?q():P()},f=ue();return e.jsxs("div",{className:"relative mb-8 rounded-lg bg-base-200",children:[e.jsxs("button",{onClick:()=>f(-1),className:"flex items-center gap-2 px-3 py-3 text-neutral",children:[e.jsx(Re,{}),e.jsx("span",{children:"Back to Result"})]}),e.jsxs("div",{className:me("px-3 pt-3 pb-4",o==="5"&&"pl-0"),children:[e.jsxs("div",{className:"flex flex-col gap-5 justify-evenly sm:flex-row sm:items-center",children:[o==="5"?e.jsx("div",{className:"w-full space-y-2",children:r.map((p,n)=>e.jsx("div",{children:e.jsx(Qe,{singleFlightData:p})},n))}):o==="7"?e.jsx("div",{className:"w-full space-y-2",children:r.map((p,n)=>e.jsx("div",{children:e.jsx(ze,{singleFlightData:p})},n))}):e.jsx("div",{className:"w-full",children:r.map((p,n)=>e.jsxs("div",{children:[n>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(Ge,{singleFlightData:p})]},n))}),e.jsx("div",{className:"flex items-center flex-shrink-0 gap-3 justify-evenly",children:e.jsx("div",{className:"flex gap-2 text-center",children:e.jsx("button",{onClick:M,className:"absolute bottom-0 z-10 min-h-0 font-normal normal-case -translate-x-1/2 translate-y-1/2 rounded shadow btn btn-primary left-1/2 h-9 active:!-translate-x-1/2 active:!translate-y-1/2 no-animation",children:x?e.jsxs(e.Fragment,{children:["Hide Details ",e.jsx(oe,{})]}):e.jsxs(e.Fragment,{children:["View Details ",e.jsx(Oe,{})]})})})})]}),e.jsx("div",{className:"flex items-center justify-end mt-4",children:(l==null?void 0:l.show_cart_quotes)==="YES"&&e.jsxs("button",{onClick:()=>ae("quotes",a),className:"addToCartBtn normal-case font-normal btn btn-primary btn-outline border-[#ccc] btn-xs",children:["Quotes",e.jsx(Ve,{})]})}),e.jsx("div",{ref:y,className:"overflow-hidden duration-500 details",style:{maxHeight:0},children:e.jsxs("div",{className:"px-3 py-3 content",children:[e.jsx("hr",{className:"my-4 border"}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between mb-5",children:[e.jsx(ct,{items:["supernsn","administrator"].includes(i)&&m==="YES"?[...t,{id:3,name:"Debug",value:"debug",icon:e.jsx(Le,{})}]:t,activeTab:d,action:p=>{u(p),setTimeout(()=>{y.current.style.maxHeight=y.current.scrollHeight+"px"},100)}}),e.jsxs("button",{onClick:q,className:"ml-auto text-xs normal-case hideDetailsBtn btn btn-sm rounded-3xl",children:["Hide Details",e.jsx(oe,{})]})]}),d==="flight_itinerary"&&["1","4","5","7"].includes(o)&&e.jsx(dt,{flight_group:r}),d==="fare_summary"&&e.jsx(We,{price_breakdown:c}),d==="debug"&&m==="YES"&&e.jsx("div",{className:"p-3 border rounded-lg",children:e.jsx("pre",{children:JSON.stringify(a,null,3)})})]})})]})]})};je.propTypes={flight_data:E.object.isRequired};const ye=({validation_data:a})=>{const{data:i}=a;return e.jsxs("div",{className:"relative lg:col-span-5",children:[e.jsx(je,{flight_data:i}),e.jsx(fe,{flight_data:i}),e.jsx($e,{})]})};ye.propTypes={validation_data:E.object.isRequired};const ve=({isExpired:a,isChecked:i,hold_possible:l})=>{var R;const g=I.useState(_=>_),{axiosInstance:o}=he(),[t,m]=b.useState(!1),{payment_type:d}=I.useState(),{booking_tracking_id:u,save_pax:r,passenger:c}=G.useState(_=>_),{user_data:{login_key:x,member_id:T,user_access_level:y}={}}=J.useState(),{checkout_url:q}=((R=H.useState())==null?void 0:R.system_config)||{},{data:P,isLoading:M,isError:f}=xe({queryKey:["SERVICE_STATUS",x,T],queryFn:async()=>{var _;try{const C=await o.post("/reports/service-status",{login_key:x,member_id:T});return((_=C==null?void 0:C.data)==null?void 0:_.service_status)||null}catch(C){console.error(C)}}}),p=ue(),n=mt(le),v=Te(),j=async()=>{var _,C,O,V,L,U;if(!t)try{if(m(!0),i.terms_conditions===!1)throw new Error("Please accept Terms & Conditions");if(i.cancellation_policy===!1)throw new Error("Please accept Cancellation Policy");const D=await o.post("/user/profile",JSON.parse(localStorage.getItem("user_info")));if(!D.data||((_=D.data)==null?void 0:_.status)!=="success"){localStorage.removeItem("user_info"),J.update(h=>{h.token=null,h.user_data=null}),v.invalidateQueries(["SITE_CONFIG"]);return}const Y={booking_tracking_id:u,member_id:T,save_pax:r,passenger:Object.values(c)},k=await o.post("/flight/update-travellers",Y);if(((C=k==null?void 0:k.data)==null?void 0:C.status)==="success")try{const h=await o.post("/flight/create-booking",g);if(((O=h==null?void 0:h.data)==null?void 0:O.status)==="success")if((L=(V=h==null?void 0:h.data)==null?void 0:V.general)!=null&&L.tracking_id)p(`/booking-details/flight?tracking_id=${h.data.general.tracking_id}`,{replace:!0}),se("success","Booking Successful",k.data.reason),G.replace(G._getInitialState()),I.replace(I._getInitialState()),ie.replace(ie._getInitialState());else{const{payment_option:s,pay_tracking_id:w}=h.data;n.fire({html:e.jsx(rt,{payment_options:s,pay_tracking_id:w,checkout_url:q}),showCancelButton:!1,showConfirmButton:!1,allowOutsideClick:!1,customClass:{htmlContainer:"!m-0",popup:"w-full max-w-3xl !p-0 overflow-hidden"}})}else throw y==="supernsn"?new Error(h.data.reason+`
`+((U=h.data)==null?void 0:U.reason_admin)):new Error(h.data.reason)}catch(h){(await le.fire({title:"Booking Failed",html:h.message,icon:"error",showCancelButton:!1,showCloseButton:!1,confirmButtonColor:"hsl(var(--p)/1)",confirmButtonText:"Go Back",allowOutsideClick:!1})).isConfirmed&&p(-1,{replace:!0})}else throw new Error(k==null?void 0:k.data.reason)}catch(D){console.error(D),se("error","Failed",D.message)}finally{m(!1)}};if(M||f)return e.jsxs("button",{className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",children:[e.jsx(ee,{className:"mr-2 animate-spin"})," Loading..."]});const{block_status:S,flight_block:A,reason:B}=P;return S==="yes"&&A==="yes"?e.jsx("div",{className:"p-3 text-sm border rounded-lg border-error bg-error/10",children:e.jsx("p",{className:"text-error inner-html",dangerouslySetInnerHTML:{__html:B}})}):d?e.jsx(e.Fragment,{children:d==="account_balance"?e.jsx("button",{onClick:j,className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",disabled:a,children:t?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"mr-2 animate-spin"})," Loading..."]}):l==="yes"?"Hold Flight":"Instant Purchase"}):e.jsx("button",{onClick:j,disabled:a,className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",children:t?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"mr-2 animate-spin"})," Loading..."]}):"Pay and Reserve"})}):e.jsx("div",{className:"p-3 text-sm border rounded-lg border-error bg-error/10",children:e.jsx("p",{className:"text-error",children:"You don't have enough balance."})})};ve.propTypes={isExpired:E.bool,isChecked:E.object,hold_possible:E.string};const _e=({session_expire:a,action:i})=>{const{datetime:l,timestamp:g}=a,[o,t]=b.useState(g-Date.now()/1e3);return b.useEffect(()=>{const m=()=>{t(null),i(!0)},d=setInterval(()=>{t(u=>u-1),o<=0&&(clearInterval(d),m())},1e3);return()=>{clearInterval(d)}},[o,i]),e.jsxs("div",{className:"mb-3 overflow-hidden text-sm border rounded-lg session-timeout",children:[e.jsx("h6",{className:"p-1 font-semibold text-center",children:"Session Timeout in"}),e.jsx("div",{className:"p-1",children:e.jsx("div",{className:"flex justify-center gap-4 pb-1 mx-auto text-center",children:o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"time",children:[e.jsx("h5",{className:"text-xl font-semibold text-primary",children:Math.floor(o/60)}),e.jsx("p",{children:"min"})]}),e.jsx("div",{className:"time",children:e.jsx("h5",{className:"text-xl font-semibold text-primary",children:":"})}),e.jsxs("div",{className:"time",children:[e.jsx("h5",{id:"timeout_sec",className:"text-xl font-semibold text-primary",children:Math.floor(o%60)}),e.jsx("p",{children:"sec"})]})]}):e.jsx("h5",{className:"text-xl font-semibold text-primary",children:"Expired"})})})]})};_e.propTypes={session_expire:E.object.isRequired,action:E.func};const Ne=({validation_data:a})=>{var _,C,O,V,L,U,D,Y,k,h,s,w,K,X,Q,re;const{price_change:i,search_price:l,validation_price:g,session_expire:o,data:{sell:t,hold_possible:m,pax_options:d},terms:u,cancellation_terms:r}=a,{terms_selection:c,cancellation_selection:x}=d||{},[T,y]=b.useState(!1),[q,P]=b.useState(!1),{payment_type:M}=I.useState(),{user_data:f}=J.useState(),[p,n]=b.useState({terms_conditions:!1,cancellation_policy:!1}),[v,j]=b.useState(!1),{price_view:{online_payment_option:S,show_flight_fare_rules:A,show_sell_price:B}={}}=H.useState();b.useEffect(()=>{var F;((F=t==null?void 0:t.total)==null?void 0:F.amount)>(f==null?void 0:f.balance)&&m==="no"&&(S==="ACTIVE"?I.update(W=>{W.payment_type="onlinepayment"}):I.update(W=>{W.payment_type=null}))},[(_=t==null?void 0:t.total)==null?void 0:_.amount,f==null?void 0:f.balance,m,S]),b.useEffect(()=>{n({terms_conditions:c==="check"||c==="hide",cancellation_policy:x==="check"||x==="hide"})},[c,x]);const R=F=>{var W;((W=t==null?void 0:t.total)==null?void 0:W.amount)>(f==null?void 0:f.balance)&&m==="no"?(F.preventDefault(),F.target.value==="account_balance"?se("error","Insufficient Balance","Please add balance to your account"):F.target.click()):I.update(Se=>{Se.payment_type=F.target.value})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"p-3 mb-3 rounded-lg bg-base-200",children:[(B==null?void 0:B.toUpperCase())==="YES"&&e.jsxs("div",{className:"p-3 mb-3 text-sm border rounded",children:[e.jsxs("h6",{className:"mb-2 font-semibold",children:[e.jsx(ce,{className:"mr-1"})," Price: ",i]}),e.jsxs("p",{children:["Updated Price: ",z(g.currency)," ",g.amount]}),e.jsxs("p",{children:["Search Price: ",z(l.currency)," ",l.amount]})]}),A==="YES"&&e.jsxs("div",{className:"p-3 mb-3 text-sm border rounded",children:[e.jsxs("h6",{className:"mb-2 font-semibold",children:[e.jsx(ce,{className:"mr-1"})," Fare Rules & Policy"]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("button",{onClick:()=>ae("fare_rules",a),className:"inline-flex text-primary hover:underline",children:"Penalty and Cancellation Information"}),e.jsx("button",{onClick:()=>ae("fare_rules",a),className:"inline-flex text-primary hover:underline",children:"Flight Fare rules"})]})]}),e.jsx(_e,{session_expire:o,action:F=>j(F)}),e.jsxs("div",{className:"p-3 mb-3 text-sm border rounded",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Fare/Pax type"}),e.jsx("p",{className:"font-medium",children:"Amount"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Base Fare"}),e.jsxs("p",{className:"font-medium",children:[z((C=t==null?void 0:t.base_fare)==null?void 0:C.currency)," ",(V=Number((O=t==null?void 0:t.base_fare)==null?void 0:O.amount))==null?void 0:V.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Tax"}),e.jsxs("p",{className:"font-medium",children:[z((L=t==null?void 0:t.tax)==null?void 0:L.currency)," ",(D=Number((U=t==null?void 0:t.tax)==null?void 0:U.amount))==null?void 0:D.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Total"}),e.jsxs("p",{className:"font-medium",children:[z((Y=t==null?void 0:t.total)==null?void 0:Y.currency)," ",(h=Number((k=t==null?void 0:t.total)==null?void 0:k.amount))==null?void 0:h.toFixed(2)]})]}),e.jsx("hr",{className:"mb-3 border border-neutral/20"}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Total Fare"}),e.jsx("p",{className:"font-medium",children:"Amount"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("p",{children:"Total Published Fare"}),e.jsxs("p",{className:"font-medium",children:[z((s=t==null?void 0:t.total)==null?void 0:s.currency)," ",(K=Number((w=t==null?void 0:t.total)==null?void 0:w.amount))==null?void 0:K.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 mb-3 border rounded-lg text-primary",children:[e.jsx("p",{children:"Total Payable"}),e.jsxs("p",{className:"font-medium fs-4",children:[z((X=t==null?void 0:t.total)==null?void 0:X.currency)," ",(re=Number((Q=t==null?void 0:t.total)==null?void 0:Q.amount))==null?void 0:re.toFixed(2)]})]}),e.jsxs("div",{className:"grid gap-3 mb-3 sm:grid-flow-col lg:grid-flow-row xl:grid-flow-col payment-selection",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("input",{autoComplete:"off",type:"radio",className:"absolute -translate-y-1/2 radio radio-xs radio-primary left-2 top-1/2 peer",name:"payment",id:"balance",value:"account_balance",defaultChecked:M==="account_balance",onClick:R}),e.jsx("label",{htmlFor:"balance",className:"block px-2 py-4 pl-8 text-nowrap bg-primary/10 peer-checked:bg-primary peer-checked:text-white",children:"Account Balance"})]}),S==="ACTIVE"&&e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("input",{autoComplete:"off",type:"radio",className:"absolute -translate-y-1/2 radio radio-primary radio-xs top-1/2 left-2 peer",name:"payment",id:"card",value:"onlinepayment",defaultChecked:M==="onlinepayment",onClick:R}),e.jsxs("label",{className:"block px-2 py-4 pl-8 bg-primary/10 peer-checked:bg-primary peer-checked:text-white",htmlFor:"card",children:["Card ",e.jsx(He,{className:"ml-1"})]})]})]}),c!=="hide"&&e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",checked:p.terms_conditions,id:"terms",onChange:F=>n({...p,terms_conditions:F.target.checked})}),e.jsxs("label",{className:"text-sm font-medium form-check-label",htmlFor:"terms",children:["I have read and accept all"," ",e.jsx("button",{onClick:()=>(u==null?void 0:u.status)==="active"&&y(!0),className:"inline text-primary",children:"Terms & Conditions"})]})]}),x!=="hide"&&e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",checked:p.cancellation_policy,id:"policies",onChange:F=>n({...p,cancellation_policy:F.target.checked})}),e.jsxs("label",{className:"text-sm font-medium form-check-label",htmlFor:"policies",children:["I agree and understand the"," ",e.jsx("button",{onClick:()=>(r==null?void 0:r.status)==="active"&&P(!0),className:"inline text-primary",children:"Cancellation Policies"})]})]}),e.jsx(ve,{isExpired:v,isChecked:p,hold_possible:m}),e.jsx(it,{})]})}),e.jsx(ot,{isActive:T,setIsActive:y,data:u}),e.jsx(lt,{isActive:q,setIsActive:P,data:r})]})};Ne.propTypes={validation_data:E.object.isRequired};const qt=()=>{const[a]=Ye(),{site_title:i}=H.useState(),l=a.get("tracking_id"),{price_view:{show_flight_fare_rules:g}={}}=H.useState(),{user_data:{member_id:o}}=J.useState(),{axiosInstance:t}=he(),{data:m,isLoading:d,error:u}=xe(["VALIDATION_DATA",l,o],async()=>{var c,x;const r=await t.post("/flight/validation-get-status",{booking_tracking_id:l,member_id:o});if(((c=r.data)==null?void 0:c.status)==="success")return r.data;throw{...r,message:((x=r.data)==null?void 0:x.reason)||"Request failed!"}});if(b.useEffect(()=>{G.update(r=>{r.booking_tracking_id=l}),I.update(r=>{r.booking_tracking_id=l})},[l]),d)return e.jsx(Ee,{});if(u)throw u;return e.jsxs(e.Fragment,{children:[e.jsx(Me,{children:e.jsxs("title",{children:["Flight Checkout",i?" - "+i:""]})}),e.jsx("main",{className:"container min-h-screen pt-20",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 pt-2 mb-8 lg:grid-cols-7",children:[e.jsx(ye,{validation_data:m}),e.jsx(Ne,{validation_data:m})]})}),g==="YES"&&e.jsx(Je,{})]})};export{qt as default};
