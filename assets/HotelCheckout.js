import{aN as R,e as I,o as e,aO as H,aP as N,l as D,I as z,aQ as re,aR as le,a6 as ne,m as G,O as Q,Q as P,a8 as Y,G as ce,X as ie,Y as oe}from"./index.js";import{P as S,w as L,x as V,a as U,b as $,bq as de,aa as me,S as J,br as ue,aR as pe,bs as xe,bt as he,r as be,G as O,I as ge,q as fe}from"./App.js";import{A as je,a as B}from"./AccordionItem.js";import{R as ye}from"./RadioInputCheckout.js";import{T as F}from"./TextInputCheckout.js";import{I as K}from"./InputContainerCheckout.js";import{P as W}from"./PhoneNumberSelect.js";import{C as Ne}from"./Checkbox.js";import{C as _e}from"./CustomPopOver.js";import{a as ke}from"./Room.js";import{w as we}from"./sweetalert2-react-content.es.js";import{g as ve}from"./index.esm3.js";import{H as Ce}from"./index.esm7.js";import{C as X}from"./CustomDivider.js";import{S as Se}from"./SessionTimeOut.js";import"./index.esm2.js";import"./PopOverOfPriceHotel.js";const Z=({pax_id:u,pax_type:t,room_id:i,index:a,primaryGuestOnly:d,pax_age:p})=>{var m,h,o;const{passenger:x}=R.useState(),s=i+"_"+u;return I.useEffect(()=>{R.update(b=>{b.passenger[s]={...b.passenger[s],pax_id:String(u),pax_type:t,room_number:String(i),title:"MR",age:p,first_name:a>0?"TBA":"",last_name:a>0?"TBA":""}})},[s,u,t,i,a,p]),a>0&&d?null:e.jsxs("div",{children:[!d&&e.jsxs("h6",{className:"mb-4 font-medium",children:[t==="ADT"?e.jsx(L,{className:"mr-0.5"}):e.jsx(V,{className:"mr-0.5"})," ",t==="ADT"?"Adult":"Child"," ",u]}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsx(ye,{label:"Title",isRequired:!0,defaultValue:((m=x[s])==null?void 0:m.title)||"MR",action:b=>H(s,{title:b.target.value}),options:[{label:"Mr",value:"MR"},{label:"Mrs",value:"MRS"},{label:"Ms",value:"MS"}]}),e.jsx(F,{label:"First/Given Name",isRequired:!0,action:b=>H(s,{first_name:b.target.value}),isUpperCase:!0,defaultValue:((h=x[s])==null?void 0:h.first_name)||"",placeholder:"John"}),e.jsx(F,{label:"Last/Family Name",isRequired:!0,action:b=>H(s,{last_name:b.target.value}),isUpperCase:!0,defaultValue:((o=x[s])==null?void 0:o.last_name)||"",placeholder:"Doe"})]})]})};Z.propTypes={room_id:S.number.isRequired,pax_id:S.number.isRequired,pax_type:S.string.isRequired};const Re=()=>{const{axiosInstance:u}=U(),{tracking_id:t}=R.useState(s=>s),{isd_code:i,contact_no:a,email_address:d}=N.useState(),{user_data:{login_key:p,member_id:x}}=D.useState(s=>s);return $(["USER_DETAILS",t,p,x],async()=>{var h;const s=await u.post("/user/profile",{login_key:p,member_id:x}),m=location.origin;if(((h=s.data)==null?void 0:h.status)==="success")return N.update(o=>{o.tracking_id=t,o.member_id=s.data.data.member_id,o.contact_no=s.data.data.mobile,o.agency_contact_no=s.data.data.mobile,o.email_address=s.data.data.email,o.agency_email=s.data.data.email,o.agency_isd_code=s.data.data.isd_code,o.isd_code=s.data.data.isd_code,o.redirect_url=`${m}/booking-details/hotel`}),s.data.data}),e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"flex w-full mx-auto mb-3 text-xs badge badge-info bg-info/5 text-info",children:"System will send reservation confirmation email with your branding profile. No price information will be shown there"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(K,{label:"Mobile Number",isRequired:!0,defaultValue:String(i||"")+String(a||""),action:s=>N.update(m=>{m.isd_code=s.isd_code,m.contact_no=s.mobile}),placeholder:"Enter Mobile Number",Input:W}),e.jsx(F,{type:"email",label:"Email",action:s=>N.update(m=>{m.email_address=s.target.value}),placeholder:"example@mail.com",defaultValue:d})]})]})},qe=()=>{const{agency_isd_code:u,agency_contact_no:t,agency_email:i}=N.useState(a=>a);return e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"flex w-full mx-auto mb-3 text-xs badge badge-info bg-info/5 text-info",children:"Below information will send to hotel as contact details"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(K,{label:"Mobile Number",isRequired:!0,defaultValue:String(u||"")+String(t||""),action:a=>N.update(d=>{d.agency_isd_code=a.isd_code,d.agency_contact_no=a.mobile}),placeholder:"Enter Mobile Number",Input:W}),e.jsx(F,{type:"email",label:"Email",action:a=>N.update(d=>{d.agency_email=a.target.value}),placeholder:"example@mail.com",defaultValue:i})]})]})},Ie=()=>{const{special_requests_notes:u,special_requests:t}=N.useState(i=>i);return e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"flex w-full mx-auto mb-3 text-xs badge badge-warning bg-warning/5 text-warning",children:"**All Special Requests are not guaranteed. It depends on the subjective availability at check-in time"}),e.jsx("div",{className:"grid grid-cols-1 gap-3 mb-4 text-[13px] sm:grid-cols-3",children:t.map((i,a)=>e.jsx(Ne,{label:i.label,defaultChecked:i.requested,action:d=>N.update(p=>{const x=[...p.special_requests];x[a].requested=d,p.special_requests=x})},a))}),e.jsxs("div",{className:"sb-input-container",children:[e.jsx("label",{htmlFor:"remarkNotes",className:"sb-label",children:"Remarks Notes (Special Request Additional Notes)"}),e.jsx("textarea",{id:"remarkNotes",defaultValue:u,onChange:i=>N.update(a=>{a.special_requests_notes=i.target.value}),className:"block w-full p-0 m-0 font-medium bg-transparent rounded-none placeholder:text-neutral/50 outline-0 min-h-12 focus:outline-0",placeholder:"Provide details notes regaring any special requests"})]})]})},Te=({room:u,room_content:t})=>{var k;const{name:i,meal_option:a,occupancies:d,rate_type:p,amenities:x,price:s}=u,{bed_type:m,room_size:h,views:o,description:b,room_pic:v,additional_images:r,amenities:g,paid_amenities:f}=t||{},j=we(J),y=()=>{const l={title:i,images:(r==null?void 0:r.map(c=>c==null?void 0:c.url))||[v],amenities:[...x.map(c=>c==null?void 0:c.title)||[],...g||[],...(m==null?void 0:m.map(c=>{var n;return(n=c==null?void 0:c.configuration)==null?void 0:n.map(w=>w==null?void 0:w.type)}))||[]],description:b,paid_amenities:f};j.fire({html:e.jsx(ke,{room:l}),showConfirmButton:!1,showCloseButton:!0,customClass:{popup:"w-full max-w-xl !overflow-hidden",htmlContainer:"!m-0",closeButton:"text-red-500"}})},_=m==null?void 0:m.reduce((l,c)=>(c!=null&&c.description&&l.some(n=>(n==null?void 0:n.description)===(c==null?void 0:c.description))===!1&&l.push(c),l),[]);return e.jsxs("tr",{children:[e.jsx("td",{className:"p-3 align-top border border-neutral/10 min-w-[200px]",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[((k=s==null?void 0:s.promo_tag)==null?void 0:k.description)&&e.jsxs("div",{className:"relative flex px-2 py-1 pr-6 text-xs font-light text-white bg-gradient-to-r from-secondary-focus to-secondary -left-3 w-fit !line-clamp-1",children:[s.promo_tag.description,e.jsx("span",{className:"absolute top-0 right-0 h-0 border-y-[12px] border-x-[12px] border-transparent border-r-white"})]}),v&&e.jsx("img",{src:v||"/no_image.jpg",alt:i,className:"h-[150px] object-cover object-center rounded"}),e.jsxs("h5",{className:"text-[15px] font-medium",children:[d==null?void 0:d.total_room," X ",i]}),e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[h&&e.jsxs("span",{className:"text-[10px] flex items-center px-1 py-0.5 font-medium rounded bg-secondary/10 text-secondary w-fit gap-1",children:[e.jsx(de,{})," ",e.jsxs("span",{children:[h," m",e.jsx("sup",{children:"2"})]})]}),e.jsx(_e,{button:e.jsxs("div",{className:"text-[10px] flex items-center px-1 py-0.5 font-medium rounded bg-secondary/10 text-secondary w-fit gap-0.5",children:[e.jsx("span",{className:"mr-1",children:"Sleeps:"}),Number(d.adult)>0&&[...Array(Number(d.adult))].map((l,c)=>e.jsx(L,{},c)),Number(d.child)>0&&[...Array(Number(d.child))].map((l,c)=>e.jsx(V,{},c))]}),children:e.jsxs("div",{className:"flex flex-col gap-1 px-3 py-2 text-xs",children:[e.jsxs("div",{className:"text-primary",children:[e.jsx(L,{})," Adult: ",d.adult]}),e.jsxs("div",{className:"text-secondary",children:[e.jsx(V,{})," Child: ",d.child]})]})})]}),e.jsx("div",{children:e.jsxs("button",{onClick:()=>y(),className:"px-1 text-xs font-bold text-primary bg-base-200",children:["Room Amenities ",e.jsx(me,{})]})})]})}),e.jsxs("td",{className:"p-3 border border-neutral/10 min-w-[150px]",children:[e.jsxs("ul",{className:"flex flex-col gap-1 text-xs",children:[(_==null?void 0:_.length)>0&&e.jsxs("li",{className:"align-middle list-item text-secondary",children:[e.jsx(ve,{className:"text-xl"})," ",_.map(l=>l.description).join("/")]}),(!a||(a==null?void 0:a.some(l=>(l==null?void 0:l.included)==="yes"))===!1)&&p&&e.jsxs("li",{className:"align-middle list-item text-secondary",children:[e.jsx(z,{path:re,size:.8})," ",p]}),(a==null?void 0:a.length)>0&&(a==null?void 0:a.map((l,c)=>e.jsxs("li",{className:"align-middle list-item text-secondary",children:[e.jsx(z,{path:le,size:.8})," ",l.title]},c))),o==null?void 0:o.map((l,c)=>l&&e.jsxs("li",{className:"align-middle list-item text-secondary",children:[e.jsx(Ce,{className:"mr-1"})," ",l]},c))]}),b&&e.jsx("div",{className:"mt-2 text-xs text-neutral line-clamp-[2] inner-html",dangerouslySetInnerHTML:{__html:b}})]})]})},Ae=({validation_data:u})=>{var a,d,p;const t=u==null?void 0:u.data,i=(d=(a=u==null?void 0:u.hotel_contents)==null?void 0:a.data)==null?void 0:d.room_type;return e.jsxs("table",{className:"w-full mb-4 text-sm room-table",children:[e.jsx("thead",{}),e.jsx("tbody",{children:(p=t==null?void 0:t.data)==null?void 0:p.map(x=>{const{room_number:s}=x||{},m=i==null?void 0:i.find(h=>(h==null?void 0:h.room_id)===s);return e.jsx(Te,{room:x,room_content:m},s)})})]})},ee=({validation_data:u})=>{var m,h,o,b,v;const{search_parameter:{occupancies:t},booking_tracking_id:i,data:a}=u,d=(h=(m=a==null?void 0:a.data)==null?void 0:m.at(0))==null?void 0:h.rate_comments;let p=I.useMemo(()=>0,[]);I.useEffect(()=>(R.update(r=>{r.tracking_id=i}),N.update(r=>{r.tracking_id=i}),()=>{R.update(r=>{r.passenger=R._getInitialState().passenger})}),[i]);const[x,s]=I.useState(!1);return e.jsxs("div",{className:"p-3 rounded-lg lg:col-span-2 bg-base-200",children:[e.jsx(Ae,{validation_data:u}),!!d&&e.jsx("div",{className:"p-2 mb-3 text-sm border rounded-md border-warning/20 text-error",children:e.jsx("div",{className:"relative flex items-end gap-2",children:e.jsxs("div",{children:[e.jsx("h1",{className:"mb-1 text-lg font-semibold text-red-600",children:"***Attention***"}),e.jsx("div",{className:"text-red-400",children:e.jsx("p",{className:" inner-html",dangerouslySetInnerHTML:{__html:ne(d)}})})]})})}),e.jsx("div",{className:"p-2 mb-3 text-sm border border-yellow-100 rounded-md",children:e.jsx("div",{className:"relative flex items-end gap-2",children:e.jsxs("div",{children:[e.jsx("h1",{className:"mb-1 text-lg font-semibold text-yellow-400",children:"Cancellation Policies"}),e.jsx("div",{className:"text-neutral",children:(o=a==null?void 0:a.data)==null?void 0:o.map(r=>{var g,f;return e.jsxs("div",{children:[e.jsx("h1",{className:"font-semibold text-base-content",children:r==null?void 0:r.name}),(f=(g=r==null?void 0:r.cancellation_policies)==null?void 0:g.policy_breakdown)==null?void 0:f.map((j,y)=>e.jsx("p",{className:"text-xs",children:j==null?void 0:j.details},y))]},r==null?void 0:r.room_number)})})]})})}),((b=a==null?void 0:a.data)==null?void 0:b.some(r=>{var g,f,j,y;return((y=(j=(f=(g=r==null?void 0:r.price)==null?void 0:g.purchase)==null?void 0:f.price_breakdown)==null?void 0:j.payable_at_property)==null?void 0:y.length)>0}))&&e.jsx("div",{className:"p-2 mb-3 text-sm border border-blue-100 rounded-md",children:e.jsx("div",{className:"relative flex items-end gap-2",children:e.jsxs("div",{children:[e.jsx("h1",{className:"mb-1 text-lg font-semibold text-blue-400",children:"Payable at Property"}),e.jsx("div",{className:"text-neutral",children:(v=a==null?void 0:a.data)==null?void 0:v.map(r=>{var g,f,j,y,_,k,l,c;return((y=(j=(f=(g=r==null?void 0:r.price)==null?void 0:g.purchase)==null?void 0:f.price_breakdown)==null?void 0:j.payable_at_property)==null?void 0:y.length)>0&&e.jsxs("div",{children:[e.jsx("h1",{className:"font-semibold text-base-content",children:r==null?void 0:r.name}),(c=(l=(k=(_=r==null?void 0:r.price)==null?void 0:_.purchase)==null?void 0:k.price_breakdown)==null?void 0:l.payable_at_property)==null?void 0:c.map(n=>e.jsxs("div",{className:"text-xs",children:[e.jsxs("strong",{children:[n==null?void 0:n.title,":"]})," ",e.jsxs("span",{children:[n==null?void 0:n.currency," ",n==null?void 0:n.amount]})," ",e.jsxs("span",{className:"neutral",children:["(",n==null?void 0:n.remark,")"]})]},n==null?void 0:n.title))]},r==null?void 0:r.room_number)})})]})})}),e.jsxs(je,{className:"w-full mb-8 bg-base-200 border",children:[e.jsxs(B,{isOpen:!0,header:"Enter Guest Details",disabled:!0,children:[e.jsxs("div",{className:"flex items-center gap-4 px-4 pt-2",children:[e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"cursor-pointer label",children:[e.jsx("input",{type:"radio",name:"hotel-checkout-option",className:"mr-2 radio radio-primary radio-sm",checked:!x,onChange:r=>s(!r.target.checked)}),e.jsx("span",{className:"label-text",children:"Primary Guest Only"})]})}),e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"cursor-pointer label",children:[e.jsx("input",{type:"radio",name:"hotel-checkout-option",className:"mr-2 radio radio-primary radio-sm",checked:x,onChange:r=>s(r.target.checked)}),e.jsx("span",{className:"label-text",children:"All Guest"})]})})]}),Array(t.length).fill("").map((r,g)=>{const f=t[g].room,j=Number(t[g].adult),y=t[g].child?Number(t[g].child):0,_=j+y;let k=0,l=0;return e.jsxs("div",{className:"p-3",children:[e.jsxs("h5",{className:"flex items-center px-3 py-2 text-lg font-bold border border-b-0 rounded-t",children:[e.jsx(ue,{className:"mr-1"})," Room ",f]}),e.jsx("div",{className:"p-3 border rounded rounded-t-none",children:e.jsx("div",{className:"flex flex-col gap-8",children:Array(_).fill("").map((c,n)=>{var A,E,T,q;p+=1;const w=n+1<=j?"ADT":"CNN";return k=w==="ADT"?k+1:k,l=w==="CNN"?l+1:l,e.jsx(Z,{room_id:f,pax_id:p,pax_type:w,index:n,primaryGuestOnly:!x,pax_age:w==="ADT"?((E=(A=t[g])==null?void 0:A.adult_age)==null?void 0:E[k-1])||"30":((q=(T=t[g])==null?void 0:T.child_age)==null?void 0:q[l-1])||"12"},n)})})})]},g)})]}),e.jsx(B,{isOpen:!0,header:"Enter Primary Guest Contact Details",disabled:!0,children:e.jsx(Re,{})}),e.jsx(B,{isOpen:!0,header:"Enter Agency Contact Details",disabled:!0,children:e.jsx(qe,{})}),e.jsx(B,{isOpen:!0,header:"Add Special Requests",disabled:!0,children:e.jsx(Ie,{})})]})]})};ee.propTypes={validation_data:S.object.isRequired};const se=({hotel:u,validation_data:t})=>{var j,y,_,k,l;const{search_parameter:i}=t||{},{name:a,address:{full_address:d},primary_photo:p,star_rating:x}=u,{checkIn:s,checkOut:m,occupancies:h}=i,o=h.reduce((c,n)=>c+Number(n.adult),0),b=h.reduce((c,n)=>c+(n.child?Number(n.child):0),0),{system_config:v}=G.useState(),{title:r}=((j=t==null?void 0:t.data)==null?void 0:j.summery)||{},{rate_type:g,bed_option:f}=((_=(y=t==null?void 0:t.data)==null?void 0:y.data)==null?void 0:_.at(0))||{};return e.jsxs("div",{className:"mx-4 overflow-hidden text-sm rounded-lg bg-base-100",children:[e.jsxs("div",{className:"relative before:content-[''] before:absolute before:inset-0 before:bg-gradient-to-b before:from-black/80 before:via-black/20 before:to-transparent booking-summary",children:[e.jsx("img",{src:p,alt:a,className:"w-full min-h-[300px] object-cover object-center"}),e.jsxs("div",{className:"absolute z-10 text-white top-4 left-4",children:[e.jsx("h5",{className:"mb-1 text-xl font-semibold",children:a}),e.jsxs("p",{className:"mb-2 text-warning text-[11px]",children:[Array(Math.floor(x)).fill(0).map((c,n)=>e.jsx(pe,{},n)),e.jsxs("span",{className:"text-white",children:[" (",x," Star)"]})]}),e.jsxs("p",{className:"text-xs text-white/80",children:[e.jsx(xe,{className:"mr-1 text-base text-primary"}),d]})]})]}),e.jsxs("div",{className:"p-3",children:[e.jsxs("p",{className:"flex items-center justify-between gap-4 mb-1",children:[e.jsx("span",{children:"Date"}),e.jsxs("span",{children:[Q(new Date(s)).format(v.default_date_format_print)," ","to"," ",Q(new Date(m)).format(v.default_date_format_print)]})]}),e.jsxs("p",{className:"flex items-center justify-between gap-4 mb-4",children:[e.jsx("span",{children:"Room"}),e.jsx("span",{children:r})]}),e.jsxs("p",{className:"flex items-center justify-end gap-4 mb-2 text-xs",children:[e.jsx("span",{className:"inline-block px-1 rounded bg-neutral/10",children:g}),((k=f==null?void 0:f.at(0))==null?void 0:k.title)&&e.jsx("span",{className:"inline-block px-1 rounded bg-neutral/10",children:(l=f==null?void 0:f.at(0))==null?void 0:l.title})]}),e.jsxs("p",{className:"flex items-center justify-between gap-4 mb-2",children:[e.jsx("span",{children:"Occupancy"}),e.jsxs("span",{children:[h.length," Room(s), ",o," adult(s)"," ",b>0&&`and ${b} children`]})]}),e.jsxs("p",{className:"flex items-center justify-between gap-4 mb-1",children:[e.jsx("span",{className:"fw-medium",children:"Room Fare"}),e.jsx("a",{className:"link-secondary",href:"#",children:e.jsx(he,{})})]})]})]})};se.propTypes={hotel:S.object.isRequired,search_parameter:S.object.isRequired};const ae=({isExpired:u,isChecked:t,hold_possible:i})=>{const{special_requests:a,special_requests_notes:d,...p}=N.useState(n=>n),{axiosInstance:x}=U(),[s,m]=I.useState(!1),{user_data:{member_id:h,login_key:o}}=D.useState(),{tracking_id:b,passenger:v}=R.useState(n=>n),r=a.filter(n=>n.requested).map(n=>n.label).join(", "),g=be(),{data:f,isLoading:j,isError:y}=$({queryKey:["SERVICE_STATUS",o,h],queryFn:async()=>{var n;try{const w=await x.post("/reports/service-status",{login_key:o,member_id:h});return((n=w==null?void 0:w.data)==null?void 0:n.service_status)||null}catch(w){console.error(w)}}}),_=async()=>{var n,w,A,E;if(!s)try{if(m(!0),t.terms_conditions===!1)throw new Error("Please accept Terms & Conditions");if(t.cancellation_policy===!1)throw new Error("Please accept Cancellation Policy");if(t.rate_terms===!1)throw new Error("Please accept Rate Terms");const T={tracking_id:b,member_id:h,passenger:Object.values(v)},q=await x.post("/hotel/update-travelers",T);if(((n=q==null?void 0:q.data)==null?void 0:n.status)==="success")try{const C=await x.post("/hotel/create-booking",{...p,member_id:h,special_requests_notes:`${r?`${r}, `:""} ${d}`.trim()||"n/a"});if(((w=C==null?void 0:C.data)==null?void 0:w.status)==="success")(E=(A=C==null?void 0:C.data)==null?void 0:A.general)!=null&&E.tracking_id?(g(`/booking-details/hotel?tracking_id=${C.data.general.tracking_id}`,{replace:!0}),P("success","Booking Successful",C.data.reason),R.replace(R._getInitialState()),N.replace(N._getInitialState()),Y.replace(Y._getInitialState())):(P("success","Hey buddy! One more step","Please pay now"),setTimeout(()=>{var M;window.location.replace((M=C==null?void 0:C.data)==null?void 0:M.payment_link)},1e3));else throw new Error(C.data.reason)}catch(C){(await J.fire({title:"Booking Failed!",html:C.message,icon:"error",showCancelButton:!1,showCloseButton:!1,confirmButtonColor:"hsl(var(--p)/1)",confirmButtonText:"Go Back",allowOutsideClick:!1})).isConfirmed&&g(-1,{replace:!0})}else throw new Error(q==null?void 0:q.data.reason)}catch(T){console.error(T),P("error","Failed!",T.message)}finally{m(!1)}};if(j)return e.jsxs("button",{className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",children:[e.jsx(O,{className:"mr-2 animate-spin"})," Loading..."]});if(y)return null;const{block_status:k,hotel_block:l,reason:c}=f;return k==="yes"&&l==="yes"?e.jsx("div",{className:"p-3 text-sm border rounded-lg border-error bg-error/10",children:e.jsx("p",{className:"text-error inner-html",dangerouslySetInnerHTML:{__html:c}})}):p!=null&&p.payment_type?e.jsx(e.Fragment,{children:p.payment_type==="account_balance"?e.jsx("button",{onClick:_,className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",disabled:u,children:s?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"mr-2 animate-spin"})," Loading..."]}):i==="yes"?"Hold Booking":"Confirm Booking"}):e.jsx("button",{onClick:_,disabled:u,className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",children:s?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"mr-2 animate-spin"})," Loading..."]}):"Pay and Reserve"})}):e.jsx("div",{className:"p-3 text-sm border rounded-lg border-error bg-error/10",children:e.jsx("p",{className:"text-error",children:"You don't have enough balance."})})};ae.propTypes={isExpired:S.bool.isRequired,isChecked:S.object,hold_possible:S.string.isRequired};const te=({hotel:u,validation_data:t})=>{var j,y,_,k;const{session_expire:i}=t,{currency:a,sell_total_price:d,total_amount:p,hold_possible:x}=((j=t==null?void 0:t.data)==null?void 0:j.summery)||{},{user_data:s}=D.useState(),{payment_type:m}=N.useState(),h=(k=(_=(y=t==null?void 0:t.data)==null?void 0:y.data)==null?void 0:_.at(0))==null?void 0:k.rate_terms,[o,b]=I.useState({terms_conditions:!1,cancellation_policy:!1,rate_terms:!h}),[v,r]=I.useState(!1),{price_view:{online_payment_option:g}={}}=G.useState();I.useEffect(()=>{p>(s==null?void 0:s.balance)&&x==="no"&&(g==="YES"?N.update(l=>{l.payment_type="card"}):N.update(l=>{l.payment_type=null}))},[p,s==null?void 0:s.balance,x,g]);const f=l=>{p>(s==null?void 0:s.balance)&&x==="no"?(l.preventDefault(),l.target.value==="account_balance"?P("error","Insufficient Balance","Please add balance to your account"):l.target.click()):N.update(c=>{c.payment_type=l.target.value})};return e.jsxs("div",{className:"sticky py-4 rounded-lg bg-base-200 h-fit top-5",children:[e.jsx(se,{hotel:u,validation_data:t}),e.jsx(X,{}),e.jsx(Se,{session_expire:i,action:l=>r(l)}),e.jsx(X,{}),e.jsxs("div",{className:"px-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 mb-3 rounded-lg bg-primary/10 text-primary",children:[e.jsx("p",{children:"Total payable"}),e.jsxs("p",{className:"text-lg font-bold",children:[ce(a)," ",d]})]}),e.jsxs("div",{className:"grid gap-3 mb-3 sm:grid-flow-col lg:grid-flow-row xl:grid-flow-col payment-selection",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("input",{autoComplete:"off",type:"radio",className:"absolute -translate-y-1/2 radio radio-xs radio-primary left-2 top-1/2 peer",name:"payment",id:"balance",value:"account_balance",defaultChecked:m==="account_balance",onClick:f}),e.jsx("label",{htmlFor:"balance",className:"block px-2 py-4 pl-8 text-nowrap bg-primary/10 peer-checked:bg-primary peer-checked:text-white",children:"Account Balance"})]}),g==="ACTIVE"&&e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("input",{autoComplete:"off",type:"radio",className:"absolute -translate-y-1/2 radio radio-primary radio-xs top-1/2 left-2 peer",name:"payment",id:"card",value:"card",defaultChecked:m==="card",onClick:f}),e.jsxs("label",{className:"block px-2 py-4 pl-8 bg-primary/10 peer-checked:bg-primary peer-checked:text-white",htmlFor:"card",children:["Card ",e.jsx(ge,{className:"ml-1"})]})]})]}),e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",value:"",id:"terms",onChange:l=>b({...o,terms_conditions:l.target.checked})}),e.jsxs("label",{className:"text-sm font-medium form-check-label",htmlFor:"terms",children:["I have read and accept"," ",e.jsx("a",{href:"#",className:"text-primary",children:"Terms & Conditions"})]})]}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",value:"",id:"policies",onChange:l=>b({...o,cancellation_policy:l.target.checked})}),e.jsxs("label",{className:"text-sm font-medium form-check-label",htmlFor:"policies",children:["I agree and understand"," ",e.jsx("a",{href:"#",className:"text-primary",children:"Cancellation Policies"})]})]}),!!h&&e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",value:"",id:"rate_terms",onChange:l=>b({...o,rate_terms:l.target.checked})}),e.jsx("label",{className:"text-sm font-medium form-check-label",htmlFor:"rate_terms",children:h})]}),e.jsx(ae,{isExpired:v,isChecked:o,hold_possible:x})]})]})};te.propTypes={hotel:S.object.isRequired,validation_data:S.object.isRequired};const Je=()=>{const{site_title:u}=G.useState(),[t]=fe(),i=t.get("booking_tracking_id"),{axiosInstance:a}=U(),{user_data:{member_id:d}}=D.useState(),{data:p,isLoading:x,error:s}=$(["HOTEL_VALIDATE",i,d],async()=>{var b,v;const o=await a.post("/hotel/validation-price-get-detail",{member_id:d,booking_tracking_id:i});if(((b=o.data)==null?void 0:b.status)==="success")return o.data;throw{...o,message:((v=o.data)==null?void 0:v.reason)||"Request failed!"}});if(I.useEffect(()=>{R.update(o=>{o.tracking_id=i}),N.update(o=>{o.tracking_id=i})},[i]),x)return e.jsx(ie,{});if(s)throw s;const{hotel_contents:m,...h}=p||{};return e.jsxs("main",{className:"container min-h-screen pt-20",children:[e.jsx(oe,{children:e.jsxs("title",{children:["Hotel Checkout",u?" - "+u:""]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 mb-8 lg:grid-cols-3",children:[e.jsx(ee,{validation_data:p}),e.jsx(te,{hotel:m==null?void 0:m.data,validation_data:h})]})]})};export{Je as default};
