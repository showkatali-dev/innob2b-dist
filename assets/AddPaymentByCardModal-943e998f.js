import{o as F,q as e,P as q,H as T,e as N,m as H,T as D,ab as z}from"./index-adb6807e.js";import{P as L,c as o,aJ as O,L as M,cS as E,d as V,e as Q,ad as U,o as Y,aa as K}from"./App-2ee69fad.js";import{I as J}from"./InputDate-89ab0986.js";import{P as G}from"./PhoneNumberSelect-47cc6bd4.js";import{N as W}from"./NoResult-6a0bb5bd.js";import{b as X}from"./index.esm-86de35f1.js";const Z=({data:i})=>{var n;const{system_config:u,component_version:s}=F.useState(),t=(n=s==null?void 0:s.general)==null?void 0:n.finance;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("div",{className:o("flex-1 px-4 py-3 rounded-md bg-primary/10",t==="3"&&"bg-base-100"),children:e.jsxs("h6",{className:"text-sm font-medium",children:[e.jsx(O,{})," Latest Ledger History"]})}),e.jsxs(M,{to:"/finance/ledger",className:"btn btn-primary bg-[#7a7fdc22] !text-primary hover:!text-white normal-case border-0",children:[e.jsx(O,{})," View ledger"]})]}),e.jsx("div",{className:"w-full overflow-auto",children:e.jsxs("table",{className:"table table-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:t==="3"?"text-sm font-medium uppercase":"",children:[e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Sl"}),e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Trs Type"}),e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Date & Time"}),e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Trx Amount"})]})}),e.jsx("tbody",{children:i.length>0?i.map((r,m)=>e.jsxs("tr",{className:o("",t==="3"&&"duration-200 cursor-pointer hover:bg-base-100 group"),children:[e.jsx("th",{className:o("border text-start",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:m+1}),e.jsx("td",{className:o("uppercase",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:r.trx_type}),e.jsx("td",{className:o("",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:q(new Date(r.timestamp*1e3)).format(`ddd, ${u.default_date_format_print} hh:mm A`)}),e.jsxs("td",{className:o("",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:[T(r.default_currency)," ",r.trx_amount]})]},r.Id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"100%",className:"py-2 text-sm text-center text-error",children:"no data available"})})})]})})]})};Z.propTypes={data:L.array.isRequired};const ee=({data:i})=>{var n;const{system_config:u,component_version:s}=F.useState(),t=(n=s==null?void 0:s.general)==null?void 0:n.finance;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("div",{className:o("flex-1 px-4 py-3 rounded-md bg-primary/10",t==="3"&&"bg-base-100"),children:e.jsxs("h6",{className:"text-sm font-medium",children:[e.jsx(E,{})," Latest Invoices"]})}),e.jsxs(M,{to:"/finance/invoice",className:"btn btn-primary bg-[#7a7fdc22] !text-primary hover:!text-white normal-case border-0",children:[e.jsx(E,{})," View Invoices"]})]}),e.jsx("div",{className:"w-full overflow-auto",children:e.jsxs("table",{className:"table table-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:t==="3"?"text-sm font-medium uppercase":"",children:[e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Sl"}),e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Invoice ID"}),e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Date & Time"}),e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Invoice Amount"}),e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Status"})]})}),e.jsx("tbody",{children:i.length>0?i.map((r,m)=>e.jsxs("tr",{className:o("",t==="3"&&"duration-200 cursor-pointer hover:bg-base-100 group"),children:[e.jsx("th",{className:o("border text-start",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:m+1}),e.jsx("td",{className:o("uppercase",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:r.invoice_id}),e.jsx("td",{className:o("",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:q(new Date(r.timestamp*1e3)).format(`ddd, ${u.default_date_format_print} hh:mm A`)}),e.jsxs("td",{className:o("",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:[T(r.default_currency)," ",r.invoice_amount]}),e.jsx("td",{className:o("",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:r.status})]},r.Id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"100%",className:"py-2 text-sm text-center text-error",children:"no data available"})})})]})})]})};ee.propTypes={data:L.array.isRequired};const te=({data:i})=>{var n;const{system_config:u,component_version:s}=F.useState(),t=(n=s==null?void 0:s.general)==null?void 0:n.finance;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("div",{className:o("flex-1 px-4 py-3 rounded-md bg-primary/10",t==="3"&&"bg-base-100"),children:e.jsxs("h6",{className:"text-sm font-medium",children:[e.jsx(E,{})," Latest Refunds History"]})}),e.jsxs(M,{to:"/finance/refunds",className:"btn btn-primary bg-[#7a7fdc22] !text-primary hover:!text-white normal-case border-0",children:[e.jsx(E,{})," View Refunds"]})]}),e.jsx("div",{className:"w-full overflow-auto",children:e.jsxs("table",{className:"table table-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:t==="3"?"text-sm font-medium uppercase":"",children:[e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Sl"}),e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Trx Id"}),e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Date & Time"}),e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Requested"}),e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Refund"}),e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Status"})]})}),e.jsx("tbody",{children:i.length>0?i.map((r,m)=>e.jsxs("tr",{className:o("",t==="3"&&"duration-200 cursor-pointer hover:bg-base-100 group"),children:[e.jsx("th",{className:o("border text-start",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:m+1}),e.jsx("td",{className:o("uppercase",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:r.refund_trx_id}),e.jsx("td",{className:o("",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:q(new Date(r.timestamp*1e3)).format(`${u.default_date_format_print} hh:mmA`)}),e.jsxs("td",{className:o("",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:[T(r.default_currency)," ",r.requested_refund_amount]}),e.jsxs("td",{className:o("",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:[T(r.default_currency)," ",r.refund_amount]}),e.jsx("td",{className:o("",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:e.jsx("span",{className:"text-[10px] bg-[#ffb55322] p-1 rounded text-[#ffb553] capitalize",children:r.refund_status})})]},r.Id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"100%",className:"py-2 text-sm text-center text-error",children:"no data available"})})})]})})]})};te.propTypes={data:L.array.isRequired};const se=({data:i})=>{var n;const{system_config:u,component_version:s}=F.useState(),t=(n=s==null?void 0:s.general)==null?void 0:n.finance;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("div",{className:o("flex-1 px-4 py-3 rounded-md bg-primary/10",t==="3"&&"bg-base-100"),children:e.jsxs("h6",{className:"text-sm font-medium",children:[e.jsx(E,{})," Latest Payment History"]})}),e.jsxs(M,{to:"/finance/payments",className:"btn btn-primary bg-[#7a7fdc22] !text-primary hover:!text-white normal-case border-0",children:[e.jsx(E,{})," View Payments"]})]}),e.jsx("div",{className:"w-full overflow-auto",children:e.jsxs("table",{className:"table table-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:t==="3"?"text-sm font-medium uppercase":"",children:[e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Sl"}),e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Payment Type"}),e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Payment Time"}),e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Payment Amount"}),e.jsx("th",{className:t!=="3"?"text-sm text-start bg-neutral/10 text-base-content":"",children:"Status"})]})}),e.jsx("tbody",{children:i.length>0?i.map((r,m)=>e.jsxs("tr",{className:o("",t==="3"&&"duration-200 cursor-pointer hover:bg-base-100 group"),children:[e.jsx("th",{className:o("border text-start",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:m+1}),e.jsx("td",{className:o("uppercase",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:r.payment_type}),e.jsx("td",{className:o("",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:q(new Date(r.timestamp*1e3)).format(`${u.default_date_format_print} hh:mmA`)}),e.jsx("td",{className:o("",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:T(r.default_currency)+r.payment_amount}),e.jsx("td",{className:o("",t==="3"&&"border-0 border-y bg-base-200 group-hover:bg-[#eff5f9] duration-200"),children:e.jsx("span",{className:"text-[10px] bg-[#ffb55322] p-1 rounded text-[#ffb553]",children:r.payment_status})})]},r.Id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"100%",className:"py-2 text-sm text-center text-error",children:"no data available"})})})]})})]})};se.propTypes={data:L.array.isRequired};const de=()=>{const[i,u]=N.useState(!1),[s,t]=N.useState({payment_type:"CASH",trx_date:"",trx_amount:"",booking_reference_id:"",trx_notes:"",payment_attachment:null}),{axiosInstance:n}=V(),{user_data:{login_key:r,member_id:m}}=H.useState(),{data:j=[]}=Q({queryKey:["OFFLINE_PAYMENT_OPTIONS",r,m],enabled:!!r&&!!m,queryFn:async()=>{var d;const a=await n.post("/finance/offline-payment-info",{login_key:r,member_id:m});if(((d=a.data)==null?void 0:d.status)==="success")return a.data.data}}),w=async()=>{var d,p,_,S;u(!0);let a=null;try{if(s.payment_attachment){const l=new FormData;l.append("documents_image_url",s.payment_attachment),l.append("member_id",m),l.append("image_type","file"),l.append("category","payment-slip");const g=await n.post("/tools/upload-cdn",l);((d=g==null?void 0:g.data)==null?void 0:d.status)==="success"&&(a=g.data.ObjectURL)}const x=await n.post("/finance/payment-request-submit",{...s,payment_attachment:a,login_key:r,member_id:m});if(((p=x==null?void 0:x.data)==null?void 0:p.status)==="success")document.getElementById("add_payment_modal").close(),D("success","Submitted!",(_=x==null?void 0:x.data)==null?void 0:_.reason);else throw new Error(((S=x.data)==null?void 0:S.reason)||"Payment request failed!")}catch(x){D("error","Failed",x.message)}finally{u(!1)}},b=N.useMemo(()=>j.filter(a=>s.payment_type==="MFS"&&a.payment_type==="MFS"||s.payment_type!=="MFS"&&a.payment_type==="BANK"),[j,s.payment_type]);return N.useEffect(()=>{["BANK-CHEQUE","BANK-CASH","BANK-TRANSFER","MFS"].includes(s.payment_type)?t(a=>{var d,p;return{...a,trx_notes:`${(d=b==null?void 0:b.at(0))==null?void 0:d.bank_name}-${(p=b==null?void 0:b.at(0))==null?void 0:p.account_number}`}}):t(a=>({...a,trx_notes:""}))},[s.payment_type,b]),e.jsx("dialog",{id:"add_payment_modal",className:"!z-20 modal",children:e.jsxs("div",{className:"max-w-xl p-0 rounded-md modal-box",children:[e.jsx("div",{className:"sticky top-0 left-0 px-4 pt-2 pb-1 bg-primary-focus",children:e.jsxs("form",{method:"dialog",className:"flex justify-between px-2 py-1 mb-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Add Payment - Credit Entry"}),e.jsx("button",{className:"text-white btn btn-sm btn-circle btn-ghost",children:"✕"})]})}),e.jsx("div",{className:"max-h-[60vh] h-full overflow-auto",children:e.jsxs("div",{className:"px-4 py-2 space-y-5",children:[e.jsxs("div",{className:"gap-2 text-sm form-control",children:[e.jsx("label",{children:"Payment Type"}),e.jsxs("select",{className:"h-10 min-h-0 text-sm rounded select select-bordered focus:outline-none",value:s.payment_type,onChange:a=>t({...s,payment_type:a.target.value}),children:[e.jsx("option",{value:"CASH",children:"Cash Payment"}),e.jsx("option",{value:"BANK-CHEQUE",children:"Bank Cheque Deposit"}),e.jsx("option",{value:"BANK-CASH",children:"Bank Cash Deposit"}),e.jsx("option",{value:"BANK-TRANSFER",children:"Bank Transfer "}),e.jsx("option",{value:"MFS",children:"Mobile Financial Service"}),e.jsx("option",{value:"OTHER",children:"Others Type"})]})]}),["BANK-CHEQUE","BANK-CASH","BANK-TRANSFER","MFS"].includes(s.payment_type)&&e.jsxs("div",{className:"gap-2 text-sm form-control",children:[e.jsx("label",{children:"Offline Payment Type"}),e.jsx("select",{className:"h-10 min-h-0 text-sm capitalize rounded select select-bordered focus:outline-none",value:s.trx_notes,onChange:a=>t({...s,trx_notes:a.target.value}),children:b==null?void 0:b.map(a=>e.jsxs("option",{value:`${a==null?void 0:a.bank_name}-${a==null?void 0:a.account_number}`,children:[a==null?void 0:a.bank_name,"-",a==null?void 0:a.account_number]},a==null?void 0:a.bank_name))})]}),e.jsxs("div",{className:"gap-2 text-sm form-control",children:[e.jsx("label",{children:"Transaction Date"}),e.jsx(J,{className:"w-full h-10 min-h-0 text-sm rounded input input-bordered focus:outline-none",defaultValue:s.trx_date,action:a=>t({...s,trx_date:a}),isStatic:!0,showMonths:1})]}),e.jsxs("div",{className:"gap-2 text-sm form-control",children:[e.jsx("label",{children:"Payment Amount"}),e.jsx("input",{autoComplete:"off",type:"text",value:s.trx_amount,onChange:a=>t({...s,trx_amount:a.target.value}),className:"h-10 min-h-0 text-sm rounded input input-bordered focus:outline-none"})]}),e.jsxs("div",{className:"gap-2 text-sm form-control",children:[e.jsx("label",{children:"Reference Number"}),e.jsx("input",{autoComplete:"off",type:"text",value:s.booking_reference_id,onChange:a=>t({...s,booking_reference_id:a.target.value}),className:"h-10 min-h-0 text-sm rounded input input-bordered focus:outline-none"})]}),["BANK-CHEQUE","BANK-CASH","BANK-TRANSFER","MFS"].includes(s.payment_type)===!1&&e.jsxs("div",{className:"gap-2 text-sm form-control",children:[e.jsx("label",{children:"Reference Notes"}),e.jsx("textarea",{value:s.trx_notes,onChange:a=>t({...s,trx_notes:a.target.value}),className:"p-2 text-sm rounded min-h-16 input input-bordered focus:outline-none"})]}),e.jsxs("div",{className:"gap-2 text-sm form-control",children:[e.jsx("label",{children:"Payment Slip"}),e.jsx("input",{autoComplete:"off",type:"file",className:"h-10 min-h-0 text-sm rounded file-input file-input-bordered focus:outline-none",onChange:a=>t({...s,payment_attachment:a.target.files[0]})})]})]})}),e.jsxs("div",{className:"sticky bottom-0 left-0 flex justify-end w-full gap-2 px-4 pt-1 pb-4 bg-base-100",children:[e.jsx("hr",{className:"mb-2"}),e.jsx("button",{onClick:w,className:`h-10 min-h-0 normal-case btn btn-primary ${i?"pointer-events-none":""}`,children:i?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"mr-2 animate-spin"})," Processing..."]}):"Add Payment"}),e.jsx("button",{onClick:()=>document.getElementById("add_payment_modal").close(),className:"h-10 min-h-0 normal-case btn bg-neutral/20 text-neutral hover:bg-neutral/20",children:"Close"})]})]})})},ie=()=>{var x;const{system_config:i}=F.useState(),{checkout_url:u}=i||{},[s,t]=N.useState(!1),{member_id:n,fullname:r,email:m,partner_id:j,default_currency:w,isd_code:b,mobile:a}=((x=H.useState())==null?void 0:x.user_data)||{},[d,p]=N.useState({isd_code:b,contact_number:a,service_details:"",name:r,email:m,amount:""}),_=Y(),S=async l=>{var B,R;if(l.preventDefault(),s)return;t(!0);const{name:g,email:I,isd_code:P,contact_number:h,amount:f,service_details:C}=d,k={name:g,email:I,member_id:n,ftm_partner_id:j,isd_code:P,contact_number:h,service_details:C,collection_type:"deposit",amount:f,currency:w,tracking_id:z().slice(0,8),redirect_url:origin+"/online-payment/status"};try{const c=await K.post(`${u}/request`,k);if(document.getElementById("deposit_modal").close(),((B=c.data)==null?void 0:B.status)==="success"){const{pay_tracking_id:v}=c.data;_(`/online-payment?pay_tracking_id=${v}`,{replace:!0})}else throw new Error(((R=c==null?void 0:c.data)==null?void 0:R.reason)||"Request failed!")}catch(c){D("error","Failed!",c.message)}finally{t(!1)}};return e.jsx("dialog",{id:"deposit_modal",className:"modal",children:e.jsxs("form",{onSubmit:S,className:"max-w-3xl p-4 modal-box",children:[e.jsx("h3",{className:"pb-2 text-lg font-semibold",children:"Pay a Deposit"}),e.jsx("hr",{className:"mb-4"}),e.jsxs("div",{className:"grid grid-cols-2 gap-y-4 gap-x-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-sm font-medium text-neutral",children:"Enter your name."}),e.jsx("input",{autoComplete:"off",type:"text",name:"name",className:"w-full h-10 text-sm rounded input input-bordered min-h-8 focus:outline-0 focus:border-neutral/30 ",value:d.name,onChange:l=>p({...d,name:l.target.value}),required:!0,placeholder:"Name"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-sm font-medium text-neutral",children:"Enter Your Email."}),e.jsx("input",{autoComplete:"off",type:"text",name:"receiver_id",className:"w-full h-10 text-sm rounded input input-bordered min-h-8 focus:outline-0 focus:border-neutral/30 ",value:d.email,onChange:l=>p({...d,email:l.target.value}),required:!0,placeholder:"Email"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-sm font-medium text-neutral",children:"Mobile"}),e.jsx(G,{placeholder:"Enter Mobile Number",className:"!h-10 !text-sm !bg-transparent !rounded input !input-bordered focus:outline-0 min-h-8 !w-full",defaultValue:String(d.isd_code||"")+String(d.contact_number||""),action:l=>p({...d,isd_code:l==null?void 0:l.isd_code,contact_number:l==null?void 0:l.mobile})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-sm font-medium text-neutral",children:"Input Amount."}),e.jsxs("div",{className:"w-full join",children:[e.jsx("span",{className:"flex items-center px-4 border rounded-l bg-neutral/10 text-neutral join-item border-neutral/20",children:w}),e.jsx("input",{autoComplete:"off",type:"text",name:"amount",className:"flex-1 w-full h-10 text-sm rounded input input-bordered min-h-8 focus:outline-0 focus:border-neutral/30 hide_arrow_key join-item",value:d.amount||"",onChange:l=>p({...d,amount:l.target.value}),required:!0,placeholder:"Amount"})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"mb-2 text-sm font-medium text-neutral",children:"Service Details."}),e.jsx("textarea",{type:"text",name:"service_details",className:"w-full text-sm rounded textarea textarea-bordered min-h-16 focus:outline-0 focus:border-neutral/30",required:!0,value:d.service_details||"",onChange:l=>p({...d,service_details:l.target.value}),placeholder:"Service Details",maxLength:249})]})]}),e.jsx("hr",{className:"mt-3"}),e.jsxs("div",{className:"modal-action",children:[e.jsx("button",{type:"submit",className:`normal-case btn btn-success btn-sm btn-outline ${s?"pointer-events-none":""}`,children:s?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"mr-2 animate-spin"})," Processing..."]}):"Submit"}),e.jsx("button",{type:"button",onClick:()=>document.getElementById("deposit_modal").close(),className:"normal-case btn btn-sm btn-outline text-neutral/70 hover:bg-neutral/70 border-neutral/70 hover:border-neutral/70",children:"Close"})]})]})})},me=()=>{var n;const{axiosInstance:i}=V(),{login_key:u,member_id:s}=((n=H.useState())==null?void 0:n.user_data)||{},{data:t=[]}=Q({queryKey:["OFFLINE_PAYMENT_OPTIONS",u,s],enabled:!!u&&!!s,queryFn:async()=>{var m;const r=await i.post("/finance/offline-payment-info",{login_key:u,member_id:s});if(((m=r.data)==null?void 0:m.status)==="success")return r.data.data}});return e.jsx("dialog",{id:"offline_payment_modal",className:"!z-20 modal",children:e.jsxs("div",{className:"max-w-xl p-0 pb-4 rounded-md modal-box",children:[e.jsx("div",{className:"sticky top-0 left-0 px-4 py-2 bg-primary-focus",children:e.jsxs("form",{method:"dialog",className:"flex justify-between px-2 py-1 mb-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Offline Payment Information"}),e.jsx("button",{className:"text-white btn btn-sm btn-circle btn-ghost",children:"✕"})]})}),e.jsx("div",{className:"max-h-[60vh] h-full overflow-auto",children:t.length>0?e.jsx("div",{className:"grid gap-6 p-4",children:t.map(r=>{const{payment_type:m,currency:j,bank_logo:w,bank_name:b,bank_address:a,country:d,beneficiary_name:p,account_number:_,account_type:S,routing:x,swift_code:l,institution_number:g,transit_number:I,sort_code:P,fees:h,payment_contacts:f,instructions:C}=r;return e.jsxs("div",{className:"p-4 overflow-hidden bg-white rounded-lg shadow-[0_2px_15px_-3px_rgba(0,0,0,0.07),0_10px_20px_-2px_rgba(0,0,0,0.04)]",children:[e.jsxs("h2",{className:"mb-2 text-xl font-semibold",children:[m," Payment"]}),e.jsxs("grid",{className:"grid gap-2",children:[e.jsx("div",{className:"flex",children:e.jsx("img",{src:w,alt:"Bank Logo",className:"h-12"})}),e.jsxs("div",{className:"text-sm",children:[b&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Bank Name:"})," ",b]}),_&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Account Number:"})," ",_]}),S&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Account Type:"})," ",S]}),d&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Country:"})," ",d]}),p&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Beneficiary Name:"})," ",p]}),a&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Bank Address:"})," ",a]}),j&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Currency:"})," ",j]}),x&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Routing:"})," ",x]}),l&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Swift Code:"})," ",l]}),g&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Institution Number:"})," ",g]}),I&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Transit Number:"})," ",I]}),P&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Sort Code:"})," ",P]}),(Number(h==null?void 0:h.charges_ratio)>0||Number(h==null?void 0:h.charges_fixed)>0)&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Fees: "}),Number(h==null?void 0:h.charges_ratio)>0&&`Charges Ratio ${h.charges_ratio}, `,Number(h==null?void 0:h.charges_fixed)>0&&`Charges Fixed ${h.charges_fixed}`]}),C&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Instructions:"})," ",C]}),((f==null?void 0:f.phone)||(f==null?void 0:f.email))&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"After Payment Contact Information:"})," ",f.phone&&`Phone: ${f.phone},`," ",f.email&&`Email: 
                    ${f.email}`]})]})]})]},_)})}):e.jsx(W,{height:"500px",btn:!0,emoji:"smile",text:"No result found!"})})]})})},ue=()=>{const[i,u]=N.useState(),[s,t]=N.useState(null),[n,r]=N.useState(null),[m,j]=N.useState(!1),{checkout_url:w}=F.useState(c=>c.system_config)||{},{email:b,fullname:a,member_id:d,isd_code:p,mobile:_,partner_id:S,default_currency:x}=H.useState(c=>c.user_data)||{},[l,g]=N.useState({amount:"",service_details:""}),I=async()=>{var c,v,y;if(!m){j(!0);try{const A={name:a,email:b,member_id:d,isd_code:p,contact_number:_,ftm_partner_id:S,service_details:l.service_details,payment_type:"amount",amount:l.amount,currency:x,payment_link_valid:"",collection_type:"deposit",tracking_id:z().slice(0,8),payment_link_base_url:origin+"/online-payment",redirect_url:origin+"/online-payment/status"},$=await K.post(`${w}/request`,A);((c=$.data)==null?void 0:c.status)==="success"&&(t($.data),r(((y=(v=$.data)==null?void 0:v.payment_option)==null?void 0:y.at(0))||null),u(!0))}catch(A){console.error(A),document.getElementById("add_payment_by_card").close(),D("error","Error",A==null?void 0:A.message)}finally{j(!1)}}},{payment_option:P}=s||{},{pay_tracking_id:h}=(s==null?void 0:s.data)||{},{amount:f,currency:C,charges:k,payable:B}=(n==null?void 0:n.gateway)||{},R=async()=>{var c,v;if(!m){j(!0);try{const y={pay_tracking_id:h,gateway_partner_code:n==null?void 0:n.gateway_partner_code},A=await K.post(`${w}/pay`,y);if(((c=A.data)==null?void 0:c.status)==="success")window.location.replace((v=A.data)==null?void 0:v.gateway_redirect_url);else throw new Error("Failed to process payment")}catch(y){console.error(y),D("error","Error",y==null?void 0:y.message)}finally{j(!1),u(!1),g({amount:"",service_details:""})}}};return e.jsx("dialog",{id:"add_payment_by_card",className:"z-50 modal",open:i,children:e.jsxs("div",{className:o("max-w-xl p-4 rounded modal-box bg-base-200",i&&"max-w-5xl"),children:[e.jsx("h3",{className:"mb-2 text-lg font-semibold",children:"Add Balance by Card"}),e.jsx("button",{type:"button",onClick:()=>{var c;return(c=document.getElementById("add_payment_by_card"))==null?void 0:c.close()},className:"absolute text-lg hover:bg-error/10 text-error btn btn-ghost top-2 right-2 btn-circle btn-sm",children:e.jsx(X,{})}),e.jsx("hr",{className:"mb-4"}),e.jsxs("div",{className:"overflow-auto max-h-80",children:[!i&&e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-sm font-medium text-neutral",children:"Input Amount."}),e.jsxs("div",{className:"w-full join",children:[e.jsx("span",{className:"flex items-center px-4 border rounded-l bg-neutral/10 text-neutral join-item border-neutral/20",children:x}),e.jsx("input",{autoComplete:"off",type:"text",name:"amount",className:"flex-1 w-full h-10 text-sm bg-transparent rounded input input-bordered min-h-8 focus:outline-0 focus:border-neutral/30 hide_arrow_key join-item",value:l.amount||"",onChange:c=>g({...l,amount:c.target.value}),required:!0,placeholder:"Amount"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-sm font-medium text-neutral",children:"Service Details."}),e.jsx("textarea",{type:"text",name:"service_details",className:"w-full text-sm bg-transparent rounded textarea textarea-bordered min-h-16 focus:outline-0 focus:border-neutral/30",required:!0,value:l.service_details||"",onChange:c=>g({...l,service_details:c.target.value}),placeholder:"Service Details",maxLength:249})]})]}),i&&s&&e.jsxs("div",{className:"grid gap-5 overflow-hidden border rounded-lg sm:grid-cols-2 text-start",children:[e.jsx("div",{className:"p-5 bg-primary text-primary-content",children:e.jsxs("div",{children:[e.jsx("h1",{children:"Summary of Payment"}),e.jsxs("ul",{className:"pl-3 mt-4 text-sm leading-relaxed list-disc list-inside list text-primary-content/80",children:[e.jsxs("li",{className:"capitalize",children:["Payment Option: ",n==null?void 0:n.gateway_name]}),e.jsxs("li",{children:["Amount: ",f," ",C]}),e.jsxs("li",{children:["Fixed Charge: ",k==null?void 0:k.fixed_charge," ",C]}),e.jsxs("li",{children:["Service Fee: ",k==null?void 0:k.service_fee," ",C]}),e.jsxs("li",{children:["Total Payable: ",B," ",C]})]})]})}),e.jsxs("div",{className:"p-5 text-start",children:[e.jsx("h2",{className:"mb-2 text-lg font-semibold",children:"Select Payment Option"}),e.jsx("div",{className:"grid grid-cols-2 gap-5",children:P==null?void 0:P.map(c=>{const{gateway_name:v,gateway_code:y}=c||{};return e.jsxs("div",{onClick:()=>r(c),className:o("capitalize flex justify-center items-center rounded w-full ring-base-content/20 h-16 ring-[1px] !border-l-8 border-2 border-transparent cursor-pointer text-lg font-bold text-primary gap-1",(n==null?void 0:n.gateway_name)===v&&"border-warning ring-0"),children:[e.jsx("img",{src:y==="stripe"?"/stripe_logo.webp":"/bkash_logo.png",alt:"",className:"w-8"})," ",e.jsx("span",{children:v})]},y)})})]})]})]}),e.jsx("div",{className:"modal-action",children:e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:i?R:I,type:"button",className:"h-10 min-h-0 text-base font-normal normal-case rounded btn btn-primary",children:m?"Processing...":i?"Pay Now":"Submit"})})})]})})};export{de as A,ie as D,ee as I,Z as L,me as O,se as P,te as R,ue as a};
