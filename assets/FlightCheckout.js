import{s as Y,S as F,e as $,r as v,j as e,P as I,T as U,b as ye,U as N,V as ve,W as _e,X as Ne,I as K,Y as Se,Z as we,_ as ke,$ as Ce,v as Fe,N as Me,z as se,a0 as De,a1 as ee,a2 as Te,a3 as Ie,a4 as Ee,a5 as de,d as me,g as ue,K as Re,a6 as X,k as ae,a as re,a7 as le,a8 as ne,a9 as H,aa as qe,J as Ae,ab as Pe,H as Be}from"./index.js";import{S as Ve,a as Le,b as Oe,F as He,Q as Ue,c as Ye}from"./index3.js";import{A as Qe,a as ie}from"./AccordionItem.js";import{T as z}from"./TextInputCheckout.js";import{I as te}from"./InputContainerCheckout.js";import{P as pe}from"./PhoneNumberSelect.js";import{D as Z}from"./DateInputCheckout.js";import{D as ze}from"./DropDownSelectCheckout.js";import{R as oe}from"./RadioInputCheckout.js";import{G as Ge}from"./index.esm3.js";import{C as We}from"./CountryWithCodeSelect.js";import{S as Je,E as $e,A as Ke,a as Xe,b as Ze,P as ea,c as aa,F as ta,d as sa}from"./FlightCancellationPolicyModal.js";import{S as ra,M as ce,a as la}from"./MultipleFlight2.js";import{P as na}from"./PrimaryTabsWithIcon.js";import{F as ia}from"./FlightItineraryData.js";import{S as oa}from"./SessionTimeOut.js";import{w as ca}from"./sweetalert2-react-content.es.js";import"./CustomPopOver.js";import"./InputDate.js";import"./shortcut-buttons-flatpickr.min.js";import"./SingleSelect.js";import"./pp.js";const da=()=>{const{checkout_form_email_modify:a,checkout_form_contact_modify:i}=Y.useState().booking_manage||{},{isd_code:d,contact_no:f,email_address:m}=F.useState(),{user_data:{member_id:t,mobile:u,email:p,isd_code:h}}=$.useState(s=>s);return v.useEffect(()=>{const s=location.origin;F.update(o=>{o.member_id=t,o.contact_no=u,o.email_address=p,o.isd_code=h,o.redirect_url=`${s}/booking-details/flight`})},[t,u,p,h]),e.jsxs("div",{className:"grid grid-cols-1 gap-3 p-3 sm:grid-cols-2",children:[e.jsx(te,{label:"Mobile Number",isRequired:!0,defaultValue:String(d||"")+String(f||""),action:s=>F.update(o=>{o.isd_code=s.isd_code||"",o.contact_no=s.mobile||""}),placeholder:"Enter Mobile Number",Input:pe,readOnly:(i==null?void 0:i.toUpperCase())==="DISABLE"&&!!d}),e.jsx(z,{type:"email",label:"E-mail",action:s=>F.update(o=>{o.email_address=s.target.value}),defaultValue:m,placeholder:"example@mail.com",readOnly:(a==null?void 0:a.toUpperCase())==="DISABLE"&&!!m})]})},he=({pax_id:a,pax_type:i,pax_options:d,isDocOptional:f,age:m})=>{var V,y,w,q,A,P,T,C,x,B,L,G,W,J,g;const{location_info:{country_code:t,isd_code:u}}=Y.useState(),{doc_required:p,frequent_flyer_selection:h,wheelchair_selection:s,pax_dob_required:o,seat_selection:b,meal_selection:_,baggage_selection:S,passport_scan_selection:M,pax_search_selection:E,pax_email_contact_selection:D}=d||{},[k,n]=v.useState(!1),[l,j]=v.useState(!1),{passenger:c}=U.useState(r=>r),Q=["MRS","MISS","MS"],R=ye().subtract(m,"years").format("YYYY-MM-DD");return v.useEffect(()=>{N(a,{gender:"M",wheelchair_required:"no",pax_id:a,first_name:"",last_name:"",dob:R,doc_no:"",doc_dateofexpiry:"",doc_dateofissue:"",frequent_flyer:"",contact_no:"",email_address:""})},[a,R]),v.useEffect(()=>{N(a,{title:i==="ADT"?"MR":"MSTR",pax_type:i,doc_country:t||"",isd_code:u||""})},[a,i,t,u]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-3",children:[e.jsxs("h6",{className:"mb-4 font-medium",children:[i==="ADT"?e.jsx(ve,{className:"mr-0.5"}):i==="CNN"?e.jsx(_e,{className:"mr-0.5"}):e.jsx(Ne,{className:"mr-0.5"})," ",i==="ADT"?"Adult":i==="CNN"?"Child":"Infant"," ","Traveler ",a]}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"grid gap-3 sm:col-span-2 sm:grid-cols-2 lg:col-span-3 lg:grid-cols-4",children:[e.jsx(oe,{label:"Title",isRequired:!0,defaultValue:((y=(V=c[a])==null?void 0:V.title)==null?void 0:y.toUpperCase())||"MR",action:r=>{N(a,{title:r.target.value,gender:Q.includes(r.target.value)?c[a].gender!=="F"?"F":c[a].gender:"M"})},options:i==="ADT"?[{label:"Mr",value:"MR"},{label:"Mrs",value:"MRS"},{label:"Ms",value:"MS"}]:[{label:"Mstr",value:"MSTR"},{label:"Miss",value:"MISS"}]}),e.jsx(oe,{label:"Gender",isRequired:!0,defaultValue:((w=c[a])==null?void 0:w.gender)||"M",action:r=>N(a,{gender:r.target.value,title:r.target.value==="F"?Q.includes(c[a].title)===!1?c[a].pax_type==="ADT"?"MRS":"MISS":c[a].title:c[a].pax_type==="ADT"?"MR":"MSTR"}),options:[{label:"Male",value:"M"},{label:"Female",value:"F"}]}),e.jsxs("div",{className:"flex gap-3 sm:col-span-2 max-lg:-order-1 lg:justify-end",children:[S==="active"&&e.jsx("button",{type:"button",onClick:()=>document.getElementById("baggage_modal").showModal(),className:"normal-case shadow btn btn-square btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Additional Baggage",children:e.jsx(K,{path:Se,size:1.1})}),b==="active"&&e.jsx("button",{type:"button",onClick:()=>document.getElementById("seat_modal").showModal(),className:"normal-case shadow btn btn-square btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Select Seat",children:e.jsx(K,{path:we,size:1.1})}),_==="active"&&e.jsx("button",{type:"button",onClick:()=>document.getElementById("meal_modal").showModal(),className:"normal-case shadow btn btn-square btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Select Meal",children:e.jsx(Ge,{className:"w-6 h-6"})}),M==="active"&&e.jsx("button",{type:"button",onClick:()=>n(!0),className:"normal-case shadow btn btn-square btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Scan Passport",children:e.jsx(K,{path:ke,size:1.1})}),E==="active"&&e.jsx("button",{type:"button",onClick:()=>j(!0),className:"normal-case shadow btn btn-ghost bg-primary/5 text-primary hover:bg-primary/20 btn-square tooltip tooltip-left tooltip-primary","data-tip":"Existing Passenger",children:e.jsx(K,{path:Ce,size:1.1})})]})]}),e.jsx(z,{label:"First/Given Name",isRequired:!0,action:r=>N(a,{first_name:r.target.value}),isUpperCase:!0,defaultValue:((q=c[a])==null?void 0:q.first_name)||"",placeholder:"John",maxLength:30}),e.jsx(z,{label:"Surname/Family/Last Name",isRequired:!0,action:r=>N(a,{last_name:r.target.value}),isUpperCase:!0,defaultValue:((A=c[a])==null?void 0:A.last_name)||"",placeholder:"Doe",maxLength:30}),o!=="no"&&e.jsx(Z,{label:"Date of Birth",isRequired:o!=="optional",action:r=>N(a,{dob:r}),placeholder:"Select Date of birth",defaultValue:(P=c[a])==null?void 0:P.dob}),p!=="no"&&!f&&e.jsxs(e.Fragment,{children:[e.jsx(te,{label:"Document Issue Country",isRequired:p!=="optional",action:r=>{var O;return N(a,{doc_country:((O=r[0])==null?void 0:O.value)||""})},defaultValue:(T=c[a])==null?void 0:T.doc_country,placeholder:"Select Country",Input:We}),e.jsx(z,{label:"Document Number",isRequired:p!=="optional",action:r=>N(a,{doc_no:r.target.value}),isUpperCase:!0,defaultValue:((C=c[a])==null?void 0:C.doc_no)||"",placeholder:"A0123456789"}),e.jsx(Z,{label:"Expiration Date",isRequired:p!=="optional",action:r=>N(a,{doc_dateofexpiry:r}),placeholder:"Select Date",defaultValue:(x=c[a])==null?void 0:x.doc_dateofexpiry}),e.jsx(Z,{label:"Date of Document Issuance",action:r=>N(a,{doc_dateofissue:r}),defaultValue:(B=c[a])==null?void 0:B.doc_dateofissue,placeholder:"Select Date"})]}),(h==="active"||h==="optional")&&e.jsx(z,{label:"Frequent Flyer Number",isRequired:h==="active",action:r=>N(a,{frequent_flyer:r.target.value}),isUpperCase:!0,defaultValue:((L=c[a])==null?void 0:L.frequent_flyer)||"",placeholder:"Type frequent flyer number"}),(s==="active"||s==="optional")&&e.jsx(ze,{label:"Wheelchair Required",isRequired:s==="active",options:[{label:"Yes",value:"yes"},{label:"No",value:"no"}],action:r=>{var O;return N(a,{wheelchair_required:((O=r[0])==null?void 0:O.value)||""})},defaultValue:(G=c[a])==null?void 0:G.wheelchair_required,placeholder:"Select"}),D!=="disable"&&e.jsxs(e.Fragment,{children:[e.jsx(te,{label:"Mobile Number",isRequired:!1,defaultValue:String(((W=c[a])==null?void 0:W.isd_code)||"")+String(((J=c[a])==null?void 0:J.contact_no)||""),action:r=>N(a,{isd_code:(r==null?void 0:r.isd_code)||"",contact_no:(r==null?void 0:r.mobile)||""}),placeholder:"Enter Mobile Number",Input:pe}),e.jsx(z,{type:"email",label:"E-mail",action:r=>N(a,{email_address:r.target.value}),placeholder:"example@mail.com",defaultValue:((g=c[a])==null?void 0:g.email_address)||""})]})]})]}),e.jsx(Je,{isOpenScanPassportModal:k,setIsOpenScanPassportModal:n,pax_id:a}),e.jsx($e,{isOpenExistingPassengerModal:l,setIsOpenExistingPassengerModal:j,pax_id:a})]})};he.propTypes={pax_id:I.number,pax_type:I.string,pax_options:I.object};const ma=()=>{const{save_pax:a}=U.useState();return e.jsx("div",{className:"flex justify-end px-3 py-4",children:e.jsxs("label",{htmlFor:"save_pax",className:"flex items-center align-middle",children:[e.jsx("input",{autoComplete:"off",type:"checkbox",id:"save_pax",defaultChecked:a==="yes",onChange:i=>U.update(d=>{d.save_pax=i.target.checked?"yes":"no"}),className:"rounded-sm checkbox checkbox-xs checkbox-primary"}),e.jsx("span",{className:"text-sm select-none",children:"Save Passenger Information"})]})})},xe=({flight_data:a})=>{const{search_parameter:{travelers_adult:i,travelers_adult_age:d,travelers_child:f,travelers_child_age:m,travelers_infants:t,travelers_infants_age:u},pax_options:p,supplier:h,flight_group:s}=a||{},o=h==null?void 0:h.currency,b=s==null?void 0:s.every(k=>{var n;return(n=k==null?void 0:k.routes)==null?void 0:n.every(l=>{var j,c;return((j=l==null?void 0:l.origin_airport)==null?void 0:j.country)==="Bangladesh"&&((c=l==null?void 0:l.destination_airport)==null?void 0:c.country)==="Bangladesh"})}),{seat_selection:_,meal_selection:S,baggage_selection:M,pax_save_option:E}=p||{},D=i+f+t;return e.jsxs(e.Fragment,{children:[e.jsxs(Qe,{className:"w-full mb-8 bg-base-200 shadow-md",children:[e.jsxs(ie,{isOpen:!0,header:"Enter Traveler Details",children:[Array(D).fill("").map((k,n)=>{const l=n+1,j=l<=i?"ADT":l-i<=f?"CNN":"INF";return e.jsx(he,{pax_id:l,pax_type:j,pax_options:p,isDocOptional:(o==null?void 0:o.toLowerCase())==="bdt"&&b,age:j==="ADT"?(d==null?void 0:d.at(n))||30:j==="CNN"?(m==null?void 0:m.at(n-i))||12:(u==null?void 0:u.at(n-i-f))||2},Fe())}),E==="active"&&e.jsx(ma,{})]}),e.jsx(ie,{isOpen:!0,header:"Enter Contact Details",children:e.jsx(da,{})})]}),M==="active"&&e.jsx(Ke,{}),_==="active"&&e.jsx(Xe,{}),S==="active"&&e.jsx(Ze,{})]})};xe.propTypes={flight_data:I.object.isRequired};const ua=[{id:1,name:"Flight Itinerary",value:"flight_itinerary",icon:e.jsx(Ee,{})},{id:2,name:"Fare Summary",value:"fare_summary",icon:e.jsx(de,{})}],pa=[{id:2,name:"Fare Summary",value:"fare_summary",icon:e.jsx(de,{})}],ge=({flight_data:a})=>{const{user_data:{user_access_level:i}={}}=$.useState(),{system_config:d,supplier_option:f}=Y.useState(),{search_result_version:m}=d||{},t=["1","4","5","7"].includes(m)?ua:pa,{show_supplier_option:u}=f||{},[p,h]=v.useState(t[0].value),{flight_group:s,price_breakdown:o}=a||{},[b,_]=v.useState(!1),S=v.useRef(),M=()=>{S.current.style.maxHeight=0,_(!1)},E=()=>{S.current.style.maxHeight=S.current.scrollHeight+"px",_(!0)},D=()=>{b?M():E()},k=Me.useMediaQuery({query:"(max-width: 640px)"});return e.jsxs("div",{className:"relative px-3 py-4 mb-8 border-t rounded-lg shadow-md border-base-300 bg-base-200",children:[e.jsxs("div",{className:"flex flex-col gap-5 justify-evenly sm:flex-row sm:items-center",children:[m==="1"&&e.jsx("div",{className:"w-full",children:s.map((n,l)=>e.jsxs("div",{children:[l>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(ra,{singleFlightData:n})]},l))}),m==="2"&&e.jsx("div",{className:"w-full",children:s.map((n,l)=>e.jsxs("div",{className:"flex flex-col gap-8",children:[l>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(ce,{singleFlightData:n})]},l))}),m==="3"&&e.jsx(e.Fragment,{children:k?e.jsx("div",{className:"w-full",children:s.map((n,l)=>e.jsxs("div",{className:"flex flex-col gap-8",children:[l>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(ce,{singleFlightData:n})]},l))}):e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-5 p-1 mb-2 text-sm font-semibold text-center rounded sm:items-center bg-neutral/5 text-neutral",children:[e.jsx("div",{children:"Airline"}),e.jsx("div",{children:"Details"}),e.jsx("div",{children:"Departure"}),e.jsx("div",{children:"Arrival"}),e.jsx("div",{children:"Duration"}),e.jsx("div",{children:"Baggage"})]}),s.map((n,l)=>e.jsxs("div",{className:"flex flex-col gap-4",children:[l>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(la,{singleFlightData:n})]},l))]})}),m==="4"&&e.jsx("div",{className:"w-full",children:s.map((n,l)=>e.jsxs("div",{children:[l>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(Ve,{singleFlightData:n})]},l))}),m==="5"&&e.jsx("div",{className:"w-full space-y-2",children:s.map((n,l)=>e.jsx("div",{children:e.jsx(Le,{singleFlightData:n})},l))}),m==="6"&&e.jsx("div",{className:"w-full space-y-2",children:s.map((n,l)=>e.jsx("div",{children:e.jsx(Oe,{singleFlightData:n})},l))}),e.jsx("div",{className:"flex items-center flex-shrink-0 gap-3 justify-evenly",children:e.jsx("div",{className:"flex gap-2 text-center",children:e.jsx("button",{onClick:D,className:"viewDetailsBtn text-nowrap shadow-sm absolute left-1/2 top-full -translate-x-1/2 bg-white text-xs p-0.5 before:content-[''] before:absolute before:top-0 before:left-[-30px] before:border-r-[30px] before:border-r-white before:border-b-[20px] before:border-b-transparent after:content-[''] after:absolute after:top-0 after:right-[-30px] after:border-l-[30px] after:border-l-white after:border-b-[20px] after:border-b-transparent",children:b?e.jsxs(e.Fragment,{children:["Hide Details ",e.jsx(se,{})]}):e.jsxs(e.Fragment,{children:["View Details ",e.jsx(De,{})]})})})})]}),e.jsx("div",{className:"flex items-center justify-end mt-4",children:(d==null?void 0:d.show_cart_quotes)==="YES"&&e.jsxs("button",{onClick:()=>ee("quotes",a),className:"addToCartBtn normal-case font-normal btn btn-primary btn-outline border-[#ccc] btn-xs",children:["Quotes",e.jsx(Te,{})]})}),e.jsx("div",{ref:S,className:"overflow-hidden duration-500 details",style:{maxHeight:0},children:e.jsxs("div",{className:"px-3 py-3 content",children:[e.jsx("hr",{className:"my-4 border"}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between mb-5",children:[e.jsx(na,{items:["supernsn","administrator"].includes(i)&&u==="YES"?[...t,{id:3,name:"Debug",value:"debug",icon:e.jsx(Ie,{})}]:t,activeTab:p,action:n=>{h(n),setTimeout(()=>{S.current.style.maxHeight=S.current.scrollHeight+"px"},100)}}),e.jsxs("button",{onClick:M,className:"ml-auto text-xs normal-case hideDetailsBtn btn btn-sm rounded-3xl",children:["Hide Details",e.jsx(se,{})]})]}),p==="flight_itinerary"&&["1","4","5","7"].includes(m)&&e.jsx(ia,{flight_group:s}),p==="fare_summary"&&e.jsx(He,{price_breakdown:o}),p==="debug"&&u==="YES"&&e.jsx("div",{className:"p-3 border rounded-lg",children:e.jsx("pre",{children:JSON.stringify(a,null,3)})})]})})]})};ge.propTypes={flight_data:I.object.isRequired};const be=({validation_data:a})=>{const{data:i}=a;return e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx(ge,{flight_data:i}),e.jsx(xe,{flight_data:i}),e.jsx(Ue,{})]})};be.propTypes={validation_data:I.object.isRequired};const fe=({isExpired:a,isChecked:i,hold_possible:d})=>{var V;const f=F.useState(y=>y),{axiosInstance:m}=me(),[t,u]=v.useState(!1),{payment_type:p}=F.useState(),{booking_tracking_id:h,save_pax:s,passenger:o}=U.useState(y=>y),{user_data:{login_key:b,member_id:_,user_access_level:S}={}}=$.useState(),{checkout_url:M}=((V=Y.useState())==null?void 0:V.system_config)||{},E=ca(le),{data:D,isLoading:k,isError:n}=ue({queryKey:["SERVICE_STATUS",b,_],queryFn:async()=>{var y;try{const w=await m.post("/reports/service-status",{login_key:b,member_id:_});return((y=w==null?void 0:w.data)==null?void 0:y.service_status)||null}catch(w){console.error(w)}}}),l=Re(),j=async()=>{var y,w,q,A,P;if(!t)try{if(u(!0),i.terms_conditions===!1)throw new Error("Please accept Terms & Conditions");if(i.cancellation_policy===!1)throw new Error("Please accept Cancellation Policy");const T={booking_tracking_id:h,member_id:_,save_pax:s,passenger:Object.values(o)},C=await m.post("/flight/update-travellers",T);if(((y=C==null?void 0:C.data)==null?void 0:y.status)==="success")try{const x=await m.post("/flight/create-booking",f);if(((w=x==null?void 0:x.data)==null?void 0:w.status)==="success")if((A=(q=x==null?void 0:x.data)==null?void 0:q.general)!=null&&A.tracking_id)l(`/booking-details/flight?tracking_id=${x.data.general.tracking_id}`,{replace:!0}),ae("success","Booking Successful",C.data.reason),U.replace(U._getInitialState()),F.replace(F._getInitialState()),re.replace(re._getInitialState());else{const{payment_option:B,pay_tracking_id:L}=x.data;E.fire({html:e.jsx(ea,{payment_options:B,pay_tracking_id:L,checkout_url:M}),showCancelButton:!1,showConfirmButton:!1,allowOutsideClick:!1,customClass:{htmlContainer:"!m-0",popup:"w-full max-w-3xl !p-0 overflow-hidden"}})}else throw S==="supernsn"?new Error(x.data.reason+`
`+((P=x.data)==null?void 0:P.reason_admin)):new Error(x.data.reason)}catch(x){(await le.fire({title:"Booking Failed!",html:x.message,icon:"error",showCancelButton:!1,showCloseButton:!1,confirmButtonColor:"hsl(var(--p)/1)",confirmButtonText:"Go Back",allowOutsideClick:!1})).isConfirmed&&l(-1,{replace:!0})}else throw new Error(C==null?void 0:C.data.reason)}catch(T){console.error(T),ae("error","Failed!",T.message)}finally{u(!1)}};if(k||n)return e.jsxs("button",{className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",children:[e.jsx(X,{className:"mr-2 animate-spin"})," Loading..."]});const{block_status:c,flight_block:Q,reason:R}=D;return c==="yes"&&Q==="yes"?e.jsx("div",{className:"p-3 text-sm border rounded-lg border-error bg-error/10",children:e.jsx("p",{className:"text-error",dangerouslySetInnerHTML:{__html:R}})}):p?e.jsx(e.Fragment,{children:p==="account_balance"?e.jsx("button",{onClick:j,className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",disabled:a,children:t?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"mr-2 animate-spin"})," Loading..."]}):d==="yes"?"Hold Flight":"Instant Purchase"}):e.jsx("button",{onClick:j,disabled:a,className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",children:t?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"mr-2 animate-spin"})," Loading..."]}):"Pay and Reserve"})}):e.jsx("div",{className:"p-3 text-sm border rounded-lg border-error bg-error/10",children:e.jsx("p",{className:"text-error",children:"You don't have enough balance."})})};fe.propTypes={isExpired:I.bool,isChecked:I.object,hold_possible:I.string};const je=({validation_data:a})=>{var q,A,P,T,C,x,B,L,G,W,J;const{price_change:i,search_price:d,validation_price:f,session_expire:m,data:{sell:t,hold_possible:u,pax_options:p},terms:h,cancellation_terms:s,booking_tracking_id:o}=a,{terms_selection:b,cancellation_selection:_}=p||{},[S,M]=v.useState(!1),[E,D]=v.useState(!1),{payment_type:k}=F.useState(),{user_data:n}=$.useState(),[l,j]=v.useState({terms_conditions:!1,cancellation_policy:!1}),[c,Q]=v.useState(!1),{price_view:{online_payment_option:R,show_flight_fare_rules:V,show_sell_price:y}={}}=Y.useState();v.useEffect(()=>{var g;((g=t==null?void 0:t.total)==null?void 0:g.amount)>(n==null?void 0:n.balance)&&u==="no"&&(R==="ACTIVE"?F.update(r=>{r.payment_type="onlinepayment"}):F.update(r=>{r.payment_type=null}))},[(q=t==null?void 0:t.total)==null?void 0:q.amount,n==null?void 0:n.balance,u,R]),v.useEffect(()=>{j({terms_conditions:b==="check"||b==="hide",cancellation_policy:_==="check"||_==="hide"})},[b,_]);const w=g=>{var r;((r=t==null?void 0:t.total)==null?void 0:r.amount)>(n==null?void 0:n.balance)&&u==="no"?(g.preventDefault(),g.target.value==="account_balance"?ae("error","Insufficient Balance","Please add balance to your account"):g.target.click()):F.update(O=>{O.payment_type=g.target.value})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("div",{className:"p-3 mb-3 border-t rounded-lg shadow-md border-base-300 bg-base-200",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-3 text-xs text-center border rounded bg-primary/10 max-sm:hidden",children:[e.jsx("span",{className:"font-medium py-1.5 px-1 bg-base-300",children:"Search Ref:"})," ",e.jsx("input",{type:"text",value:o,readOnly:!0,className:"bg-transparent cursor-pointer focus:outline-none",onClick:g=>{navigator.clipboard.writeText(o),g.target.value="Copied",setTimeout(()=>{g.target.value=o},3e3)}})]}),(y==null?void 0:y.toUpperCase())==="YES"&&e.jsxs("div",{className:"p-3 mb-3 text-sm rounded-lg bg-primary/10",children:[e.jsxs("h6",{className:"mb-2 font-semibold",children:[e.jsx(ne,{className:"mr-1"})," Price: ",i]}),e.jsxs("p",{children:["Updated Price: ",H(f.currency)," ",f.amount]}),e.jsxs("p",{children:["Search Price: ",H(d.currency)," ",d.amount]})]}),V==="YES"&&e.jsxs("div",{className:"p-3 mb-3 text-sm rounded-lg bg-base-300",children:[e.jsxs("h6",{className:"mb-2 font-semibold",children:[e.jsx(ne,{className:"mr-1"})," Fare Rules & Policy"]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("button",{onClick:()=>ee("fare_rules",a),className:"inline-flex text-primary hover:underline",children:"Penalty and Cancellation Information"}),e.jsx("button",{onClick:()=>ee("fare_rules",a),className:"inline-flex text-primary hover:underline",children:"Flight Fare rules"})]})]}),e.jsx(oa,{session_expire:m,action:g=>Q(g)}),e.jsxs("div",{className:"p-3 mb-3 text-sm rounded-lg bg-base-300",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Fare/Pax type"}),e.jsx("p",{className:"font-medium",children:"Amount"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Base Fare"}),e.jsxs("p",{className:"font-medium",children:[H((A=t==null?void 0:t.base_fare)==null?void 0:A.currency)," ",(P=t==null?void 0:t.base_fare)==null?void 0:P.amount]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Tax"}),e.jsxs("p",{className:"font-medium",children:[H((T=t==null?void 0:t.tax)==null?void 0:T.currency)," ",(C=t==null?void 0:t.tax)==null?void 0:C.amount]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Total"}),e.jsxs("p",{className:"font-medium",children:[H((x=t==null?void 0:t.total)==null?void 0:x.currency)," ",(B=t==null?void 0:t.total)==null?void 0:B.amount]})]}),e.jsx("hr",{className:"mb-3 border border-neutral/20"}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Total Fare"}),e.jsx("p",{className:"font-medium",children:"Amount"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("p",{children:"Total Published Fare"}),e.jsxs("p",{className:"font-medium",children:[H((L=t==null?void 0:t.total)==null?void 0:L.currency)," ",(G=t==null?void 0:t.total)==null?void 0:G.amount]})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 mb-3 rounded-lg bg-primary/10 text-primary",children:[e.jsx("p",{children:"Total Payable"}),e.jsxs("p",{className:"font-medium fs-4",children:[H((W=t==null?void 0:t.total)==null?void 0:W.currency)," ",(J=t==null?void 0:t.total)==null?void 0:J.amount]})]}),e.jsxs("div",{className:"grid gap-3 mb-3 sm:grid-flow-col lg:grid-flow-row xl:grid-flow-col payment-selection",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("input",{autoComplete:"off",type:"radio",className:"absolute -translate-y-1/2 radio radio-xs radio-primary left-2 top-1/2 peer",name:"payment",id:"balance",value:"account_balance",defaultChecked:k==="account_balance",onClick:w}),e.jsx("label",{htmlFor:"balance",className:"block px-2 py-4 pl-8 text-nowrap bg-primary/10 peer-checked:bg-primary peer-checked:text-white",children:"Account Balance"})]}),R==="ACTIVE"&&e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("input",{autoComplete:"off",type:"radio",className:"absolute -translate-y-1/2 radio radio-primary radio-xs top-1/2 left-2 peer",name:"payment",id:"card",value:"onlinepayment",defaultChecked:k==="onlinepayment",onClick:w}),e.jsxs("label",{className:"block px-2 py-4 pl-8 bg-primary/10 peer-checked:bg-primary peer-checked:text-white",htmlFor:"card",children:["Card ",e.jsx(qe,{className:"ml-1"})]})]})]}),b!=="hide"&&e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",checked:l.terms_conditions,id:"terms",onChange:g=>j({...l,terms_conditions:g.target.checked})}),e.jsxs("label",{className:"text-sm font-medium form-check-label",htmlFor:"terms",children:["I have read and accept all"," ",e.jsx("button",{onClick:()=>(h==null?void 0:h.status)==="active"&&M(!0),className:"inline text-primary",children:"Terms & Conditions"})]})]}),_!=="hide"&&e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",checked:l.cancellation_policy,id:"policies",onChange:g=>j({...l,cancellation_policy:g.target.checked})}),e.jsxs("label",{className:"text-sm font-medium form-check-label",htmlFor:"policies",children:["I agree and understand the"," ",e.jsx("button",{onClick:()=>(s==null?void 0:s.status)==="active"&&D(!0),className:"inline text-primary",children:"Cancellation Policies"})]})]}),e.jsx(fe,{isExpired:c,isChecked:l,hold_possible:u}),e.jsx(aa,{})]})}),e.jsx(ta,{isActive:S,setIsActive:M,data:h}),e.jsx(sa,{isActive:E,setIsActive:D,data:s})]})};je.propTypes={validation_data:I.object.isRequired};const Aa=()=>{const[a]=Ae(),{site_title:i}=Y.useState(),d=a.get("tracking_id"),{price_view:{show_flight_fare_rules:f}={}}=Y.useState(),{user_data:{member_id:m}}=$.useState(),{axiosInstance:t}=me(),{data:u,isLoading:p,error:h}=ue(["VALIDATION_DATA",d,m],async()=>{var o,b;const s=await t.post("/flight/validation-get-status",{booking_tracking_id:d,member_id:m});if(((o=s.data)==null?void 0:o.status)==="success")return s.data;throw{...s,message:((b=s.data)==null?void 0:b.reason)||"Request failed!"}});if(v.useEffect(()=>{U.update(s=>{s.booking_tracking_id=d}),F.update(s=>{s.booking_tracking_id=d})},[d]),p)return e.jsx(Pe,{});if(h)throw h;return e.jsxs(e.Fragment,{children:[e.jsx(Be,{children:e.jsxs("title",{children:["Flight Checkout",i?" - "+i:""]})}),e.jsxs("main",{className:"container min-h-screen pt-20",children:[e.jsx("h5",{className:"mb-4 text-xl font-medium",children:"Flight Details"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 mb-8 lg:grid-cols-3",children:[e.jsx(be,{validation_data:u}),e.jsx(je,{validation_data:u})]})]}),f==="YES"&&e.jsx(Ye,{})]})};export{Aa as default};
