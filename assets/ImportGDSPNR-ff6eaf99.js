import{m as q,e as d,l as A,o as e,a5 as H,a6 as T,G as Y,U as $}from"./index-9ab0b68e.js";import{a as M,w as O,b as K,cS as L,n as R,d4 as Q,$ as U}from"./App-06a0497c.js";import{B as z}from"./index-71606310.js";import"./navigation-39207fe3.js";import"./navigation-b6f484b8.js";import"./pp-7d36f836.js";import"./InputDate-e728ae3b.js";import"./shortcut-buttons-flatpickr.min-168b93b0.js";import"./SingleSelect-d3a2ddf8.js";import"./PhoneNumberSelect-b9f80022.js";import"./sweetalert2-react-content.es-600c8fd0.js";import"./index.esm-75b9e02c.js";import"./FlightItineraryData-563e73af.js";import"./ActivityLogs-f6f8d642.js";import"./RefundData-05776b5a.js";const de=()=>{var _,I,C,P,D;const{site_title:j,system_config:f}=q.useState(),[c,N]=d.useState(!1),[r,m]=d.useState(null),[G,b]=d.useState(""),[p,y]=d.useState([]),[v,u]=d.useState(null),{member_id:g}=((_=A.useState())==null?void 0:_.user_data)||{},{axiosInstance:w}=M(),{data:n,isLoading:E}=O({queryKey:["GDS_OPTIONS",g],queryFn:async()=>{var a,l,i,t,x,h;const s=await w.post("/secure?pathName=/flight/gds-options",{member_id:g});if(((a=s==null?void 0:s.data)==null?void 0:a.status)==="success")return b((i=(l=s.data.data)==null?void 0:l.at(0))==null?void 0:i.transfer_instruction),y((h=(x=(t=s.data.data)==null?void 0:t.at(0))==null?void 0:x.transfer_airlines_list)==null?void 0:h.split(",")),s.data.data}}),B=K();if((f==null?void 0:f.show_import_gds_pnr)!=="YES")return e.jsx(L,{});if(E)return e.jsx(H,{});const S=async(s="no")=>{var a,l,i;if(!c){u(null),N(!0);try{const t=document.getElementById("import-gds-form"),x=t.supplier_confirmation_id.value,h=t.supplier_partner_code.value;if(await new Promise(o=>{if(s==="no")return o(!0);U.fire({icon:"warning",title:"Are you sure?",text:"You want to import this PNR?",showCancelButton:!0,confirmButtonText:"Yes, import!"}).then(F=>o(F.isConfirmed))})){const o=await w.post("/secure?pathName=/flight/gds-import-pnr",{member_id:g,supplier_confirmation_id:x,supplier_partner_code:h,import_pnr:s});((a=o.data)==null?void 0:a.status)==="success"?s==="yes"?(m(o.data),$("success","Imported Successfully!",((l=o.data)==null?void 0:l.reason)||null),B("/booking-details/flight?tracking_id="+o.data.data.tracking_id)):m(o.data):u((i=o.data)==null?void 0:i.reason)}}catch(t){console.error(t),u(t.message)}finally{N(!1)}}};return e.jsxs("main",{className:"container min-h-screen pt-20",children:[e.jsx(T,{children:e.jsxs("title",{children:["Import GDS PNR",j?" - "+j:""]})}),e.jsxs("form",{onChange:()=>{m(null),u(null)},className:"w-full p-4 pt-2 rounded-md bg-base-200",id:"import-gds-form",onSubmit:s=>s.preventDefault(),children:[e.jsx("h3",{className:"pb-2 text-lg font-semibold",children:"Import GDS PNR"}),e.jsx("hr",{className:"mb-4"}),e.jsxs("div",{className:"grid gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"lg:col-span-3",children:[e.jsxs("div",{className:"grid grid-cols-2 col-span-3 gap-y-4 gap-x-8",children:[e.jsxs("div",{className:"gap-2 form-control",children:[e.jsx("p",{className:"text-sm font-medium text-neutral",children:"Select GDS"}),e.jsx("select",{name:"supplier_partner_code",className:"w-full h-10 text-sm bg-transparent rounded select select-bordered min-h-8 focus:outline-0 focus:border-neutral/30 ",required:!0,onChange:s=>{var a,l,i;b((a=n==null?void 0:n.find(t=>(t==null?void 0:t.supplier_partner_code)===s.target.value))==null?void 0:a.transfer_instruction),y((i=(l=n==null?void 0:n.find(t=>(t==null?void 0:t.supplier_partner_code)===s.target.value))==null?void 0:l.transfer_airlines_list)==null?void 0:i.split(","))},children:n==null?void 0:n.map(s=>e.jsx("option",{value:s==null?void 0:s.supplier_partner_code,children:s==null?void 0:s.title},s==null?void 0:s.supplier_partner_code))})]}),e.jsxs("div",{className:"gap-2 form-control",children:[e.jsx("p",{className:"text-sm font-medium text-neutral",children:"Enter GDS PNR"}),e.jsx("input",{type:"text",name:"supplier_confirmation_id",className:"w-full h-10 text-sm bg-transparent rounded input input-bordered min-h-8 focus:outline-0 focus:border-neutral/30 ",required:!0,placeholder:"GDS PNR"})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 mt-4",children:[(r==null?void 0:r.data)&&!c&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>S("yes"),type:"button",className:`normal-case btn btn-secondary rounded-md shadow shadow-primary/30 min-h-0 h-10 ${c?"pointer-events-none":""}`,children:c?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"mr-2 animate-spin"})," ","Processing..."]}):"Import PNR"}),e.jsx("button",{type:"button",onClick:s=>{m(null),s.target.closest("form").reset()},className:"normal-case btn btn-secondary rounded-md shadow shadow-primary/30 min-h-0 h-10 btn-outline ",children:"Cancel"})]}),e.jsx("button",{type:"button",onClick:()=>S(),className:`normal-case btn btn-primary rounded-md shadow shadow-primary/30 min-h-0 h-10 ${c?"pointer-events-none":""}`,children:c?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"mr-2 animate-spin"})," ","Processing..."]}):"Review"})]})]}),e.jsxs("div",{className:"p-4 space-y-4 border rounded",children:[e.jsxs("div",{className:"gap-2 form-control",children:[e.jsx("h3",{className:"text-sm font-semibold text-info",children:"Instruction Notes"}),e.jsx("p",{className:"text-xs",children:G})]}),(p==null?void 0:p.length)>0&&e.jsxs("div",{className:"gap-2 form-control",children:[e.jsx("h3",{className:"text-sm font-semibold text-info",children:"Airlines"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:p.map((s,a)=>s&&e.jsx("div",{className:"text-xs rounded badge badge-sm badge-secondary",children:s},a))})]})]})]})]}),e.jsxs("div",{className:"relative mt-8",children:[v?e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border rounded-lg border-error bg-error/5 text-error",children:[e.jsx(Q,{className:"text-xl"})," ",e.jsx("span",{children:v})]}):r!=null&&r.data?e.jsx(z,{booking_details:r==null?void 0:r.data,isImportGDSPNR:!0}):null,(r==null?void 0:r.data)&&e.jsxs("div",{className:"absolute right-0 flex items-center h-8 gap-1 py-1 pl-6 pr-3 text-lg font-semibold text-white top-7 bg-secondary bg-gradient-to-r from-secondary-focus to-secondary w-fit",children:[e.jsx("span",{children:"Total Customer Fare:"})," ",e.jsxs("span",{children:[Y((C=(I=r==null?void 0:r.data)==null?void 0:I.price)==null?void 0:C.currency)," ",(D=(P=r==null?void 0:r.data)==null?void 0:P.price)==null?void 0:D.total_amount]}),e.jsx("span",{className:"absolute top-0 left-0 h-0 border-y-[16px] border-x-[16px] border-transparent border-l-white"})]})]})]})};export{de as default};
