import{l as I,m as R,e as y,o as e,a5 as C,a6 as H,I as Y,V as B,U as N}from"./index-310eb18e.js";import{u as L,a as M,b as A,c as V,N as z,e as q,m as K,p as O,q as U,n as G,h as D,F as J}from"./App-a086c8b0.js";import"./autoplay-4ed993c7.js";const Q=()=>{const{isLoading:u,user_data:s}=I.useState(),{site_title:t,intro_video:a,intro_banner:m,system_config:n}=R.useState(),{state:o}=L(),v=(o==null?void 0:o.pathname)||"/",[x,p]=y.useState(!1),{axiosInstance:P}=M(),k=A(),[r,S]=y.useState(!1),[h]=V(),g=h.get("reset_token"),f=h.get("token_expire"),F=async l=>{var b,j,w;if(l.preventDefault(),x||!g||!f)return;p(!0);const i=l.target,_=i.password.value,E=i.cpassword.value;try{const c={reset_token:g,token_expire:f,password:_,cpassword:E},d=await P.post("/user/password-reset-do",c);if(((b=d.data)==null?void 0:b.status)==="success")N("success","Success",(j=d.data)==null?void 0:j.reason),i.reset(),k("/login");else throw new Error(((w=d.data)==null?void 0:w.reason)||"Something went wrong")}catch(c){N("error","Failed!",c.message)}finally{p(!1)}};return u?e.jsx(C,{}):s!=null&&s.login_key?e.jsx(z,{to:v}):e.jsxs("div",{style:{backgroundImage:"linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))",backgroundSize:"cover",backgroundBlendMode:"multiply"},children:[e.jsx(H,{children:e.jsxs("title",{children:["Forgot Password",t?" - "+t:""]})}),a&&e.jsx("video",{id:"background-video",src:a,poster:m,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,children:"Your browser does not support the video tag."}),e.jsxs("main",{className:"grid min-h-screen mx-auto md:grid-cols-2 lg:grid-cols-3 max-w-screen-2xl",children:[e.jsx("div",{className:"lg:col-span-2"}),e.jsxs("div",{className:"relative flex flex-col items-center justify-center min-h-screen px-8 py-4 md:px-12 bg-base-200/70",children:[e.jsxs(q,{to:"/login",className:"absolute normal-case rounded-full btn btn-ghost btn-sm top-4 left-2 hover:bg-primary/10",children:[e.jsx(K,{})," Back to login"]}),e.jsx("p",{className:"mb-8 font-medium text-center text-neutral",children:"Reset Password"}),e.jsxs("form",{onSubmit:F,className:"flex flex-col w-full gap-y-4",children:[e.jsxs("div",{className:"flex-1 rounded-full join bg-[#E9E7FF] relative",children:[e.jsx("input",{autoComplete:"off",type:r?"text":"password",name:"password","data-type":"password",className:"flex-1 h-10 pl-10 text-sm bg-transparent rounded input focus:outline-0 min-h-8 join-item",placeholder:"New Password"}),e.jsx("span",{className:"absolute inline-flex items-center h-full text-lg left-4 text-primary",children:e.jsx(Y,{path:B,size:.8})}),e.jsx("button",{onClick:()=>S(!r),type:"button",className:"h-10 btn join-item min-h-8 bg-[#E9E7FF] border-[#dddaf5] hover:bg-[#dddaf5]",children:r?e.jsx(O,{}):e.jsx(U,{})})]}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("input",{autoComplete:"off",type:r?"text":"password",name:"cpassword","data-type":"password",className:"flex-1 h-10 pl-10 text-sm rounded-full input bg-[#E9E7FF] focus:outline-0 min-h-8",placeholder:"Retype New Password"}),e.jsx("span",{className:"absolute inline-flex items-center text-lg left-4 text-primary",children:e.jsx(Y,{path:B,size:.8})})]}),e.jsx("button",{type:"submit",className:"normal-case rounded-full btn btn-primary",children:x?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"animate-spin"})," Processing..."]}):"Reset password"})]}),e.jsxs("div",{className:"mt-8 text-sm text-center text-neutral/70",children:["© Copyright ",new Date().getFullYear()," © ",n==null?void 0:n.copyright]})]})]})]})},T=()=>{const{isLoading:u,user_data:s}=I.useState(),{site_title:t,intro_video:a,intro_banner:m,logo:n}=R.useState(),{state:o}=L(),v=(o==null?void 0:o.pathname)||"/",[x,p]=y.useState(!1),{axiosInstance:P}=M(),k=A(),[r,S]=y.useState(!1),[h]=V(),g=h.get("reset_token"),f=h.get("token_expire"),F=async l=>{var b,j,w;if(l.preventDefault(),x||!g||!f)return;p(!0);const i=l.target,_=i.password.value,E=i.cpassword.value;try{const c={reset_token:g,token_expire:f,password:_,cpassword:E},d=await P.post("/user/password-reset-do",c);if(((b=d.data)==null?void 0:b.status)==="success")N("success","Success",(j=d.data)==null?void 0:j.reason),i.reset(),k("/login");else throw new Error(((w=d.data)==null?void 0:w.reason)||"Something went wrong")}catch(c){N("error","Failed!",c.message)}finally{p(!1)}};return u?e.jsx(C,{}):s!=null&&s.login_key?e.jsx(z,{to:v}):e.jsxs("div",{style:{backgroundImage:"linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))",backgroundSize:"cover",backgroundBlendMode:"multiply"},children:[e.jsx(H,{children:e.jsxs("title",{children:["Forgot Password",t?" - "+t:""]})}),a&&e.jsx("video",{id:"background-video",src:a,poster:m,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,children:"Your browser does not support the video tag."}),e.jsx("main",{className:"flex items-center justify-center min-h-screen gap-4 px-5",children:e.jsx("div",{className:"w-full max-w-lg",children:e.jsxs("div",{className:"relative w-full p-8 mb-4 shadow-lg rounded-2xl bg-base-200",children:[e.jsx("div",{className:"absolute top-0 z-10 flex items-center justify-center p-1 mb-2 overflow-hidden -translate-x-1/2 -translate-y-1/2 border rounded-lg h-14 border-neutral/10 left-1/2 bg-base-200",children:e.jsx("img",{src:n,alt:"logo",className:"object-cover object-center w-full h-full"})}),e.jsx("div",{className:"flex flex-col items-center pt-4 mt-2 mb-3",children:e.jsxs("h1",{className:"text-xl font-semibold",children:["Let's Get Started ",t]})}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-8 text-sm text-center text-neutral/80",children:"Reset Your Password"}),e.jsxs("form",{onSubmit:F,className:"flex flex-col w-full gap-y-4",children:[e.jsxs("label",{className:"gap-2 form-control",children:[e.jsx("span",{className:"text-[13px] text-neutral",children:"Password"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("input",{autoComplete:"off",type:r?"text":"password",name:"password","data-type":"password",className:"flex-1 h-10 pr-10 text-sm border rounded-full input input-bordered border-base-content/10 bg-base-200 focus:outline-0 min-h-8 focus:border-primary",placeholder:"Enter New Password"}),e.jsx("span",{className:"absolute flex items-center justify-center w-8 h-8 text-lg rounded-full right-1.5 bg-base-100 text-neutral",children:e.jsx(D,{})})]})]}),e.jsxs("label",{className:"gap-2 form-control",children:[e.jsx("span",{className:"text-[13px] text-neutral",children:"Confirm Password"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("input",{autoComplete:"off",type:r?"text":"password",name:"cpassword","data-type":"password",className:"flex-1 h-10 pr-10 text-sm border rounded-full input input-bordered border-base-content/10 bg-base-200 focus:outline-0 min-h-8 focus:border-primary",placeholder:"Re-enter New Password"}),e.jsx("span",{className:"absolute flex items-center justify-center w-8 h-8 text-lg rounded-full right-1.5 bg-base-100 text-neutral",children:e.jsx(D,{})})]})]}),e.jsx("div",{className:"flex justify-between mt-2",children:e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer text-neutral",children:[e.jsx("input",{type:"checkbox",className:"toggle toggle-xs border-neutral bg-neutral",checked:r,onChange:l=>S(l.target.checked)}),e.jsx("span",{children:"Show Password"})]})}),e.jsx("button",{type:"submit",className:"h-10 min-h-0 font-normal normal-case transition-all duration-300 rounded-full shadow-lg btn btn-primary shadow-primary/50 hover:shadow-none",children:x?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"animate-spin"})," Processing..."]}):e.jsxs(e.Fragment,{children:["Reset ",e.jsx(J,{})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-3",children:[e.jsx("span",{className:"text-neutral",children:"Remember It?"}),e.jsx(q,{to:"/login",className:"text-sm text-primary",children:"Sign in here"})]})]})]})]})})})]})},$=()=>{const{isLoading:u,user_data:s}=I.useState(),{general:t}=R.useState(n=>n.component_version)||{},{state:a}=L(),m=(a==null?void 0:a.pathname)||"/";return u?e.jsx(C,{}):s!=null&&s.login_key?e.jsx(z,{to:m}):(t==null?void 0:t.login)==="2"?e.jsx(T,{}):e.jsx(Q,{})};export{$ as default};
