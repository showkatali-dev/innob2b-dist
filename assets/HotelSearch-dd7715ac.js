import{e as S,aI as T,q as t,o as Y,aJ as xe,m as Qe,Z as re,T as ye,aK as ae,a2 as q,H as Ie,ab as Le,P as ie,a5 as Xe,aL as et}from"./index-dadb706a.js";import{aT as tt,P as ee,n as fe,o as ge,c as P,a3 as Pe,aU as Te,aV as Fe,aW as st,aX as rt,aY as De,aZ as at,a_ as He,a$ as $e,b0 as it,b1 as nt,b2 as ot,b3 as lt,b4 as ct,b5 as dt,L as Be,b6 as ht,r as je,d as mt,e as ut,p as pt,as as xt,at as ft,b7 as gt,av as jt,b as bt}from"./App-f576335e.js";import{F as he,S as ve,a as _t}from"./SearchboxSkeleton-03de169e.js";import{c as be,b as Ze,d as wt}from"./index.esm-8238d674.js";import{R as Ne}from"./RangeSliderInput-8a2fbb7b.js";import{C as oe}from"./Checkbox-bb737c36.js";import{A as yt,P as vt,I as Nt,u as kt,a as St,M as Mt}from"./index.modern-8b539dce.js";import{$ as ke}from"./index-d9efa1bc.js";import{c as Ct,d as Ot,B as Et,e as At,S as It,O as Lt,f as Pt,g as Tt,R as Ft,H as Dt,a as Ht,G as $t,b as Bt}from"./BreakfastOptionSelection-c1e05e70.js";import{a as Zt,P as Ue,S as Ut}from"./SuppliersSelection2-fc375399.js";import{S as Rt,O as Yt}from"./StayDurationAtHotel-6cd29410.js";import{D as zt,a as Gt,b as Vt}from"./drawer-998e10e2.js";import"./SingleSelect-261b8859.js";import"./CountryWithCodeSelect-d44f80a5.js";import"./PrimaryTabsWithIcon-74f1f0ce.js";import"./index-fbf9101c.js";const qt=()=>{const o=S.useRef(),e=S.useCallback(r=>{o.current=setTimeout(async()=>{clearTimeout(o.current),await T.update(a=>{a.property_name=r})},500)},[]),s=S.useCallback(r=>{const a=r.target.value;e(a)},[e]);return t.jsx("div",{className:"px-5",children:t.jsxs("div",{className:"relative mb-5",children:[t.jsx("input",{autoComplete:"off",type:"text",name:"search",onKeyUp:s,className:"w-full h-10 min-h-0 text-sm bg-transparent rounded-lg pl-9 input input-bordered focus:outline-0 focus:border-primary border-neutral/20",placeholder:"Search by property name"}),t.jsx("span",{className:"absolute -translate-y-1/2 top-1/2 left-3",children:t.jsx(tt,{className:"text-lg"})})]})})},me=({filterData:o,result_count:e=0,occupancies:s,total_night:r,search_duration_seconds:a,isShow:i=!0})=>{var z,G;const{component_version:l}=Y.useState(),{hotel:d}=((z=Y.useState())==null?void 0:z.component_version)||{},[n,c]=S.useState(!0),[u]=fe(),h=ge(),{price:p,facilities:f,property_type:w,rating:y,distance:g}=T.useState(),v=o.min_price,m=o.max_price,k=o.min_distance,L=o.max_distance;if(S.useEffect(()=>{const{min_price:b,max_price:N,rating:I,property_type:O,facilities:x,min_distance:_,max_distance:j}=o;T.update(M=>{M.price={min_price:b,max_price:N},M.distance={min_distance:_,max_distance:j},I&&I.forEach(E=>{M.rating[E]=!1}),O&&O.forEach(E=>{E&&(M.property_type[E]=!1)}),x&&x.forEach(E=>{E&&(M.facilities[E]=!1)})}),c(!1)},[o]),!i)return;if(n)return t.jsx(he,{});const D=(s==null?void 0:s.reduce((b,N)=>b+Number(N==null?void 0:N.adult)+Number(N==null?void 0:N.child),0))||0,H=u.get("tracking_id"),C=()=>{h(`/hotel/search?tracking_id=${H}&show_favorite=1`)},Z=()=>{h(`/hotel/search?tracking_id=${H}`)},$=u.get("show_favorite"),A=(G=l==null?void 0:l.hotel)==null?void 0:G.search_result;return t.jsx("aside",{className:"z-30 max-w-xs overflow-auto duration-500 filter-section lg:translate-x-0 lg:max-w-full max-lg:top-0 max-lg:left-0 max-lg:bottom-0 lg:z-0 lg:bg-base-200 lg:bg-transparent lg:sticky lg:top-20 lg:overflow-auto h-fit lg:rounded-lg lg:shadow-md mb-52",children:t.jsxs("div",{className:"py-5 lg:rounded-lg lg:shadow-lg bg-base-200 h-screen lg:max-h-[calc(100vh-80px)] lg:overflow-auto custom-scrollbar",children:[t.jsxs("div",{className:"px-5 mb-5",children:[t.jsxs("div",{className:"border rounded-lg",children:[t.jsx("div",{className:"px-3 py-2 text-sm font-medium text-center border-b bg-base-100",children:"Best Matched Hotels"}),t.jsx("div",{className:"flex items-center justify-center h-16 px-3 text-4xl font-semibold text-primary",children:e}),t.jsxs("div",{className:"px-3 py-2 text-xs text-center border-b bg-base-100 text-neutral",children:[(d==null?void 0:d.search_result)==="2"&&t.jsxs("p",{children:["Search Duration: ",a]}),t.jsxs("p",{children:["for ",r," ",Number(r)>1?"nights":"night"," ","for ",D," ",D>1?"guests":"guest"]})]})]}),A!=="2"&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:$==="1"?Z:C,type:"button",className:P("flex items-center w-full h-10 px-4 mt-3 rounded justify-between",$==="1"?"bg-red-500 text-white":"bg-base-200 border"),children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(be,{className:P("text-xl",$==="1"?"text-white":"text-red-500")})," ","My favorites",t.jsx(Pe,{button:t.jsx("span",{className:"flex items-center justify-center w-4 h-4 p-1 text-xs rounded bg-neutral/5 hover:bg-base-content hover:text-white",children:t.jsx(Te,{})}),children:t.jsx("div",{className:"max-w-[250px] p-2 pb-0 text-sm text-justify",children:"In order to find the hotels your like in the hotel lists faster, mark them with the heart icon."})})]}),$==="1"&&t.jsx(Ze,{})]}),t.jsx("hr",{className:"mb-5"})]})]}),A!=="2"&&t.jsx("div",{className:"px-5 mb-5",children:t.jsxs("div",{className:"relative overflow-hidden rounded",children:[t.jsx("img",{src:"https://media.wired.com/photos/59269cd37034dc5f91bec0f1/191:100/w_1280,c_limit/GoogleMapTA.jpg",className:"object-cover w-full h-36 rounded-2",alt:""}),t.jsx("div",{className:"absolute top-0 left-0 flex items-center justify-center w-full h-full bg-white/10 ",children:t.jsxs("button",{onClick:async()=>{var b;await xe.update(N=>{N.isShow=!0}),(b=document.getElementById("multiple_hotels_map_modal"))==null||b.showModal()},className:"h-10 min-h-0 normal-case rounded shadow-md btn btn-primary shadow-primary/50",children:[t.jsx(Fe,{})," Show on map"]})})]})}),t.jsx("hr",{className:"mb-5"}),t.jsx(qt,{}),t.jsx("hr",{className:"mb-5"}),A!=="2"&&t.jsx("div",{className:"flex items-center justify-between gap-5 px-5 mt-5 mb-5 lg:mt-0",children:t.jsx("h6",{className:P("font-medium",A==="2"&&"text-sm"),children:"Filters"})}),t.jsxs("div",{className:P("px-5 mb-4",A==="2"&&"hotel-v2"),children:[t.jsxs("h6",{className:P("flex items-center gap-1 mb-3 font-medium",A==="2"&&"text-sm"),children:[t.jsx(st,{className:"mr-1"}),"Price Range"," ",t.jsxs("span",{className:"text-sm font-normal text-neutral",children:["(",v," - ",m,")"]})]}),t.jsx(Ne,{min:v,max:m,defaultValue:[v,m],value:[p==null?void 0:p.min_price,p==null?void 0:p.max_price],action:b=>T.update(N=>{N.price={min_price:b[0],max_price:b[1]}})})]}),t.jsxs("div",{className:P("px-5",A==="2"&&"hotel-v2"),children:[t.jsxs("h6",{className:P("flex items-center gap-1 mb-3 font-medium",A==="2"&&"text-sm"),children:[t.jsx(rt,{className:"mr-1"}),"Distance"," ",t.jsxs("span",{className:"text-sm font-normal text-neutral",children:["(",k," - ",L,")"]})]}),t.jsx(Ne,{min:k,max:L,defaultValue:[k,L],value:[g==null?void 0:g.min_distance,g==null?void 0:g.max_distance],action:b=>T.update(N=>{N.distance={min_distance:b[0],max_distance:b[1]}})})]}),t.jsx("hr",{className:"mb-5"}),t.jsxs("div",{className:"px-5",children:[t.jsxs("h6",{className:P("flex items-center gap-1 mb-3 font-medium",A==="2"&&"text-sm"),children:[t.jsx(De,{className:"mr-1"}),"Property Type"]}),t.jsx("div",{className:"flex flex-col gap-3 mb-5 text-xs",children:Object.entries(w).map(([b,N])=>b&&t.jsx(oe,{label:b,defaultChecked:N,action:I=>T.update(O=>{O.property_type[b]=I})},b))})]}),t.jsx("hr",{className:"mb-5"}),t.jsxs("div",{className:"px-5",children:[t.jsxs("h6",{className:P("flex items-center gap-1 mb-3 font-medium",A==="2"&&"text-sm"),children:[t.jsx(at,{className:"mr-1"}),"Star Rating"]}),t.jsx("div",{className:"flex flex-col gap-3 mb-5 text-xs",children:Object.entries(y).filter(([b])=>!!b&&b!=="null").map(([b,N])=>t.jsx(oe,{label:t.jsxs(t.Fragment,{children:[Array(Math.floor(b)).fill("").map((I,O)=>t.jsx(He,{className:"text-warning"},O)),parseFloat(b)-Math.floor(b)>0&&t.jsx($e,{className:"text-warning"}),t.jsxs("span",{children:[" (",b," star)"]})]}),defaultChecked:N,action:I=>T.update(O=>{O.rating[b]=I})},b))})]}),t.jsx("hr",{className:"mb-5"}),t.jsxs("div",{className:"px-5",children:[t.jsxs("h6",{className:P("flex items-center gap-1 mb-3 font-medium",A==="2"&&"text-sm"),children:[t.jsx(it,{className:"mr-1"}),"Facilities"]}),t.jsx("div",{className:"flex flex-col gap-3 mb-5 text-xs",children:Object.entries(f).map(([b,N])=>t.jsx(oe,{label:b,defaultChecked:N,action:I=>T.update(O=>{O.facilities[b]=I})},b))})]})]})})};me.propTypes={filterData:ee.object.isRequired,result_count:ee.number};const Jt=()=>{const{sorting:{sortBy:o}}=T.useState();return t.jsxs("ul",{className:"w-full mb-4 overflow-auto text-sm text-center rounded-md shadow-md join bg-base-200 hide_scrollbar whitespace-nowrap",children:[t.jsx("li",{onClick:()=>T.update(e=>{e.sorting.sortBy="recommended"}),className:`px-4 py-3 cursor-pointer join-item flex-1 border-x border-x-primary/10 ${o==="recommended"?"bg-primary text-white":""}`,children:t.jsx("h6",{className:"font-medium",children:"Recommended"})}),t.jsx("li",{onClick:()=>T.update(e=>{e.sorting.sortBy="cheapest"}),className:`px-4 py-3 cursor-pointer join-item flex-1 border-x border-x-primary/10 ${o==="cheapest"?"bg-primary text-white":""}`,children:t.jsxs("h6",{className:"font-medium",children:["Lowest Price ",t.jsx("span",{className:"text-xs font-normal",children:"(Inc. Tax)"})]})}),t.jsx("li",{onClick:()=>T.update(e=>{e.sorting.sortBy="distance"}),className:`px-4 py-3 cursor-pointer join-item flex-1 border-x border-x-primary/10 ${o==="distance"?"bg-primary text-white":""}`,children:t.jsxs("h6",{className:"font-medium",children:["Distance ",t.jsx("span",{className:"text-xs font-normal",children:"(Near to Far)"})]})}),t.jsx("li",{onClick:()=>T.update(e=>{e.sorting.sortBy="rating"}),className:`px-4 py-3 cursor-pointer join-item flex-1 border-x border-x-primary/10 ${o==="rating"?"bg-primary text-white":""}`,children:t.jsxs("h6",{className:"font-medium",children:["Star Rating"," ",t.jsx("span",{className:"text-xs font-normal",children:"(Hight to Low)"})]})})]})},Re=({hotel:o,search_parameter:e})=>{var I,O;const{supplier_option:s}=Y.useState(),{user_data:r}=Qe.useState(),{hotel_name:a,room_title:i,rate_type:l,star_rating:d,currency:n,sell_price:c,distance_km:u,primary_photo:h,address:p,hotel_id:f,total_amount:w,supplier:y,rating_average:g,property_type:v}=o,{supplier_uid:m}=(o==null?void 0:o.supplier)||{},k={hotel_name:a,hotel_image:h,currency:n,sell_price:c,total_amount:w,supplier:y},D=re.useState().some(x=>x.hotel_id===f),{show_supplier_option:H}=s||{},C=()=>{const x=localStorage.getItem("saved_hotels"),_=JSON.parse(x)||[];if(_.some(j=>j.hotel_id===f)===!1){const j={...o};_.unshift(j),localStorage.setItem("saved_hotels",JSON.stringify(_)),re.update(()=>_),ye("success","Success","Added to favorite")}},Z=()=>{const x=localStorage.getItem("saved_hotels"),j=(JSON.parse(x)||[]).filter(M=>M.hotel_id!==f);localStorage.setItem("saved_hotels",JSON.stringify(j)),re.update(()=>j),ye("success","Success","Removed from favorite")},{checkIn:$,checkOut:A,occupancies:z,guest_nationality:G}=e||{},b=JSON.stringify({hotel_id:f,checkIn:$,checkOut:A,occupancies:z,guest_nationality:G}),N=btoa(b);return t.jsx("div",{className:"duration-100 rounded-md shadow-md hover:shadow-lg bg-base-200",children:t.jsxs("div",{className:"grid grid-cols-1 gap-3 p-3 sm:grid-cols-4 bg-base-500",children:[t.jsxs("div",{className:"relative",children:[t.jsx("img",{src:h||"/no_image.jpg",className:"object-cover rounded w-full min-h-full max-h-[180px] h-full min-w-[140px]",alt:""}),D?t.jsx("button",{onClick:Z,className:"rounded-full p-1 bg-red-500 text-white text-xl absolute right-1 top-1 z-[2] min-h-0 w-8 h-8 btn hover:bg-red-600 !border-transparent",children:t.jsx(nt,{})}):t.jsx("button",{onClick:C,className:"rounded-full p-1 text-red-500 text-xl bg-base-200 absolute right-1 top-1 z-[2] min-h-0 w-8 h-8 btn !border-transparent",children:t.jsx(ot,{})})]}),t.jsxs("div",{className:"sm:col-span-3",children:[t.jsxs("div",{className:"flex justify-between items",children:[t.jsxs("div",{className:"flex gap-2 mb-1 w-fit",children:[t.jsxs("div",{className:"flex items-center text-[11px] text-warning",children:[Array(Math.floor(d)).fill("").map((x,_)=>t.jsx(He,{},_)),parseFloat(d)-Math.floor(d)>0&&t.jsx($e,{className:"text-warning"})]}),!!g&&g!=="n/a"&&t.jsxs("span",{className:"block ml-auto text-[11px] text-neutral",children:["(",g," reviews)"]})]}),v&&t.jsxs("div",{className:"rounded-sm bg-secondary/5 text-secondary text-[10px] flex w-fit px-1 items-center justify-center gap-1",children:[t.jsx(De,{})," ",v]})]}),t.jsx("h6",{className:"font-bold text-md line-clamp-1",children:a}),t.jsxs("div",{className:"mb-2",children:[t.jsx("p",{className:"text-[13px] text-neutral line-clamp-1",children:p}),u&&t.jsx("p",{className:"text-xs text-neutral",children:t.jsxs("span",{className:"font-medium",children:[t.jsx(lt,{className:"text-base-content"})," Distance:"," ",u," km"]})})]}),t.jsx("div",{className:"px-3 py-2 rounded bg-base-100",children:t.jsxs("div",{className:"flex flex-col justify-between gap-2 md:gap-4 md:flex-row",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-[15px]",children:i}),t.jsx("p",{className:"mb-1 text-xs capitalize text-neutral",children:l==null?void 0:l.toLowerCase()}),t.jsx(ct,{hotel:o})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("div",{className:"flex flex-wrap items-center mb-1 gap-x-4 gap-y-1 max-sm:justify-between",children:[t.jsx(dt,{price_data:k}),["supernsn","administrator"].includes(r==null?void 0:r.user_access_level)&&H==="YES"&&t.jsx("div",{className:"text-[10px] bg-neutral/5 text-neutral rounded py-[1px] px-1",children:(O=(I=s==null?void 0:s.data)==null?void 0:I.find(x=>(x==null?void 0:x.supplier_uid)===m))==null?void 0:O.title})]}),t.jsx(Be,{to:`/hotel/details?q=${N}`,target:"_blank",rel:"noreferrer",className:"h-10 min-h-0 font-normal tracking-wide normal-case rounded-md btn btn-primary",children:"View All Rooms"})]})]})})]})]})})};Re.propTypes={hotel:ee.object.isRequired};const Wt=({search_parameter:o})=>{var n;const[e,s]=S.useState(10),{filteredData:r}=ae.useState(),[a,i]=S.useState([]),{component_version:l}=Y.useState();S.useEffect(()=>{i(r.slice(0,e))},[r,e]),S.useEffect(()=>{const c=()=>{window.innerHeight+window.scrollY>=document.body.offsetHeight-100&&s(u=>u+10)};return window.addEventListener("scroll",c),()=>window.removeEventListener("scroll",c)},[]);const d=(n=l==null?void 0:l.hotel)==null?void 0:n.search_result;return t.jsx("section",{className:"flex flex-col flex-1 gap-4 mb-52",children:a==null?void 0:a.map(c=>d==="2"?t.jsx(ht,{hotel:c,search_parameter:o},c.hotel_id):t.jsx(Re,{hotel:c,search_parameter:o},c.hotel_id))})},Se=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],le=1,K=8;class _e{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,r]=new Uint8Array(e,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const a=r>>4;if(a!==le)throw new Error(`Got v${a} data when expected v${le}.`);const i=Se[r&15];if(!i)throw new Error("Unrecognized array type.");const[l]=new Uint16Array(e,2,1),[d]=new Uint32Array(e,4,1);return new _e(d,l,i,e)}constructor(e,s=64,r=Float64Array,a){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const i=Se.indexOf(this.ArrayType),l=e*2*this.ArrayType.BYTES_PER_ELEMENT,d=e*this.IndexArrayType.BYTES_PER_ELEMENT,n=(8-d%8)%8;if(i<0)throw new Error(`Unexpected typed array class: ${r}.`);a&&a instanceof ArrayBuffer?(this.data=a,this.ids=new this.IndexArrayType(this.data,K,e),this.coords=new this.ArrayType(this.data,K+d+n,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(K+l+d+n),this.ids=new this.IndexArrayType(this.data,K,e),this.coords=new this.ArrayType(this.data,K+d+n,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(le<<4)+i]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=e)}add(e,s){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=s,r}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return ue(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,s,r,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:l,nodeSize:d}=this,n=[0,i.length-1,0],c=[];for(;n.length;){const u=n.pop()||0,h=n.pop()||0,p=n.pop()||0;if(h-p<=d){for(let g=p;g<=h;g++){const v=l[2*g],m=l[2*g+1];v>=e&&v<=r&&m>=s&&m<=a&&c.push(i[g])}continue}const f=p+h>>1,w=l[2*f],y=l[2*f+1];w>=e&&w<=r&&y>=s&&y<=a&&c.push(i[f]),(u===0?e<=w:s<=y)&&(n.push(p),n.push(f-1),n.push(1-u)),(u===0?r>=w:a>=y)&&(n.push(f+1),n.push(h),n.push(1-u))}return c}within(e,s,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:a,coords:i,nodeSize:l}=this,d=[0,a.length-1,0],n=[],c=r*r;for(;d.length;){const u=d.pop()||0,h=d.pop()||0,p=d.pop()||0;if(h-p<=l){for(let g=p;g<=h;g++)Me(i[2*g],i[2*g+1],e,s)<=c&&n.push(a[g]);continue}const f=p+h>>1,w=i[2*f],y=i[2*f+1];Me(w,y,e,s)<=c&&n.push(a[f]),(u===0?e-r<=w:s-r<=y)&&(d.push(p),d.push(f-1),d.push(1-u)),(u===0?e+r>=w:s+r>=y)&&(d.push(f+1),d.push(h),d.push(1-u))}return n}}function ue(o,e,s,r,a,i){if(a-r<=s)return;const l=r+a>>1;Ye(o,e,l,r,a,i),ue(o,e,s,r,l-1,1-i),ue(o,e,s,l+1,a,1-i)}function Ye(o,e,s,r,a,i){for(;a>r;){if(a-r>600){const c=a-r+1,u=s-r+1,h=Math.log(c),p=.5*Math.exp(2*h/3),f=.5*Math.sqrt(h*p*(c-p)/c)*(u-c/2<0?-1:1),w=Math.max(r,Math.floor(s-u*p/c+f)),y=Math.min(a,Math.floor(s+(c-u)*p/c+f));Ye(o,e,s,w,y,i)}const l=e[2*s+i];let d=r,n=a;for(Q(o,e,r,s),e[2*a+i]>l&&Q(o,e,r,a);d<n;){for(Q(o,e,d,n),d++,n--;e[2*d+i]<l;)d++;for(;e[2*n+i]>l;)n--}e[2*r+i]===l?Q(o,e,r,n):(n++,Q(o,e,n,a)),n<=s&&(r=n+1),s<=n&&(a=n-1)}}function Q(o,e,s,r){ce(o,s,r),ce(e,2*s,2*r),ce(e,2*s+1,2*r+1)}function ce(o,e,s){const r=o[e];o[e]=o[s],o[s]=r}function Me(o,e,s,r){const a=o-s,i=e-r;return a*a+i*i}const Kt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:o=>o},Ce=Math.fround||(o=>e=>(o[0]=+e,o[0]))(new Float32Array(1)),V=2,R=3,de=4,U=5,ze=6;class Qt{constructor(e){this.options=Object.assign(Object.create(Kt),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:s,minZoom:r,maxZoom:a}=this.options;s&&console.time("total time");const i=`prepare ${e.length} points`;s&&console.time(i),this.points=e;const l=[];for(let n=0;n<e.length;n++){const c=e[n];if(!c.geometry)continue;const[u,h]=c.geometry.coordinates,p=Ce(te(u)),f=Ce(se(h));l.push(p,f,1/0,n,-1,1),this.options.reduce&&l.push(0)}let d=this.trees[a+1]=this._createTree(l);s&&console.timeEnd(i);for(let n=a;n>=r;n--){const c=+Date.now();d=this.trees[n]=this._createTree(this._cluster(d,n)),s&&console.log("z%d: %d clusters in %dms",n,d.numItems,+Date.now()-c)}return s&&console.timeEnd("total time"),this}getClusters(e,s){let r=((e[0]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,e[1]));let i=e[2]===180?180:((e[2]+180)%360+360)%360-180;const l=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,i=180;else if(r>i){const h=this.getClusters([r,a,180,l],s),p=this.getClusters([-180,a,i,l],s);return h.concat(p)}const d=this.trees[this._limitZoom(s)],n=d.range(te(r),se(l),te(i),se(a)),c=d.data,u=[];for(const h of n){const p=this.stride*h;u.push(c[p+U]>1?Oe(c,p,this.clusterProps):this.points[c[p+R]])}return u}getChildren(e){const s=this._getOriginId(e),r=this._getOriginZoom(e),a="No cluster with the specified id.",i=this.trees[r];if(!i)throw new Error(a);const l=i.data;if(s*this.stride>=l.length)throw new Error(a);const d=this.options.radius/(this.options.extent*Math.pow(2,r-1)),n=l[s*this.stride],c=l[s*this.stride+1],u=i.within(n,c,d),h=[];for(const p of u){const f=p*this.stride;l[f+de]===e&&h.push(l[f+U]>1?Oe(l,f,this.clusterProps):this.points[l[f+R]])}if(h.length===0)throw new Error(a);return h}getLeaves(e,s,r){s=s||10,r=r||0;const a=[];return this._appendLeaves(a,e,s,r,0),a}getTile(e,s,r){const a=this.trees[this._limitZoom(e)],i=Math.pow(2,e),{extent:l,radius:d}=this.options,n=d/l,c=(r-n)/i,u=(r+1+n)/i,h={features:[]};return this._addTileFeatures(a.range((s-n)/i,c,(s+1+n)/i,u),a.data,s,r,i,h),s===0&&this._addTileFeatures(a.range(1-n/i,c,1,u),a.data,i,r,i,h),s===i-1&&this._addTileFeatures(a.range(0,c,n/i,u),a.data,-1,r,i,h),h.features.length?h:null}getClusterExpansionZoom(e){let s=this._getOriginZoom(e)-1;for(;s<=this.options.maxZoom;){const r=this.getChildren(e);if(s++,r.length!==1)break;e=r[0].properties.cluster_id}return s}_appendLeaves(e,s,r,a,i){const l=this.getChildren(s);for(const d of l){const n=d.properties;if(n&&n.cluster?i+n.point_count<=a?i+=n.point_count:i=this._appendLeaves(e,n.cluster_id,r,a,i):i<a?i++:e.push(d),e.length===r)break}return i}_createTree(e){const s=new _e(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let r=0;r<e.length;r+=this.stride)s.add(e[r],e[r+1]);return s.finish(),s.data=e,s}_addTileFeatures(e,s,r,a,i,l){for(const d of e){const n=d*this.stride,c=s[n+U]>1;let u,h,p;if(c)u=Ge(s,n,this.clusterProps),h=s[n],p=s[n+1];else{const y=this.points[s[n+R]];u=y.properties;const[g,v]=y.geometry.coordinates;h=te(g),p=se(v)}const f={type:1,geometry:[[Math.round(this.options.extent*(h*i-r)),Math.round(this.options.extent*(p*i-a))]],tags:u};let w;c||this.options.generateId?w=s[n+R]:w=this.points[s[n+R]].id,w!==void 0&&(f.id=w),l.features.push(f)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,s){const{radius:r,extent:a,reduce:i,minPoints:l}=this.options,d=r/(a*Math.pow(2,s)),n=e.data,c=[],u=this.stride;for(let h=0;h<n.length;h+=u){if(n[h+V]<=s)continue;n[h+V]=s;const p=n[h],f=n[h+1],w=e.within(n[h],n[h+1],d),y=n[h+U];let g=y;for(const v of w){const m=v*u;n[m+V]>s&&(g+=n[m+U])}if(g>y&&g>=l){let v=p*y,m=f*y,k,L=-1;const D=((h/u|0)<<5)+(s+1)+this.points.length;for(const H of w){const C=H*u;if(n[C+V]<=s)continue;n[C+V]=s;const Z=n[C+U];v+=n[C]*Z,m+=n[C+1]*Z,n[C+de]=D,i&&(k||(k=this._map(n,h,!0),L=this.clusterProps.length,this.clusterProps.push(k)),i(k,this._map(n,C)))}n[h+de]=D,c.push(v/g,m/g,1/0,D,-1,g),i&&c.push(L)}else{for(let v=0;v<u;v++)c.push(n[h+v]);if(g>1)for(const v of w){const m=v*u;if(!(n[m+V]<=s)){n[m+V]=s;for(let k=0;k<u;k++)c.push(n[m+k])}}}}return c}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,s,r){if(e[s+U]>1){const l=this.clusterProps[e[s+ze]];return r?Object.assign({},l):l}const a=this.points[e[s+R]].properties,i=this.options.map(a);return r&&i===a?Object.assign({},i):i}}function Oe(o,e,s){return{type:"Feature",id:o[e+R],properties:Ge(o,e,s),geometry:{type:"Point",coordinates:[Xt(o[e]),es(o[e+1])]}}}function Ge(o,e,s){const r=o[e+U],a=r>=1e4?`${Math.round(r/1e3)}k`:r>=1e3?`${Math.round(r/100)/10}k`:r,i=o[e+ze],l=i===-1?{}:Object.assign({},s[i]);return Object.assign(l,{cluster:!0,cluster_id:o[e+R],point_count:r,point_count_abbreviated:a})}function te(o){return o/360+.5}function se(o){const e=Math.sin(o*Math.PI/180),s=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return s<0?0:s>1?1:s}function Xt(o){return(o-.5)*360}function es(o){const e=(180-o*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function ts(o,e){var s={};for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&e.indexOf(r)<0&&(s[r]=o[r]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(o);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(o,r[a])&&(s[r[a]]=o[r[a]]);return s}class F{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,s){this.isAdvancedMarker(e)?e.map=s:e.setMap(s)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class pe{constructor({markers:e,position:s}){this.markers=e,s&&(s instanceof google.maps.LatLng?this._position=s:this._position=new google.maps.LatLng(s))}get bounds(){if(this.markers.length===0&&!this._position)return;const e=new google.maps.LatLngBounds(this._position,this._position);for(const s of this.markers)e.extend(F.getPosition(s));return e}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>F.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(F.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class ss{constructor({maxZoom:e=16}){this.maxZoom=e}noop({markers:e}){return rs(e)}}const rs=o=>o.map(s=>new pe({position:F.getPosition(s),markers:[s]}));class as extends ss{constructor(e){var{maxZoom:s,radius:r=60}=e,a=ts(e,["maxZoom","radius"]);super({maxZoom:s}),this.state={zoom:-1},this.superCluster=new Qt(Object.assign({maxZoom:this.maxZoom,radius:r},a))}calculate(e){let s=!1;const r={zoom:e.map.getZoom()};if(!ke(e.markers,this.markers)){s=!0,this.markers=[...e.markers];const a=this.markers.map(i=>{const l=F.getPosition(i);return{type:"Feature",geometry:{type:"Point",coordinates:[l.lng(),l.lat()]},properties:{marker:i}}});this.superCluster.load(a)}return s||(this.state.zoom<=this.maxZoom||r.zoom<=this.maxZoom)&&(s=!ke(this.state,r)),this.state=r,s&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:s}}cluster({map:e}){return this.superCluster.getClusters([-180,-90,180,90],Math.round(e.getZoom())).map(s=>this.transformCluster(s))}transformCluster({geometry:{coordinates:[e,s]},properties:r}){if(r.cluster)return new pe({markers:this.superCluster.getLeaves(r.cluster_id,1/0).map(i=>i.properties.marker),position:{lat:s,lng:e}});const a=r.marker;return new pe({markers:[a],position:F.getPosition(a)})}}class is{constructor(e,s){this.markers={sum:e.length};const r=s.map(i=>i.count),a=r.reduce((i,l)=>i+l,0);this.clusters={count:s.length,markers:{mean:a/s.length,sum:a,min:Math.min(...r),max:Math.max(...r)}}}}class ns{render({count:e,position:s},r,a){const l=`<svg fill="${e>Math.max(10,r.clusters.markers.mean)?"#ff0000":"#0000ff"}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">${e}</text>
</svg>`,d=`Cluster of ${e} markers`,n=Number(google.maps.Marker.MAX_ZINDEX)+e;if(F.isAdvancedMarkerAvailable(a)){const h=new DOMParser().parseFromString(l,"image/svg+xml").documentElement;h.setAttribute("transform","translate(0 25)");const p={map:a,position:s,zIndex:n,title:d,content:h};return new google.maps.marker.AdvancedMarkerElement(p)}const c={position:s,zIndex:n,title:d,icon:{url:`data:image/svg+xml;base64,${btoa(l)}`,anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(c)}}function os(o,e){for(let s in e.prototype)o.prototype[s]=e.prototype[s]}class we{constructor(){os(we,google.maps.OverlayView)}}var X;(function(o){o.CLUSTERING_BEGIN="clusteringbegin",o.CLUSTERING_END="clusteringend",o.CLUSTER_CLICK="click"})(X||(X={}));const ls=(o,e,s)=>{s.fitBounds(e.bounds)};class cs extends we{constructor({map:e,markers:s=[],algorithmOptions:r={},algorithm:a=new as(r),renderer:i=new ns,onClusterClick:l=ls}){super(),this.markers=[...s],this.clusters=[],this.algorithm=a,this.renderer=i,this.onClusterClick=l,e&&this.setMap(e)}addMarker(e,s){this.markers.includes(e)||(this.markers.push(e),s||this.render())}addMarkers(e,s){e.forEach(r=>{this.addMarker(r,!0)}),s||this.render()}removeMarker(e,s){const r=this.markers.indexOf(e);return r===-1?!1:(F.setMap(e,null),this.markers.splice(r,1),s||this.render(),!0)}removeMarkers(e,s){let r=!1;return e.forEach(a=>{r=this.removeMarker(a,!0)||r}),r&&!s&&this.render(),r}clearMarkers(e){this.markers.length=0,e||this.render()}render(){const e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,X.CLUSTERING_BEGIN,this);const{clusters:s,changed:r}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(r||r==null){const a=new Set;for(const l of s)l.markers.length==1&&a.add(l.markers[0]);const i=[];for(const l of this.clusters)l.marker!=null&&(l.markers.length==1?a.has(l.marker)||F.setMap(l.marker,null):i.push(l.marker));this.clusters=s,this.renderClusters(),requestAnimationFrame(()=>i.forEach(l=>F.setMap(l,null)))}google.maps.event.trigger(this,X.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>F.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){const e=new is(this.markers,this.clusters),s=this.getMap();this.clusters.forEach(r=>{r.markers.length===1?r.marker=r.markers[0]:(r.marker=this.renderer.render(r,e,s),r.markers.forEach(a=>F.setMap(a,null)),this.onClusterClick&&r.marker.addListener("click",a=>{google.maps.event.trigger(this,X.CLUSTER_CLICK,r),this.onClusterClick(a,r,s)})),F.setMap(r.marker,s)})}}const Ve=({hotel_info:o,position:e,setMarkerRef:s})=>{const{room_pic:r,hotel_name:a,hotel_id:i,currency:l,sell_price:d}=o||{},[n,c]=S.useState(!1),{occupancies:u,checkIn:h,checkOut:p,guest_nationality:f}=q.useState(),[w,y]=S.useState(null),g=S.useCallback(L=>{L!==null&&(y(L),s(L,i))},[s,i]),v=()=>{c(!0)},m=JSON.stringify({hotel_id:i,checkIn:h,checkOut:p,occupancies:u,guest_nationality:f}),k=btoa(m);return t.jsxs(t.Fragment,{children:[t.jsx(yt,{ref:g,onClick:v,position:e,title:a,children:t.jsx(vt,{background:"hsl(var(--p)/1)",borderColor:"hsl(var(--pf)/1)",glyphColor:"hsl(var(--b2)/1)",children:t.jsxs("div",{className:"cursor-pointer",children:[t.jsx("div",{className:"absolute flex w-3 h-3 -translate-x-1/2 rounded-full bg-white/80 left-1/2 top-2"}),t.jsx("div",{className:"flex items-center justify-center px-2 py-1 -mt-8 bg-white rounded shadow-lg text-primary",children:t.jsxs("p",{className:"text-[10px] font-medium whitespace-nowrap flex gap-1",children:[t.jsx("span",{children:Ie(l)})," ",t.jsx("span",{children:d})]})})]})})}),n?t.jsx(Nt,{anchor:w,maxWidth:200,onCloseClick:()=>c(!1),children:t.jsxs(Be,{to:`/hotel/details?q=${k}`,target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("img",{className:"w-8 h-8 rounded-full",src:r,alt:""}),t.jsx("h1",{className:"text-sm font-semibold",children:a})]})}):null]})};Ve.propTypes={hotel_info:ee.object,position:ee.object.isRequired};const ds=({data:o})=>{const e=kt(),[s,r]=S.useState({}),a=S.useRef();S.useEffect(()=>{e&&(a.current||(a.current=new cs({map:e})))},[e]),S.useEffect(()=>{var l,d;(l=a.current)==null||l.clearMarkers(),(d=a.current)==null||d.addMarkers(Object.values(s))},[s]);const i=(l,d)=>{l&&s[d]||!l&&!s[d]||r(n=>{if(l)return{...n,[d]:l};{const c={...n};return delete c[d],c}})};return t.jsx(t.Fragment,{children:o.map(l=>{const{hotel_id:d,hotel_name:n,primary_photo:c,latitude:u,longitude:h,sell_price:p,currency:f}=l||{},w={lat:Number(u),lng:Number(h)};return t.jsx(Ve,{hotel_info:{room_pic:c,hotel_name:n,hotel_id:d,sell_price:p,currency:f},position:w,setMarkerRef:i},d)})})},hs=Le(),ms=()=>{const{system_config:o}=Y.useState(),{filteredData:e}=ae.useState(),{isShow:s}=xe.useState(),r=s?location.hostname==="localhost"?{}.VITE_GM_API_KEY||"":o==null?void 0:o.google_map_key:null;if(!r)return null;const{latitude:a,longitude:i}=(e==null?void 0:e.at(0))||{};return t.jsx(St,{apiKey:r,children:(e==null?void 0:e.length)>0&&t.jsx("dialog",{id:"multiple_hotels_map_modal",className:"modal",children:t.jsxs("div",{className:"max-w-5xl p-4 rounded-md modal-box bg-base-200",children:[t.jsx("div",{children:t.jsx("button",{onClick:()=>{var l;return(l=document.getElementById("multiple_hotels_map_modal"))==null?void 0:l.close()},className:"absolute z-20 btn btn-sm btn-circle btn-ghost right-2 top-2 text-error bg-black/10",children:"âœ•"})}),t.jsx("div",{className:"max-h-[70vh] h-full overflow-auto",children:t.jsx(Mt,{mapId:hs,center:{lat:Number(a),lng:Number(i)},zoom:10,className:"h-[450px] max-h-[95%]",gestureHandling:"greedy",children:t.jsx(ds,{data:e})})})]})})})},Ee=()=>{const{checkIn:o,checkOut:e,location:s}=q.useState(),r=je.useMediaQuery({query:"(max-width: 640px)"}),{partner_option:a}=Y.useState();return t.jsxs("div",{className:"relative z-[9] bg-base-200 px-5 pb-5 pt-4 rounded-2xl shadow-md mb-12 search-box-2",children:[t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-4 text-sm",children:[t.jsx(Ct,{}),t.jsxs("div",{className:"flex flex-wrap items-center gap-5 sm:justify-end",children:[t.jsx(Ot,{}),t.jsx(Et,{}),t.jsx("div",{className:"w-fit min-w-[160px]",children:t.jsx(Zt,{supplier_type:"HOTEL"})}),(a==null?void 0:a.status.toLowerCase())==="yes"&&t.jsx("div",{className:"max-w-full w-fit min-w-[160px]",children:t.jsx(Ue,{supplier_type:"HOTEL"})})]})]}),t.jsxs("div",{className:"grid gap-5 lg:grid-flow-col",children:[t.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-5 one-way-round-trip",children:[t.jsx(At,{label:"Destination",value:s}),t.jsx(It,{label:"Stay Duration",minDate:"today",defaultValue:[o,e],action:i=>q.update(l=>{l.checkIn=ie(new Date(i[0])).format("YYYY-MM-DD"),l.checkOut=ie(new Date(i[1])).format("YYYY-MM-DD")})}),t.jsx(Lt,{storeName:"hotel_search_options"}),t.jsx(Pt,{})]}),t.jsx(Tt,{isStatic:!r})]})]})},Ae=()=>{const{checkIn:o,checkOut:e,location:s}=q.useState(),r=je.useMediaQuery({query:"(max-width: 640px)"}),{partner_option:a}=Y.useState();return t.jsxs("div",{className:"relative z-[9] bg-base-200 px-5 pb-5 pt-4 rounded-2xl shadow-md mb-12 search-box-1",children:[t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-4 text-sm",children:[t.jsx(Ft,{}),t.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-5",children:[t.jsx(Dt,{}),t.jsx("div",{className:"w-fit min-w-[160px]",children:t.jsx(Ut,{supplier_type:"HOTEL"})}),(a==null?void 0:a.status.toLowerCase())==="yes"&&t.jsx("div",{className:"max-w-full w-fit min-w-[160px]",children:t.jsx(Ue,{supplier_type:"HOTEL"})})]})]}),t.jsxs("div",{className:"grid gap-5 lg:grid-flow-col",children:[t.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-5 one-way-round-trip",children:[t.jsx(Ht,{label:"Destination",value:s}),t.jsx(Rt,{label:"Stay Duration",minDate:"today",defaultValue:[o,e],action:i=>q.update(l=>{l.checkIn=ie(new Date(i[0])).format("YYYY-MM-DD"),l.checkOut=ie(new Date(i[1])).format("YYYY-MM-DD")})}),t.jsx(Yt,{storeName:"hotel_search_options"}),t.jsx($t,{})]}),t.jsx(Bt,{isStatic:!r})]})]})},us=({count:o,location:e})=>t.jsxs("div",{className:"flex w-full gap-4 p-3 mb-4 rounded-md shadow-md bg-base-200",children:[t.jsxs("div",{className:"relative flex items-center justify-center w-16 h-16 rounded-full bg-base-100",children:[t.jsx(be,{className:"text-4xl text-red-500 sm:text-5xl"}),t.jsx("div",{className:"absolute top-0 left-0 flex items-center justify-center w-full h-full font-semibold text-white sm:text-lg",children:o})]}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-semibold sm:text-2xl",children:"Your favorite options"}),t.jsxs("p",{className:"text-xs sm:text-sm text-neutral",children:["Your favorite options in ",e]})]})]}),ps=({hotels:o,search_parameter:e})=>{var n;const s=ge(),[r]=fe(),a=r.get("tracking_id"),i=r.get("show_favorite"),l=()=>{s(`/hotel/search?tracking_id=${a}&show_favorite=1`)},d=()=>{s(`/hotel/search?tracking_id=${a}`)};return t.jsx("aside",{className:"sticky z-0 w-full max-w-[250px] max-lg:hidden overflow-auto bg-transparent rounded-lg shadow-md bg-base-200 top-20 h-fit mb-52 shrink-0",children:t.jsxs("div",{className:"py-5 lg:rounded-lg lg:shadow-lg bg-base-200 h-screen lg:max-h-[calc(100vh-80px)] lg:overflow-auto custom-scrollbar",children:[t.jsx("div",{className:"px-4 mb-4",children:t.jsxs("button",{onClick:i==="1"?d:l,type:"button",className:P("flex items-center w-full h-10 px-4 rounded justify-between",i==="1"?"bg-red-500 text-white":"bg-base-200 border"),children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(be,{className:P("text-xl",i==="1"?"text-white":"text-red-500")})," ","My favorites",t.jsx(Pe,{button:t.jsx("span",{className:"flex items-center justify-center w-4 h-4 p-1 text-xs rounded bg-neutral/5 hover:bg-base-content hover:text-white",children:t.jsx(Te,{})}),children:t.jsx("div",{className:"max-w-[250px] p-2 pb-0 text-sm text-justify",children:"In order to find the hotels your like in the hotel lists faster, mark them with the heart icon."})})]}),i==="1"&&t.jsx(Ze,{})]})}),t.jsx("div",{className:"px-5 mb-5",children:t.jsxs("div",{className:"relative overflow-hidden rounded",children:[t.jsx("img",{src:"https://media.wired.com/photos/59269cd37034dc5f91bec0f1/191:100/w_1280,c_limit/GoogleMapTA.jpg",className:"object-cover w-full h-36 rounded-2",alt:""}),t.jsx("div",{className:"absolute top-0 left-0 flex items-center justify-center w-full h-full bg-white/10 ",children:t.jsxs("button",{onClick:async()=>{var c;await xe.update(u=>{u.isShow=!0}),(c=document.getElementById("multiple_hotels_map_modal"))==null||c.showModal()},className:"h-10 min-h-0 normal-case rounded shadow-md btn btn-primary shadow-primary/50",children:[t.jsx(Fe,{})," Show on map"]})})]})}),t.jsx("div",{className:"px-5",children:t.jsx("ul",{className:"pl-4 space-y-2 list-decimal",children:(n=[...o].sort((c,u)=>Number(c==null?void 0:c.sell_price)-Number(u==null?void 0:u.sell_price)))==null?void 0:n.map(c=>t.jsx("li",{className:"gap-2 text-xs duration-200 cursor-pointer list-item hover:text-primary hover:underline",onClick:()=>{const{hotel_id:u}=c||{},{checkIn:h,checkOut:p,occupancies:f,guest_nationality:w}=e||{},y=JSON.stringify({hotel_id:u,checkIn:h,checkOut:p,occupancies:f,guest_nationality:w}),g=btoa(y);window.open(`/hotel/details?q=${g}`,"_blank")},children:t.jsxs("div",{className:"flex justify-between gap-2",children:[t.jsx("span",{className:"font-medium line-clamp-1",children:c==null?void 0:c.hotel_name}),t.jsxs("span",{className:"text-secondary whitespace-nowrap",children:[Ie(c==null?void 0:c.currency)," ",c==null?void 0:c.sell_price]})]})},c==null?void 0:c.hotel_id))})})]})})},As=()=>{var z,G,b,N,I,O;const{site_title:o,login_required:e,system_config:s,component_version:r}=Y.useState(),{price:a,distance:i,property_name:l,property_type:d,rating:n,facilities:c,sorting:u}=T.useState(),{filteredData:h}=ae.useState(),{axiosInstance:p}=mt(),[f]=fe(),w=f.get("tracking_id"),y=ge(),[g,v]=S.useState(null),{data:m,isLoading:k,error:L}=ut(["SEARCH_RESULT_HOTEL",w],async()=>{var _,j,M;if(!w)return y("/"),null;const x=await p.get(`/hotel_logs?tracking_id=${w}&base_url=${s!=null&&s.supplier_logs_file_base_url?s==null?void 0:s.supplier_logs_file_base_url:""}&login_required=${e}`);if(((_=x==null?void 0:x.data)==null?void 0:_.status)==="success")return v((j=x.data)==null?void 0:j.message),x.data.data=x.data.data.map(E=>(E.matched_rating=et(x.data.search_parameter.location,E.hotel_name,E.address),E)),x.data.data.sort((E,ne)=>ne.matched_rating-E.matched_rating),x.data;throw{...x,message:((M=x.data)==null?void 0:M.reason)||"Request failed!"}}),D=f.get("show_favorite"),H=re.useState();S.useEffect(()=>{if(m){let x=[...m.data];x=D==="1"?x.filter(_=>H.some(j=>(j==null?void 0:j.hotel_id)===_.hotel_id)):x,x=x.filter(_=>{var j,M;return l?(M=(j=_.hotel_name)==null?void 0:j.toLowerCase())==null?void 0:M.includes(l==null?void 0:l.toLowerCase()):!0}),x=x.filter(_=>_.sell_price>=a.min_price&&_.sell_price<=a.max_price),x=x.filter(_=>{var j,M;return Number((j=_.distance_km)==null?void 0:j.replace(",",""))>=i.min_distance&&Number((M=_.distance_km)==null?void 0:M.replace(",",""))<=i.max_distance}),x=x.filter(_=>Object.values(d).every(j=>j===!1)?!0:d[_.property_type]===!0),x=x.filter(_=>Object.values(n).every(j=>j===!1)?!0:n[_.star_rating]===!0),x=x.filter(_=>Object.values(c).every(j=>j===!1)?!0:_.facility.some(j=>c[(j==null?void 0:j.title)||j]===!0)),x.sort((_,j)=>{switch(u.sortBy){case"cheapest":return _.sell_price-j.sell_price;case"distance":return _.distance_km-j.distance_km;case"rating":return j.star_rating-_.star_rating;default:return 0}}),ae.update(_=>{_.filteredData=x})}},[a,m,d,n,c,u,l,i,D,H]),S.useEffect(()=>{var x;if(((x=m==null?void 0:m.data)==null?void 0:x.length)>0){const{search_parameter:{location:_,radius:j,checkIn:M,checkOut:E,supplier_uid:ne,occupancies:qe,guest_nationality:Je,hotel_star_level:We,partner_id:Ke}}=m;q.update(B=>{B.partner_id=Ke,B.location=_,B.radius=j,B.checkIn=M,B.checkOut=E,B.occupancies=qe.map(J=>{const W={};return W.id=Le(),W.adult=Number(J.adult),W.child=J.child?Number(J.child):0,W.child_age=J.child_age?J.child_age:[],W}),B.supplier_uid=ne,B.guest_nationality=Je,B.hotel_star_level=We}),$(!1)}},[m]);const C=je.useMediaQuery({query:"(max-width: 640px)"}),[Z,$]=S.useState(!1);if(L)throw L;const A=(z=r==null?void 0:r.hotel)==null?void 0:z.search_result;return t.jsxs("main",{className:"container min-h-screen pt-20",children:[t.jsx(Xe,{children:t.jsxs("title",{children:["Hotel Search",o?" - "+o:""]})}),C&&t.jsxs(zt,{open:Z,onOpenChange:$,children:[t.jsx(Gt,{asChild:!0,children:t.jsxs("button",{className:"flex items-center justify-center w-full gap-2 px-5 py-4 mb-4 duration-100 rounded-md shadow-md bg-base-200 hover:text-primary lg:hidden",children:[t.jsx(pt,{}),t.jsx("span",{children:"Modify Search"})]})}),t.jsx(Vt,{children:!k&&(m!=null&&m.search_parameter)?((G=r==null?void 0:r.hotel)==null?void 0:G.search_box)==="2"?t.jsx(Ee,{}):t.jsx(Ae,{}):t.jsx(ve,{})})]}),C&&t.jsxs(xt,{children:[t.jsx(ft,{asChild:!0,children:t.jsxs("button",{className:"flex items-center justify-center w-full gap-2 px-5 py-4 mb-4 duration-100 rounded-md shadow-md bg-base-200 hover:text-primary",children:[t.jsx(gt,{}),t.jsx("span",{children:"Filter"})]})}),t.jsx(jt,{className:"p-0 w-fit",children:!k&&(m!=null&&m.filter)?t.jsx(me,{filterData:m.filter,result_count:h==null?void 0:h.length,search_duration_seconds:m.search_duration_seconds}):t.jsx(he,{})})]}),!C&&t.jsx(t.Fragment,{children:!k&&(m!=null&&m.search_parameter)?((b=r==null?void 0:r.hotel)==null?void 0:b.search_box)==="2"?t.jsx(Ee,{}):t.jsx(Ae,{}):t.jsx(ve,{})}),!k&&(m==null?void 0:m.filter_data)&&g&&t.jsx("div",{className:"mb-4 overflow-hidden border rounded-md shadow bg-base-200 border-warning animate-pulse",children:t.jsxs("div",{className:"relative px-3 py-2 bg-warning/10",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("div",{className:"py-1 text-warning",children:t.jsx(wt,{className:"text-xl"})}),t.jsx("div",{children:t.jsx("p",{className:"text-xs font-normal",children:g})})]}),t.jsx("button",{onClick:()=>v(null),className:"absolute top-1 right-1 btn btn-ghost btn-circle btn-sm !bg-transparent",children:t.jsx(bt,{})})]})}),t.jsxs("div",{className:P("grid grid-cols-1 gap-4 mt-5 mb-5 lg:grid-cols-4"),children:[!k&&(m!=null&&m.filter)?t.jsx(me,{filterData:m.filter,result_count:h==null?void 0:h.length,search_duration_seconds:m.search_duration_seconds,occupancies:(N=m==null?void 0:m.search_parameter)==null?void 0:N.occupancies,total_night:(I=m==null?void 0:m.search_parameter)==null?void 0:I.total_night,isShow:!C}):t.jsx(he,{}),t.jsxs("section",{className:"lg:col-span-3",children:[!k&&(m!=null&&m.filter)?D?t.jsx(us,{count:h==null?void 0:h.length,location:(O=m==null?void 0:m.search_parameter)==null?void 0:O.location}):t.jsx(Jt,{}):t.jsx("div",{className:"h-20 mb-5 skeleton-box"}),t.jsx("div",{className:P("lg:flex lg:gap-4"),children:k?t.jsx(_t,{}):t.jsxs(t.Fragment,{children:[t.jsx(Wt,{search_parameter:m==null?void 0:m.search_parameter}),A==="2"&&t.jsx(ps,{hotels:m==null?void 0:m.data,search_parameter:m==null?void 0:m.search_parameter}),t.jsx(ms,{})]})})]})]})]})};export{As as default};
