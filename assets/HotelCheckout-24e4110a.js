import{aT as q,e as I,q as e,aU as L,aV as k,m as F,I as Q,aW as ce,aX as ie,ad as oe,o as $,P as X,u as de,T as M,a2 as Y,H as me,a4 as ue,a5 as pe}from"./index-adb6807e.js";import{P as R,s as G,t as U,d as z,e as J,bL as xe,a3 as he,j as be,bM as ge,S as W,bN as fe,a_ as je,bO as ye,bP as Ne,o as _e,H as V,J as ke,n as we}from"./App-2ee69fad.js";import{A as ve,a as D}from"./AccordionItem-4ebe28c7.js";import{R as Ce}from"./RadioInputCheckout-263695a1.js";import{T as H}from"./TextInputCheckout-e168ed06.js";import{I as Z}from"./InputContainerCheckout-28fc19ba.js";import{P as ee}from"./PhoneNumberSelect-47cc6bd4.js";import{C as Se}from"./Checkbox-cb5e1e6b.js";import{a as Re}from"./Room-b709509b.js";import{w as qe}from"./sweetalert2-react-content.es-47ee4db4.js";import{H as Ie}from"./index.esm-25b1069c.js";import{C as K}from"./CustomDivider-1979dbbe.js";import{S as Te}from"./SessionTimeOut-8a41584b.js";import"./index.esm-86de35f1.js";import"./HotelImageSlider-129f4fe3.js";const se=({pax_id:p,pax_type:r,room_id:c,index:a,primaryGuestOnly:o,pax_age:x})=>{var m,b,n;const{passenger:d}=q.useState(),s=c+"_"+p;return I.useEffect(()=>{q.update(f=>{f.passenger[s]={...f.passenger[s],pax_id:String(p),pax_type:r,room_number:String(c),title:"MR",age:x,first_name:a>0?"TBA":"",last_name:a>0?"TBA":""}})},[s,p,r,c,a,x]),a>0&&o?null:e.jsxs("div",{children:[!o&&e.jsxs("h6",{className:"mb-4 font-medium",children:[r==="ADT"?e.jsx(G,{className:"mr-0.5"}):e.jsx(U,{className:"mr-0.5"})," ",r==="ADT"?"Adult":"Child"," ",p]}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsx(Ce,{label:"Title",isRequired:!0,defaultValue:((m=d[s])==null?void 0:m.title)||"MR",action:f=>L(s,{title:f.target.value}),options:[{label:"Mr",value:"MR"},{label:"Mrs",value:"MRS"},{label:"Ms",value:"MS"}]}),e.jsx(H,{label:"First/Given Name",isRequired:!0,action:f=>L(s,{first_name:f.target.value}),isUpperCase:!0,defaultValue:((b=d[s])==null?void 0:b.first_name)||"",placeholder:"John"}),e.jsx(H,{label:"Last/Family Name",isRequired:!0,action:f=>L(s,{last_name:f.target.value}),isUpperCase:!0,defaultValue:((n=d[s])==null?void 0:n.last_name)||"",placeholder:"Doe"})]})]})};se.propTypes={room_id:R.number.isRequired,pax_id:R.number.isRequired,pax_type:R.string.isRequired};const Ae=()=>{const{axiosInstance:p}=z(),{tracking_id:r}=q.useState(s=>s),{isd_code:c,contact_no:a,email_address:o}=k.useState(),{user_data:{login_key:x,member_id:d}}=F.useState(s=>s);return J(["USER_DETAILS",r,x,d],async()=>{var b;const s=await p.post("/user/profile",{login_key:x,member_id:d}),m=location.origin;if(((b=s.data)==null?void 0:b.status)==="success")return k.update(n=>{n.tracking_id=r,n.member_id=s.data.data.member_id,n.contact_no=s.data.data.mobile,n.agency_contact_no=s.data.data.mobile,n.email_address=s.data.data.email,n.agency_email=s.data.data.email,n.agency_isd_code=s.data.data.isd_code,n.isd_code=s.data.data.isd_code,n.redirect_url=`${m}/booking-details/hotel`}),s.data.data}),e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"flex w-full mx-auto mb-3 text-xs badge badge-info bg-info/5 text-info",children:"System will send reservation confirmation email with your branding profile. No price information will be shown there"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(Z,{label:"Mobile Number",isRequired:!0,defaultValue:String(c||"")+String(a||""),action:s=>k.update(m=>{m.isd_code=s.isd_code,m.contact_no=s.mobile}),placeholder:"Enter Mobile Number",Input:ee}),e.jsx(H,{type:"email",label:"Email",action:s=>k.update(m=>{m.email_address=s.target.value}),placeholder:"example@mail.com",defaultValue:o})]})]})},Ee=()=>{const{agency_isd_code:p,agency_contact_no:r,agency_email:c}=k.useState(a=>a);return e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"flex w-full mx-auto mb-3 text-xs badge badge-info bg-info/5 text-info",children:"Below information will send to hotel as contact details"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(Z,{label:"Mobile Number",isRequired:!0,defaultValue:String(p||"")+String(r||""),action:a=>k.update(o=>{o.agency_isd_code=a.isd_code,o.agency_contact_no=a.mobile}),placeholder:"Enter Mobile Number",Input:ee}),e.jsx(H,{type:"email",label:"Email",action:a=>k.update(o=>{o.agency_email=a.target.value}),placeholder:"example@mail.com",defaultValue:c})]})]})},Be=()=>{const{special_requests_notes:p,special_requests:r}=k.useState(c=>c);return e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"flex w-full mx-auto mb-3 text-xs badge badge-warning bg-warning/5 text-warning",children:"**All Special Requests are not guaranteed. It depends on the subjective availability at check-in time"}),e.jsx("div",{className:"grid grid-cols-1 gap-3 mb-4 text-[13px] sm:grid-cols-3",children:r.map((c,a)=>e.jsx(Se,{label:c.label,defaultChecked:c.requested,action:o=>k.update(x=>{const d=[...x.special_requests];d[a].requested=o,x.special_requests=d})},a))}),e.jsxs("div",{className:"sb-input-container",children:[e.jsx("label",{htmlFor:"remarkNotes",className:"sb-label",children:"Remarks Notes (Special Request Additional Notes)"}),e.jsx("textarea",{id:"remarkNotes",defaultValue:p,onChange:c=>k.update(a=>{a.special_requests_notes=c.target.value}),className:"block w-full p-0 m-0 font-medium bg-transparent rounded-none placeholder:text-neutral/50 outline-0 min-h-12 focus:outline-0",placeholder:"Provide details notes regaring any special requests"})]})]})},Pe=({room:p,room_content:r})=>{var _;const{name:c,meal_option:a,occupancies:o,rate_type:x,amenities:d,price:s}=p,{bed_type:m,room_size:b,views:n,description:f,room_pic:C,additional_images:t,amenities:g,paid_amenities:y}=r||{},j=qe(W),N=()=>{const l={title:c,images:(t==null?void 0:t.map(i=>i==null?void 0:i.url))||[C],amenities:[...d.map(i=>i==null?void 0:i.title)||[],...g||[],...(m==null?void 0:m.map(i=>{var u;return(u=i==null?void 0:i.configuration)==null?void 0:u.map(h=>h==null?void 0:h.type)}))||[]],description:f,paid_amenities:y};j.fire({html:e.jsx(Re,{room:l}),showConfirmButton:!1,showCloseButton:!0,customClass:{popup:"w-full max-w-xl !overflow-hidden",htmlContainer:"!m-0",closeButton:"text-red-500"}})},w=m==null?void 0:m.reduce((l,i)=>(i!=null&&i.description&&l.some(u=>(u==null?void 0:u.description)===(i==null?void 0:i.description))===!1&&l.push(i),l),[]);return e.jsxs("tr",{children:[e.jsx("td",{className:"p-3 align-top border border-neutral/10 min-w-[200px]",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[((_=s==null?void 0:s.promo_tag)==null?void 0:_.description)&&e.jsxs("div",{className:"relative flex px-2 py-1 pr-6 text-xs font-light text-white bg-gradient-to-r from-secondary-focus to-secondary -left-3 w-fit !line-clamp-1",children:[s.promo_tag.description,e.jsx("span",{className:"absolute top-0 right-0 h-0 border-y-[12px] border-x-[12px] border-transparent border-r-white"})]}),C&&e.jsx("img",{src:C||"/no_image.jpg",alt:c,className:"h-[150px] object-cover object-center rounded"}),e.jsxs("h5",{className:"text-[15px] font-medium",children:[o==null?void 0:o.total_room," X ",c]}),e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[b&&e.jsxs("span",{className:"text-[10px] flex items-center px-1 py-0.5 font-medium rounded bg-secondary/10 text-secondary w-fit gap-1",children:[e.jsx(xe,{})," ",e.jsxs("span",{children:[b," m",e.jsx("sup",{children:"2"})]})]}),e.jsx(he,{button:e.jsxs("div",{className:"text-[10px] flex items-center px-1 py-0.5 font-medium rounded bg-secondary/10 text-secondary w-fit gap-0.5",children:[e.jsx("span",{className:"mr-1",children:"Sleeps:"}),Number(o.adult)>0&&[...Array(Number(o.adult))].map((l,i)=>e.jsx(G,{},i)),Number(o.child)>0&&[...Array(Number(o.child))].map((l,i)=>e.jsx(U,{},i))]}),children:e.jsxs("div",{className:"flex flex-col gap-1 px-3 py-2 text-xs",children:[e.jsxs("div",{className:"text-primary",children:[e.jsx(G,{})," Adult: ",o.adult]}),e.jsxs("div",{className:"text-secondary",children:[e.jsx(U,{})," Child: ",o.child]})]})})]}),e.jsx("div",{children:e.jsxs("button",{onClick:()=>N(),className:"px-1 text-xs font-bold text-primary bg-base-200",children:["Room Amenities ",e.jsx(be,{})]})})]})}),e.jsxs("td",{className:"p-3 border border-neutral/10 min-w-[150px]",children:[e.jsxs("ul",{className:"flex flex-col gap-1 text-xs",children:[(w==null?void 0:w.length)>0&&e.jsxs("li",{className:"align-middle list-item text-secondary",children:[e.jsx(ge,{className:"text-xl"})," ",w.map(l=>l.description).join("/")]}),(!a||(a==null?void 0:a.some(l=>(l==null?void 0:l.included)==="yes"))===!1)&&x&&e.jsxs("li",{className:"align-middle list-item text-secondary",children:[e.jsx(Q,{path:ce,size:.8})," ",x]}),(a==null?void 0:a.length)>0&&(a==null?void 0:a.map((l,i)=>e.jsxs("li",{className:"align-middle list-item text-secondary",children:[e.jsx(Q,{path:ie,size:.8})," ",l.title]},i))),n==null?void 0:n.map((l,i)=>l&&e.jsxs("li",{className:"align-middle list-item text-secondary",children:[e.jsx(Ie,{className:"mr-1"})," ",l]},i))]}),f&&e.jsx("div",{className:"mt-2 text-xs text-neutral line-clamp-[2] inner-html",dangerouslySetInnerHTML:{__html:f}})]})]})},Fe=({validation_data:p})=>{var a,o,x;const r=p==null?void 0:p.data,c=(o=(a=p==null?void 0:p.hotel_contents)==null?void 0:a.data)==null?void 0:o.room_type;return e.jsxs("table",{className:"w-full mb-4 text-sm room-table",children:[e.jsx("thead",{}),e.jsx("tbody",{children:(x=r==null?void 0:r.data)==null?void 0:x.map(d=>{const{room_number:s}=d||{},m=c==null?void 0:c.find(b=>(b==null?void 0:b.room_id)===s);return e.jsx(Pe,{room:d,room_content:m},s)})})]})},ae=({validation_data:p})=>{var m,b,n,f,C;const{search_parameter:{occupancies:r},booking_tracking_id:c,data:a}=p,o=(b=(m=a==null?void 0:a.data)==null?void 0:m.at(0))==null?void 0:b.rate_comments;let x=I.useMemo(()=>0,[]);I.useEffect(()=>(q.update(t=>{t.tracking_id=c}),k.update(t=>{t.tracking_id=c}),()=>{q.update(t=>{t.passenger=q._getInitialState().passenger})}),[c]);const[d,s]=I.useState(!1);return e.jsxs("div",{className:"p-3 rounded-lg lg:col-span-2 bg-base-200",children:[e.jsx(Fe,{validation_data:p}),!!o&&e.jsx("div",{className:"p-2 mb-3 text-sm border rounded-md border-warning/20 text-error",children:e.jsx("div",{className:"relative flex items-end gap-2",children:e.jsxs("div",{children:[e.jsx("h1",{className:"mb-1 text-lg font-semibold text-red-600",children:"***Attention***"}),e.jsx("div",{className:"text-red-400",children:e.jsx("p",{className:" inner-html",dangerouslySetInnerHTML:{__html:oe(o)}})})]})})}),e.jsx("div",{className:"p-2 mb-3 text-sm border border-yellow-100 rounded-md",children:e.jsx("div",{className:"relative flex items-end gap-2",children:e.jsxs("div",{children:[e.jsx("h1",{className:"mb-1 text-lg font-semibold text-yellow-400",children:"Cancellation Policies"}),e.jsx("div",{className:"text-neutral",children:(n=a==null?void 0:a.data)==null?void 0:n.map(t=>{var g,y;return e.jsxs("div",{children:[e.jsx("h1",{className:"font-semibold text-base-content",children:t==null?void 0:t.name}),(y=(g=t==null?void 0:t.cancellation_policies)==null?void 0:g.policy_breakdown)==null?void 0:y.map((j,N)=>e.jsx("p",{className:"text-xs",children:j==null?void 0:j.details},N))]},t==null?void 0:t.room_number)})})]})})}),((f=a==null?void 0:a.data)==null?void 0:f.some(t=>{var g,y,j,N;return((N=(j=(y=(g=t==null?void 0:t.price)==null?void 0:g.purchase)==null?void 0:y.price_breakdown)==null?void 0:j.payable_at_property)==null?void 0:N.length)>0}))&&e.jsx("div",{className:"p-2 mb-3 text-sm border border-blue-100 rounded-md",children:e.jsx("div",{className:"relative flex items-end gap-2",children:e.jsxs("div",{children:[e.jsx("h1",{className:"mb-1 text-lg font-semibold text-blue-400",children:"Payable at Property"}),e.jsx("div",{className:"text-neutral",children:(C=a==null?void 0:a.data)==null?void 0:C.map(t=>{var g,y,j,N,w,_,l,i;return((N=(j=(y=(g=t==null?void 0:t.price)==null?void 0:g.purchase)==null?void 0:y.price_breakdown)==null?void 0:j.payable_at_property)==null?void 0:N.length)>0&&e.jsxs("div",{children:[e.jsx("h1",{className:"font-semibold text-base-content",children:t==null?void 0:t.name}),(i=(l=(_=(w=t==null?void 0:t.price)==null?void 0:w.purchase)==null?void 0:_.price_breakdown)==null?void 0:l.payable_at_property)==null?void 0:i.map(u=>e.jsxs("div",{className:"text-xs",children:[e.jsxs("strong",{children:[u==null?void 0:u.title,":"]})," ",e.jsxs("span",{children:[u==null?void 0:u.currency," ",u==null?void 0:u.amount]})," ",e.jsxs("span",{className:"neutral",children:["(",u==null?void 0:u.remark,")"]})]},u==null?void 0:u.title))]},t==null?void 0:t.room_number)})})]})})}),e.jsxs(ve,{className:"w-full mb-8 bg-base-200 border",children:[e.jsxs(D,{isOpen:!0,header:"Enter Guest Details",disabled:!0,children:[e.jsxs("div",{className:"flex items-center gap-4 px-4 pt-2",children:[e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"cursor-pointer label",children:[e.jsx("input",{type:"radio",name:"hotel-checkout-option",className:"mr-2 radio radio-primary radio-sm",checked:!d,onChange:t=>s(!t.target.checked)}),e.jsx("span",{className:"label-text",children:"Primary Guest Only"})]})}),e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"cursor-pointer label",children:[e.jsx("input",{type:"radio",name:"hotel-checkout-option",className:"mr-2 radio radio-primary radio-sm",checked:d,onChange:t=>s(t.target.checked)}),e.jsx("span",{className:"label-text",children:"All Guest"})]})})]}),Array(r.length).fill("").map((t,g)=>{const y=r[g].room,j=Number(r[g].adult),N=r[g].child?Number(r[g].child):0,w=j+N;let _=0,l=0;return e.jsxs("div",{className:"p-3",children:[e.jsxs("h5",{className:"flex items-center px-3 py-2 text-lg font-bold border border-b-0 rounded-t",children:[e.jsx(fe,{className:"mr-1"})," Room ",y]}),e.jsx("div",{className:"p-3 border rounded rounded-t-none",children:e.jsx("div",{className:"flex flex-col gap-8",children:Array(w).fill("").map((i,u)=>{var S,A,E,B;x+=1;const h=u+1<=j?"ADT":"CNN";return _=h==="ADT"?_+1:_,l=h==="CNN"?l+1:l,e.jsx(se,{room_id:y,pax_id:x,pax_type:h,index:u,primaryGuestOnly:!d,pax_age:h==="ADT"?((A=(S=r[g])==null?void 0:S.adult_age)==null?void 0:A[_-1])||"30":((B=(E=r[g])==null?void 0:E.child_age)==null?void 0:B[l-1])||"10"},u)})})})]},g)})]}),e.jsx(D,{isOpen:!0,header:"Enter Primary Guest Contact Details",disabled:!0,children:e.jsx(Ae,{})}),e.jsx(D,{isOpen:!0,header:"Enter Agency Contact Details",disabled:!0,children:e.jsx(Ee,{})}),e.jsx(D,{isOpen:!0,header:"Add Special Requests",disabled:!0,children:e.jsx(Be,{})})]})]})};ae.propTypes={validation_data:R.object.isRequired};const te=({hotel:p,validation_data:r})=>{var N,w,_,l,i;const{search_parameter:c}=r||{},{name:a,address:o,primary_photo:x,star_rating:d}=p||{},{full_address:s}=o||{},{checkIn:m,checkOut:b,occupancies:n}=c,f=n.reduce((u,h)=>u+Number(h.adult),0),C=n.reduce((u,h)=>u+(h.child?Number(h.child):0),0),{system_config:t}=$.useState(),{title:g}=((N=r==null?void 0:r.data)==null?void 0:N.summery)||{},{rate_type:y,bed_option:j}=((_=(w=r==null?void 0:r.data)==null?void 0:w.data)==null?void 0:_.at(0))||{};return e.jsxs("div",{className:"mx-4 overflow-hidden text-sm rounded-lg bg-base-100",children:[e.jsxs("div",{className:"relative before:content-[''] before:absolute before:inset-0 before:bg-gradient-to-b before:from-black/80 before:via-black/20 before:to-transparent booking-summary",children:[e.jsx("img",{src:x,alt:a,className:"w-full min-h-[300px] object-cover object-center"}),e.jsxs("div",{className:"absolute z-10 text-white top-4 left-4",children:[e.jsx("h5",{className:"mb-1 text-xl font-semibold",children:a}),e.jsxs("p",{className:"mb-2 text-warning text-[11px]",children:[Array(Math.floor(d||0)).fill(0).map((u,h)=>e.jsx(je,{},h)),e.jsxs("span",{className:"text-white",children:[" (",d||0," Star)"]})]}),e.jsxs("p",{className:"text-xs text-white/80",children:[e.jsx(ye,{className:"mr-1 text-base text-primary"}),s]})]})]}),e.jsxs("div",{className:"p-3",children:[e.jsxs("p",{className:"flex items-center justify-between gap-4 mb-1",children:[e.jsx("span",{children:"Date"}),e.jsxs("span",{children:[X(new Date(m)).format(t.default_date_format_print)," ","to"," ",X(new Date(b)).format(t.default_date_format_print)]})]}),e.jsxs("p",{className:"flex items-center justify-between gap-4 mb-4",children:[e.jsx("span",{children:"Room"}),e.jsx("span",{children:g})]}),e.jsxs("p",{className:"flex items-center justify-end gap-4 mb-2 text-xs",children:[e.jsx("span",{className:"inline-block px-1 rounded bg-neutral/10",children:y}),((l=j==null?void 0:j.at(0))==null?void 0:l.title)&&e.jsx("span",{className:"inline-block px-1 rounded bg-neutral/10",children:(i=j==null?void 0:j.at(0))==null?void 0:i.title})]}),e.jsxs("p",{className:"flex items-center justify-between gap-4 mb-2",children:[e.jsx("span",{children:"Occupancy"}),e.jsxs("span",{children:[n.length," Room(s), ",f," adult(s)"," ",C>0&&`and ${C} children`]})]}),e.jsxs("p",{className:"flex items-center justify-between gap-4 mb-1",children:[e.jsx("span",{className:"fw-medium",children:"Room Fare"}),e.jsx("a",{className:"link-secondary",href:"#",children:e.jsx(Ne,{})})]})]})]})};te.propTypes={hotel:R.object.isRequired,search_parameter:R.object.isRequired};const re=({isExpired:p,isChecked:r,hold_possible:c})=>{const{special_requests:a,special_requests_notes:o,...x}=k.useState(h=>h),{axiosInstance:d}=z(),[s,m]=I.useState(!1),{user_data:{member_id:b,login_key:n}}=F.useState(),{tracking_id:f,passenger:C}=q.useState(h=>h),t=a.filter(h=>h.requested).map(h=>h.label).join(", "),g=_e(),y=de(),{data:j,isLoading:N,isError:w}=J({queryKey:["SERVICE_STATUS",n,b],queryFn:async()=>{var h;try{const S=await d.post("/reports/service-status",{login_key:n,member_id:b});return((h=S==null?void 0:S.data)==null?void 0:h.service_status)||null}catch(S){console.error(S)}}}),_=async()=>{var h,S,A,E,B;if(!s)try{if(m(!0),r.terms_conditions===!1)throw new Error("Please accept Terms & Conditions");if(r.cancellation_policy===!1)throw new Error("Please accept Cancellation Policy");if(r.rate_terms===!1)throw new Error("Please accept Rate Terms");const P=await d.post("/user/profile",JSON.parse(localStorage.getItem("user_info")));if(!P.data||((h=P.data)==null?void 0:h.status)!=="success"){localStorage.removeItem("user_info"),F.update(v=>{v.token=null,v.user_data=null}),y.invalidateQueries(["SITE_CONFIG"]);return}const ne={tracking_id:f,member_id:b,passenger:Object.values(C)},T=await d.post("/hotel/update-travelers",ne);if(((S=T==null?void 0:T.data)==null?void 0:S.status)==="success")try{const v=await d.post("/hotel/create-booking",{...x,member_id:b,special_requests_notes:`${t?`${t}, `:""} ${o}`.trim()||"n/a"});if(((A=v==null?void 0:v.data)==null?void 0:A.status)==="success")(B=(E=v==null?void 0:v.data)==null?void 0:E.general)!=null&&B.tracking_id?(g(`/booking-details/hotel?tracking_id=${v.data.general.tracking_id}`,{replace:!0}),M("success","Booking Successful",v.data.reason),q.replace(q._getInitialState()),k.replace(k._getInitialState()),Y.replace(Y._getInitialState())):(M("success","Hey buddy! One more step","Please pay now"),setTimeout(()=>{var O;window.location.replace((O=v==null?void 0:v.data)==null?void 0:O.payment_link)},1e3));else throw new Error(v.data.reason)}catch(v){(await W.fire({title:"Booking Failed!",html:v.message,icon:"error",showCancelButton:!1,showCloseButton:!1,confirmButtonColor:"hsl(var(--p)/1)",confirmButtonText:"Go Back",allowOutsideClick:!1})).isConfirmed&&g(-1,{replace:!0})}else throw new Error(T==null?void 0:T.data.reason)}catch(P){console.error(P),M("error","Failed!",P.message)}finally{m(!1)}};if(N)return e.jsxs("button",{className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",children:[e.jsx(V,{className:"mr-2 animate-spin"})," Loading..."]});if(w)return null;const{block_status:l,hotel_block:i,reason:u}=j;return l==="yes"&&i==="yes"?e.jsx("div",{className:"p-3 text-sm border rounded-lg border-error bg-error/10",children:e.jsx("p",{className:"text-error inner-html",dangerouslySetInnerHTML:{__html:u}})}):x!=null&&x.payment_type?e.jsx(e.Fragment,{children:x.payment_type==="account_balance"?e.jsx("button",{onClick:_,className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",disabled:p,children:s?e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"mr-2 animate-spin"})," Loading..."]}):c==="yes"?"Hold Booking":"Confirm Booking"}):e.jsx("button",{onClick:_,disabled:p,className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",children:s?e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"mr-2 animate-spin"})," Loading..."]}):"Pay and Reserve"})}):e.jsx("div",{className:"p-3 text-sm border rounded-lg border-error bg-error/10",children:e.jsx("p",{className:"text-error",children:"You don't have enough balance."})})};re.propTypes={isExpired:R.bool.isRequired,isChecked:R.object,hold_possible:R.string.isRequired};const le=({hotel:p,validation_data:r})=>{var j,N,w,_;const{session_expire:c}=r,{currency:a,sell_total_price:o,total_amount:x,hold_possible:d}=((j=r==null?void 0:r.data)==null?void 0:j.summery)||{},{user_data:s}=F.useState(),{payment_type:m}=k.useState(),b=(_=(w=(N=r==null?void 0:r.data)==null?void 0:N.data)==null?void 0:w.at(0))==null?void 0:_.rate_terms,[n,f]=I.useState({terms_conditions:!1,cancellation_policy:!1,rate_terms:!b}),[C,t]=I.useState(!1),{price_view:{online_payment_option:g}={}}=$.useState();I.useEffect(()=>{x>(s==null?void 0:s.balance)&&d==="no"&&(g==="YES"?k.update(l=>{l.payment_type="card"}):k.update(l=>{l.payment_type=null}))},[x,s==null?void 0:s.balance,d,g]);const y=l=>{x>(s==null?void 0:s.balance)&&d==="no"?(l.preventDefault(),l.target.value==="account_balance"?M("error","Insufficient Balance","Please add balance to your account"):l.target.click()):k.update(i=>{i.payment_type=l.target.value})};return e.jsxs("div",{className:"sticky py-4 rounded-lg bg-base-200 h-fit top-5",children:[e.jsx(te,{hotel:p,validation_data:r}),e.jsx(K,{}),e.jsx(Te,{session_expire:c,action:l=>t(l)}),e.jsx(K,{}),e.jsxs("div",{className:"px-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 mb-3 rounded-lg bg-primary/10 text-primary",children:[e.jsx("p",{children:"Total payable"}),e.jsxs("p",{className:"text-lg font-bold",children:[me(a)," ",o]})]}),e.jsxs("div",{className:"grid gap-3 mb-3 sm:grid-flow-col lg:grid-flow-row xl:grid-flow-col payment-selection",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("input",{autoComplete:"off",type:"radio",className:"absolute -translate-y-1/2 radio radio-xs radio-primary left-2 top-1/2 peer",name:"payment",id:"balance",value:"account_balance",defaultChecked:m==="account_balance",onClick:y}),e.jsx("label",{htmlFor:"balance",className:"block px-2 py-4 pl-8 text-nowrap bg-primary/10 peer-checked:bg-primary peer-checked:text-white",children:"Account Balance"})]}),g==="ACTIVE"&&e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("input",{autoComplete:"off",type:"radio",className:"absolute -translate-y-1/2 radio radio-primary radio-xs top-1/2 left-2 peer",name:"payment",id:"card",value:"card",defaultChecked:m==="card",onClick:y}),e.jsxs("label",{className:"block px-2 py-4 pl-8 bg-primary/10 peer-checked:bg-primary peer-checked:text-white",htmlFor:"card",children:["Card ",e.jsx(ke,{className:"ml-1"})]})]})]}),e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",value:"",id:"terms",onChange:l=>f({...n,terms_conditions:l.target.checked})}),e.jsxs("label",{className:"text-sm font-medium form-check-label",htmlFor:"terms",children:["I have read and accept"," ",e.jsx("a",{href:"#",className:"text-primary",children:"Terms & Conditions"})]})]}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",value:"",id:"policies",onChange:l=>f({...n,cancellation_policy:l.target.checked})}),e.jsxs("label",{className:"text-sm font-medium form-check-label",htmlFor:"policies",children:["I agree and understand"," ",e.jsx("a",{href:"#",className:"text-primary",children:"Cancellation Policies"})]})]}),!!b&&e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",value:"",id:"rate_terms",onChange:l=>f({...n,rate_terms:l.target.checked})}),e.jsx("label",{className:"text-sm font-medium form-check-label",htmlFor:"rate_terms",children:b})]}),e.jsx(re,{isExpired:C,isChecked:n,hold_possible:d})]})]})};le.propTypes={hotel:R.object.isRequired,validation_data:R.object.isRequired};const We=()=>{const{site_title:p}=$.useState(),[r]=we(),c=r.get("booking_tracking_id"),{axiosInstance:a}=z(),{user_data:{member_id:o}}=F.useState(),{data:x,isLoading:d,error:s}=J(["HOTEL_VALIDATE",c,o],async()=>{var f,C;const n=await a.post("/hotel/validation-price-get-detail",{member_id:o,booking_tracking_id:c});if(((f=n.data)==null?void 0:f.status)==="success")return n.data;throw{...n,message:((C=n.data)==null?void 0:C.reason)||"Request failed!"}});if(I.useEffect(()=>{q.update(n=>{n.tracking_id=c}),k.update(n=>{n.tracking_id=c})},[c]),d)return e.jsx(ue,{});if(s)throw s;const{hotel_contents:m,...b}=x||{};return e.jsxs("main",{className:"container min-h-screen pt-20",children:[e.jsx(pe,{children:e.jsxs("title",{children:["Hotel Checkout",p?" - "+p:""]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 mb-8 lg:grid-cols-3",children:[e.jsx(ae,{validation_data:x}),e.jsx(le,{hotel:m==null?void 0:m.data,validation_data:b})]})]})};export{We as default};
