import{m as Q,an as F,l as $,e as b,o as e,ao as Y,ap as S,I as Z,y as Se,aq as ke,ar as Ce,as as we,ac as Fe,at as ae,u as Ie,U as se,a1 as ie,G as H,a5 as Te,a6 as Ee}from"./index-9ab0b68e.js";import{P as T,K as De,O as Me,Q as qe,S as Ae,a2 as Pe,x as de,b as me,a3 as Be,U as oe,V as Re,W as Oe,X as Ve,Y as Le,Z as ue,a as pe,w as he,_ as ee,$ as Ue,a0 as le,a1 as He,c as Ye}from"./App-06a0497c.js";import{a as Qe,b as ze,S as Ge,F as We,Q as $e,c as Je}from"./index-4b612751.js";import{A as Ke,a as ce}from"./AccordionItem-fef03212.js";import{T as W}from"./TextInputCheckout-cfe43fd3.js";import{I as re}from"./InputContainerCheckout-50735923.js";import{P as xe}from"./PhoneNumberSelect-b9f80022.js";import{D as te}from"./DateInputCheckout-395019e7.js";import{D as Xe}from"./DropDownSelectCheckout-1dec0b75.js";import{C as Ze}from"./CountryWithCodeSelect-07629dd5.js";import{S as et,E as tt,A as at,a as st,b as rt,c as nt,F as it,d as ot}from"./FlightCancellationPolicyModal-856b8a77.js";import{P as lt}from"./PrimaryTabsWithIcon-32d85c4a.js";import{F as ct}from"./FlightItineraryData-563e73af.js";import"./InputDate-e728ae3b.js";import"./shortcut-buttons-flatpickr.min-168b93b0.js";import"./SingleSelect-d3a2ddf8.js";import"./pp-7d36f836.js";const dt=()=>{const{checkout_form_email_modify:a,checkout_form_contact_modify:i}=Q.useState().booking_manage||{},{isd_code:l,contact_no:g,email_address:o}=F.useState(),{user_data:{member_id:t,mobile:m,email:d,isd_code:u}}=$.useState(n=>n);return b.useEffect(()=>{const n=location.origin;F.update(c=>{c.member_id=t,c.contact_no=m,c.email_address=d,c.isd_code=u,c.redirect_url=`${n}/booking-details/flight`})},[t,m,d,u]),e.jsxs("div",{className:"grid grid-cols-1 gap-3 p-3 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsx(re,{label:"Mobile Number",isRequired:!0,defaultValue:String(l||"")+String(g||""),action:n=>F.update(c=>{c.isd_code=n.isd_code||"",c.contact_no=n.mobile||""}),placeholder:"Enter Mobile Number",Input:xe,readOnly:(i==null?void 0:i.toUpperCase())==="DISABLE"&&!!l,autoFormat:!1}),e.jsx(W,{type:"email",label:"E-mail",action:n=>F.update(c=>{c.email_address=n.target.value}),defaultValue:o,placeholder:"example@mail.com",readOnly:(a==null?void 0:a.toUpperCase())==="DISABLE"&&!!o})]})},be=({pax_id:a,pax_type:i,pax_options:l,isDocOptional:g})=>{var j,N,P,B,R,O,V,D,L,C,p,z,J;const{location_info:{isd_code:o}}=Q.useState(),{doc_required:t,frequent_flyer_selection:m,wheelchair_selection:d,pax_dob_required:u,seat_selection:n,meal_selection:c,baggage_selection:x,passport_scan_selection:I,pax_search_selection:v,pax_email_contact_selection:q}=l||{},[A,E]=b.useState(!1),[f,h]=b.useState(!1),{passenger:r}=Y.useState(s=>s),[_,y]=b.useState(!1),k=["MRS","MISS","MS"];return b.useEffect(()=>{S(a,{gender:"",wheelchair_required:"no",pax_id:a,first_name:"",last_name:"",dob:"",doc_no:"",doc_dateofexpiry:"",doc_dateofissue:"",frequent_flyer:"",contact_no:"",email_address:""})},[a]),b.useEffect(()=>{S(a,{title:i==="ADT"?"MR":"MSTR",pax_type:i,isd_code:o||""})},[a,i,o]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative p-3 pb-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-4",children:[e.jsxs("h6",{className:"font-medium",children:[i==="ADT"?e.jsx(De,{className:"mr-0.5"}):i==="CNN"?e.jsx(Me,{className:"mr-0.5"}):e.jsx(qe,{className:"mr-0.5"})," ",i==="ADT"?"Adult":i==="CNN"?"Child":"Infant"," ","Traveler ",a]}),e.jsxs("div",{className:"flex gap-3 sm:col-span-2 max-lg:-order-1 lg:justify-end",children:[x==="active"&&e.jsx("button",{type:"button",onClick:()=>document.getElementById("baggage_modal").showModal(),className:"normal-case rounded shadow btn btn-square btn-sm btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Additional Baggage",children:e.jsx(Z,{path:Se,size:1.1})}),n==="active"&&e.jsx("button",{type:"button",onClick:()=>document.getElementById("seat_modal").showModal(),className:"normal-case rounded shadow btn btn-square btn-sm btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Select Seat",children:e.jsx(Z,{path:ke,size:.8})}),c==="active"&&e.jsx("button",{type:"button",onClick:()=>document.getElementById("meal_modal").showModal(),className:"normal-case rounded shadow btn btn-square btn-sm btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Select Meal",children:e.jsx(Ae,{className:"w-6 h-6"})}),I==="active"&&e.jsx("button",{type:"button",onClick:()=>E(!0),className:"normal-case rounded shadow btn btn-square btn-sm btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Scan Passport",children:e.jsx(Z,{path:Ce,size:.8})}),v==="active"&&e.jsx("button",{type:"button",onClick:()=>h(!0),className:"normal-case rounded shadow btn btn-sm btn-ghost bg-primary/5 text-primary hover:bg-primary/20 btn-square tooltip tooltip-left tooltip-primary","data-tip":"Existing Passenger",children:e.jsx(Z,{path:we,size:.8})})]})]}),e.jsxs("div",{className:"grid grid-flow-col gap-1 pr-8 mb-3",children:[e.jsx(W,{label:"Surname",isRequired:!0,action:s=>S(a,{last_name:s.target.value}),isUpperCase:!0,defaultValue:((j=r[a])==null?void 0:j.last_name)||"",placeholder:"Doe",maxLength:30}),e.jsx(W,{label:"Name",isRequired:!0,action:s=>S(a,{first_name:s.target.value}),isUpperCase:!0,defaultValue:((N=r[a])==null?void 0:N.first_name)||"",placeholder:"John",maxLength:30}),u!=="no"&&e.jsx("div",{className:"max-w-[90px]",children:e.jsx(te,{label:"DOB",isRequired:u!=="optional",action:s=>S(a,{dob:s}),placeholder:"DOB",defaultValue:(P=r[a])==null?void 0:P.dob})}),e.jsx("div",{className:"max-w-[150px]",children:e.jsx(re,{label:"Mobile",isRequired:!1,defaultValue:String(((B=r[a])==null?void 0:B.isd_code)||"")+String(((R=r[a])==null?void 0:R.contact_no)||""),action:s=>S(a,{isd_code:(s==null?void 0:s.isd_code)||"",contact_no:(s==null?void 0:s.mobile)||""}),action2:a===1?s=>{var K,X;const M=(K=Object.keys(r))==null?void 0:K.length;if(!(M<2))for(let U=2;U<=M;U++)(X=r==null?void 0:r[U])!=null&&X.contact_no||S(U,{isd_code:(s==null?void 0:s.isd_code)||"",contact_no:(s==null?void 0:s.mobile)||""})}:null,placeholder:"Enter Mobile Number",Input:xe,autoFormat:!1})}),e.jsxs("div",{className:"sb-input-container",children:[e.jsx("div",{className:"sb-label",children:"Gender"}),e.jsxs("select",{className:"sb-input min-w-12",value:((O=r[a])==null?void 0:O.gender)||"",onChange:s=>{S(a,{gender:s.target.value,title:s.target.value==="F"?k.includes(r[a].title)===!1?r[a].pax_type==="ADT"?"MRS":"MISS":r[a].title:r[a].pax_type==="ADT"?"MR":"MSTR"})},children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"M",children:"M"}),e.jsx("option",{value:"F",children:"F"})]})]})]}),e.jsx("div",{className:"overflow-visible collapse",open:_,children:e.jsx("div",{className:"p-0 collapse-content",children:e.jsxs("div",{className:"grid gap-1 pr-10 sm:grid-cols-2 lg:grid-cols-6",children:[t!=="no"&&!g&&e.jsxs(e.Fragment,{children:[e.jsx(re,{label:"Country",isRequired:t!=="optional",action:s=>{var M;return S(a,{doc_country:((M=s[0])==null?void 0:M.value)||""})},defaultValue:(V=r[a])==null?void 0:V.doc_country,placeholder:"Country",Input:Ze}),e.jsx(W,{label:"Document No.",isRequired:t!=="optional",action:s=>S(a,{doc_no:s.target.value}),isUpperCase:!0,defaultValue:((D=r[a])==null?void 0:D.doc_no)||"",placeholder:"A0123456789"}),e.jsx(te,{label:"Expiration Date",isRequired:t!=="optional",action:s=>S(a,{doc_dateofexpiry:s}),placeholder:"Expiration Date",defaultValue:(L=r[a])==null?void 0:L.doc_dateofexpiry}),e.jsx(te,{label:"Issue Date",action:s=>S(a,{doc_dateofissue:s}),defaultValue:(C=r[a])==null?void 0:C.doc_dateofissue,placeholder:"Issue Date"})]}),(m==="active"||m==="optional")&&e.jsx(W,{label:"Frequent Flyer Number",isRequired:m==="active",action:s=>S(a,{frequent_flyer:s.target.value}),isUpperCase:!0,defaultValue:((p=r[a])==null?void 0:p.frequent_flyer)||"",placeholder:"Type frequent flyer number"}),(d==="active"||d==="optional")&&e.jsx(Xe,{label:"Wheelchair Required",isRequired:d==="active",options:[{label:"Yes",value:"yes"},{label:"No",value:"no"}],action:s=>{var M;return S(a,{wheelchair_required:((M=s[0])==null?void 0:M.value)||""})},defaultValue:(z=r[a])==null?void 0:z.wheelchair_required,placeholder:"Select"}),q!=="disable"&&e.jsx(W,{type:"email",label:"E-mail",action:s=>S(a,{email_address:s.target.value}),placeholder:"example@mail.com",defaultValue:((J=r[a])==null?void 0:J.email_address)||""})]})})}),e.jsx("button",{onClick:()=>y(!_),className:"absolute border-2 rounded-md bottom-5 btn btn-square btn-secondary btn-xs h-7 w-7 right-2",children:e.jsx(Pe,{className:de("duration-300 transition-all",_?"rotate-180":"rotate-0")})})]}),e.jsx(et,{isOpenScanPassportModal:A,setIsOpenScanPassportModal:E,pax_id:a}),e.jsx(tt,{isOpenExistingPassengerModal:f,setIsOpenExistingPassengerModal:h,pax_id:a})]})};be.propTypes={pax_id:T.number,pax_type:T.string,pax_options:T.object};const mt=()=>{const{save_pax:a}=Y.useState();return e.jsx("div",{className:"flex justify-end px-3 py-4",children:e.jsxs("label",{htmlFor:"save_pax",className:"flex items-center align-middle",children:[e.jsx("input",{autoComplete:"off",type:"checkbox",id:"save_pax",defaultChecked:a==="yes",onChange:i=>Y.update(l=>{l.save_pax=i.target.checked?"yes":"no"}),className:"rounded-sm checkbox checkbox-xs checkbox-primary"}),e.jsx("span",{className:"text-sm select-none",children:"Save Passenger Information"})]})})},ge=({flight_data:a})=>{var h;const{component_version:i}=Q.useState(),{search_parameter:{travelers_adult:l,travelers_adult_age:g,travelers_child:o,travelers_child_age:t,travelers_infants:m,travelers_infants_age:d},pax_options:u,supplier:n,flight_group:c}=a||{},x=n==null?void 0:n.currency,I=c==null?void 0:c.every(r=>{var _;return(_=r==null?void 0:r.routes)==null?void 0:_.every(y=>{var k,j;return((k=y==null?void 0:y.origin_airport)==null?void 0:k.country)==="Bangladesh"&&((j=y==null?void 0:y.destination_airport)==null?void 0:j.country)==="Bangladesh"})}),{seat_selection:v,meal_selection:q,baggage_selection:A,pax_save_option:E}=u||{},f=l+o+m;return e.jsxs(e.Fragment,{children:[e.jsxs(Ke,{className:`w-full mb-8 bg-base-200 ${((h=i==null?void 0:i.flight)==null?void 0:h.checkout)==="2"?"flight-checkout-v2":""}`,children:[e.jsxs(ce,{isOpen:!0,header:"Enter Traveler Details",className:"border-0",disabled:!0,children:[Array(f).fill("").map((r,_)=>{const y=_+1,k=y<=l?"ADT":y-l<=o?"CNN":"INF";return e.jsx(be,{pax_id:y,pax_type:k,pax_options:u,isDocOptional:(x==null?void 0:x.toLowerCase())==="bdt"&&I,age:k==="ADT"?(g==null?void 0:g.at(_))||30:k==="CNN"?(t==null?void 0:t.at(_-l))||10:(d==null?void 0:d.at(_-l-o))||2},Fe())}),E==="active"&&e.jsx(mt,{})]}),e.jsx(ce,{isOpen:!0,header:"Enter Contact Details",className:"border-0",disabled:!0,children:e.jsx(dt,{})})]}),A==="active"&&e.jsx(at,{}),v==="active"&&e.jsx(st,{}),q==="active"&&e.jsx(rt,{})]})};ge.propTypes={flight_data:T.object.isRequired};const ut=[{id:1,name:"Flight Itinerary",value:"flight_itinerary",icon:e.jsx(Le,{})},{id:2,name:"Fare Summary",value:"fare_summary",icon:e.jsx(ue,{})}],pt=[{id:2,name:"Fare Summary",value:"fare_summary",icon:e.jsx(ue,{})}],fe=({flight_data:a})=>{const{user_data:{user_access_level:i}={}}=$.useState(),{system_config:l,supplier_option:g}=Q.useState(),{search_result_version:o}=l||{},t=["1","4","5","7"].includes(o)?ut:pt,{show_supplier_option:m}=g||{},[d,u]=b.useState(t[0].value),{flight_group:n,price_breakdown:c}=a||{},[x,I]=b.useState(!1),v=b.useRef(),q=()=>{v.current.style.maxHeight=0,I(!1)},A=()=>{v.current.style.maxHeight=v.current.scrollHeight+"px",I(!0)},E=()=>{x?q():A()},f=me();return e.jsxs("div",{className:"relative mb-8 rounded-lg bg-base-200",children:[e.jsxs("button",{onClick:()=>f(-1),className:"flex items-center gap-2 px-3 py-3 text-neutral",children:[e.jsx(Be,{}),e.jsx("span",{children:"Back to Result"})]}),e.jsxs("div",{className:de("px-3 pt-3 pb-4",o==="5"&&"pl-0"),children:[e.jsxs("div",{className:"flex flex-col gap-5 justify-evenly sm:flex-row sm:items-center",children:[o==="5"?e.jsx("div",{className:"w-full space-y-2",children:n.map((h,r)=>e.jsx("div",{children:e.jsx(Qe,{singleFlightData:h})},r))}):o==="7"?e.jsx("div",{className:"w-full space-y-2",children:n.map((h,r)=>e.jsx("div",{children:e.jsx(ze,{singleFlightData:h})},r))}):e.jsx("div",{className:"w-full",children:n.map((h,r)=>e.jsxs("div",{children:[r>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(Ge,{singleFlightData:h})]},r))}),e.jsx("div",{className:"flex items-center flex-shrink-0 gap-3 justify-evenly",children:e.jsx("div",{className:"flex gap-2 text-center",children:e.jsx("button",{onClick:E,className:"absolute bottom-0 z-10 min-h-0 font-normal normal-case -translate-x-1/2 translate-y-1/2 rounded shadow btn btn-primary left-1/2 h-9 active:!-translate-x-1/2 active:!translate-y-1/2 no-animation",children:x?e.jsxs(e.Fragment,{children:["Hide Details ",e.jsx(oe,{})]}):e.jsxs(e.Fragment,{children:["View Details ",e.jsx(Re,{})]})})})})]}),e.jsx("div",{className:"flex items-center justify-end mt-4",children:(l==null?void 0:l.show_cart_quotes)==="YES"&&e.jsxs("button",{onClick:()=>ae("quotes",a),className:"addToCartBtn normal-case font-normal btn btn-primary btn-outline border-[#ccc] btn-xs",children:["Quotes",e.jsx(Oe,{})]})}),e.jsx("div",{ref:v,className:"overflow-hidden duration-500 details",style:{maxHeight:0},children:e.jsxs("div",{className:"px-3 py-3 content",children:[e.jsx("hr",{className:"my-4 border"}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between mb-5",children:[e.jsx(lt,{items:["supernsn","administrator"].includes(i)&&m==="YES"?[...t,{id:3,name:"Debug",value:"debug",icon:e.jsx(Ve,{})}]:t,activeTab:d,action:h=>{u(h),setTimeout(()=>{v.current.style.maxHeight=v.current.scrollHeight+"px"},100)}}),e.jsxs("button",{onClick:q,className:"ml-auto text-xs normal-case hideDetailsBtn btn btn-sm rounded-3xl",children:["Hide Details",e.jsx(oe,{})]})]}),d==="flight_itinerary"&&["1","4","5","7"].includes(o)&&e.jsx(ct,{flight_group:n}),d==="fare_summary"&&e.jsx(We,{price_breakdown:c}),d==="debug"&&m==="YES"&&e.jsx("div",{className:"p-3 border rounded-lg",children:e.jsx("pre",{children:JSON.stringify(a,null,3)})})]})})]})]})};fe.propTypes={flight_data:T.object.isRequired};const je=({validation_data:a})=>{const{data:i}=a;return e.jsxs("div",{className:"relative lg:col-span-5",children:[e.jsx(fe,{flight_data:i}),e.jsx(ge,{flight_data:i}),e.jsx($e,{})]})};je.propTypes={validation_data:T.object.isRequired};const ye=({isExpired:a,isChecked:i,hold_possible:l})=>{const g=F.useState(j=>j),{axiosInstance:o}=pe(),[t,m]=b.useState(!1),{payment_type:d}=F.useState(),{booking_tracking_id:u,save_pax:n,passenger:c}=Y.useState(j=>j),{user_data:{login_key:x,member_id:I,user_access_level:v}={}}=$.useState(),{data:q,isLoading:A,isError:E}=he({queryKey:["SERVICE_STATUS",x,I],queryFn:async()=>{var j;try{const N=await o.post("/reports/service-status",{login_key:x,member_id:I});return((j=N==null?void 0:N.data)==null?void 0:j.service_status)||null}catch(N){console.error(N)}}}),f=me(),h=Ie(),r=async()=>{var j,N,P,B,R,O,V;if(!t)try{if(m(!0),i.terms_conditions===!1)throw new Error("Please accept Terms & Conditions");if(i.cancellation_policy===!1)throw new Error("Please accept Cancellation Policy");const D=await o.post("/user/profile",JSON.parse(localStorage.getItem("user_info")));if(!D.data||((j=D.data)==null?void 0:j.status)!=="success"){localStorage.removeItem("user_info"),$.update(p=>{p.token=null,p.user_data=null}),h.invalidateQueries(["SITE_CONFIG"]);return}const L={booking_tracking_id:u,member_id:I,save_pax:n,passenger:Object.values(c)},C=await o.post("/flight/update-travellers",L);if(((N=C==null?void 0:C.data)==null?void 0:N.status)==="success")try{const p=await o.post("/flight/create-booking",g);if(((P=p==null?void 0:p.data)==null?void 0:P.status)==="success")(R=(B=p==null?void 0:p.data)==null?void 0:B.general)!=null&&R.tracking_id?(f(`/booking-details/flight?tracking_id=${p.data.general.tracking_id}`,{replace:!0}),se("success","Booking Successful",C.data.reason),Y.replace(Y._getInitialState()),F.replace(F._getInitialState()),ie.replace(ie._getInitialState())):window.location.replace((O=p.data)==null?void 0:O.payment_link);else throw v==="supernsn"?new Error(p.data.reason+`
`+((V=p.data)==null?void 0:V.reason_admin)):new Error(p.data.reason)}catch(p){(await Ue.fire({title:"Booking Failed",html:p.message,icon:"error",showCancelButton:!1,showCloseButton:!1,confirmButtonColor:"hsl(var(--p)/1)",confirmButtonText:"Go Back",allowOutsideClick:!1})).isConfirmed&&f(-1,{replace:!0})}else throw new Error(C==null?void 0:C.data.reason)}catch(D){console.error(D),se("error","Failed",D.message)}finally{m(!1)}};if(A||E)return e.jsxs("button",{className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",children:[e.jsx(ee,{className:"mr-2 animate-spin"})," Loading..."]});const{block_status:_,flight_block:y,reason:k}=q;return _==="yes"&&y==="yes"?e.jsx("div",{className:"p-3 text-sm border rounded-lg border-error bg-error/10",children:e.jsx("p",{className:"text-error inner-html",dangerouslySetInnerHTML:{__html:k}})}):d?e.jsx(e.Fragment,{children:d==="account_balance"?e.jsx("button",{onClick:r,className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",disabled:a,children:t?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"mr-2 animate-spin"})," Loading..."]}):l==="yes"?"Hold Flight":"Instant Purchase"}):e.jsx("button",{onClick:r,disabled:a,className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",children:t?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"mr-2 animate-spin"})," Loading..."]}):"Pay and Reserve"})}):e.jsx("div",{className:"p-3 text-sm border rounded-lg border-error bg-error/10",children:e.jsx("p",{className:"text-error",children:"You don't have enough balance."})})};ye.propTypes={isExpired:T.bool,isChecked:T.object,hold_possible:T.string};const ve=({session_expire:a,action:i})=>{const{datetime:l,timestamp:g}=a,[o,t]=b.useState(g-Date.now()/1e3);return b.useEffect(()=>{const m=()=>{t(null),i(!0)},d=setInterval(()=>{t(u=>u-1),o<=0&&(clearInterval(d),m())},1e3);return()=>{clearInterval(d)}},[o,i]),e.jsxs("div",{className:"mb-3 overflow-hidden text-sm border rounded-lg session-timeout",children:[e.jsx("h6",{className:"p-1 font-semibold text-center",children:"Session Timeout in"}),e.jsx("div",{className:"p-1",children:e.jsx("div",{className:"flex justify-center gap-4 pb-1 mx-auto text-center",children:o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"time",children:[e.jsx("h5",{className:"text-xl font-semibold text-primary",children:Math.floor(o/60)}),e.jsx("p",{children:"min"})]}),e.jsx("div",{className:"time",children:e.jsx("h5",{className:"text-xl font-semibold text-primary",children:":"})}),e.jsxs("div",{className:"time",children:[e.jsx("h5",{id:"timeout_sec",className:"text-xl font-semibold text-primary",children:Math.floor(o%60)}),e.jsx("p",{children:"sec"})]})]}):e.jsx("h5",{className:"text-xl font-semibold text-primary",children:"Expired"})})})]})};ve.propTypes={session_expire:T.object.isRequired,action:T.func};const _e=({validation_data:a})=>{var B,R,O,V,D,L,C,p,z,J,s,M,K,X,U,ne;const{price_change:i,search_price:l,validation_price:g,session_expire:o,data:{sell:t,hold_possible:m,pax_options:d},terms:u,cancellation_terms:n}=a,{terms_selection:c,cancellation_selection:x}=d||{},[I,v]=b.useState(!1),[q,A]=b.useState(!1),{payment_type:E}=F.useState(),{user_data:f}=$.useState(),[h,r]=b.useState({terms_conditions:!1,cancellation_policy:!1}),[_,y]=b.useState(!1),{price_view:{online_payment_option:k,show_flight_fare_rules:j,show_sell_price:N}={}}=Q.useState();b.useEffect(()=>{var w;((w=t==null?void 0:t.total)==null?void 0:w.amount)>(f==null?void 0:f.balance)&&m==="no"&&(k==="ACTIVE"?F.update(G=>{G.payment_type="card"}):F.update(G=>{G.payment_type=null}))},[(B=t==null?void 0:t.total)==null?void 0:B.amount,f==null?void 0:f.balance,m,k]),b.useEffect(()=>{r({terms_conditions:c==="check"||c==="hide",cancellation_policy:x==="check"||x==="hide"})},[c,x]);const P=w=>{var G;((G=t==null?void 0:t.total)==null?void 0:G.amount)>(f==null?void 0:f.balance)&&m==="no"?(w.preventDefault(),w.target.value==="account_balance"?se("error","Insufficient Balance","Please add balance to your account"):w.target.click()):F.update(Ne=>{Ne.payment_type=w.target.value})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"p-3 mb-3 rounded-lg bg-base-200",children:[(N==null?void 0:N.toUpperCase())==="YES"&&e.jsxs("div",{className:"p-3 mb-3 text-sm border rounded",children:[e.jsxs("h6",{className:"mb-2 font-semibold",children:[e.jsx(le,{className:"mr-1"})," Price: ",i]}),e.jsxs("p",{children:["Updated Price: ",H(g.currency)," ",g.amount]}),e.jsxs("p",{children:["Search Price: ",H(l.currency)," ",l.amount]})]}),j==="YES"&&e.jsxs("div",{className:"p-3 mb-3 text-sm border rounded",children:[e.jsxs("h6",{className:"mb-2 font-semibold",children:[e.jsx(le,{className:"mr-1"})," Fare Rules & Policy"]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("button",{onClick:()=>ae("fare_rules",a),className:"inline-flex text-primary hover:underline",children:"Penalty and Cancellation Information"}),e.jsx("button",{onClick:()=>ae("fare_rules",a),className:"inline-flex text-primary hover:underline",children:"Flight Fare rules"})]})]}),e.jsx(ve,{session_expire:o,action:w=>y(w)}),e.jsxs("div",{className:"p-3 mb-3 text-sm border rounded",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Fare/Pax type"}),e.jsx("p",{className:"font-medium",children:"Amount"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Base Fare"}),e.jsxs("p",{className:"font-medium",children:[H((R=t==null?void 0:t.base_fare)==null?void 0:R.currency)," ",(V=Number((O=t==null?void 0:t.base_fare)==null?void 0:O.amount))==null?void 0:V.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Tax"}),e.jsxs("p",{className:"font-medium",children:[H((D=t==null?void 0:t.tax)==null?void 0:D.currency)," ",(C=Number((L=t==null?void 0:t.tax)==null?void 0:L.amount))==null?void 0:C.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Total"}),e.jsxs("p",{className:"font-medium",children:[H((p=t==null?void 0:t.total)==null?void 0:p.currency)," ",(J=Number((z=t==null?void 0:t.total)==null?void 0:z.amount))==null?void 0:J.toFixed(2)]})]}),e.jsx("hr",{className:"mb-3 border border-neutral/20"}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Total Fare"}),e.jsx("p",{className:"font-medium",children:"Amount"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("p",{children:"Total Published Fare"}),e.jsxs("p",{className:"font-medium",children:[H((s=t==null?void 0:t.total)==null?void 0:s.currency)," ",(K=Number((M=t==null?void 0:t.total)==null?void 0:M.amount))==null?void 0:K.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 mb-3 border rounded-lg text-primary",children:[e.jsx("p",{children:"Total Payable"}),e.jsxs("p",{className:"font-medium fs-4",children:[H((X=t==null?void 0:t.total)==null?void 0:X.currency)," ",(ne=Number((U=t==null?void 0:t.total)==null?void 0:U.amount))==null?void 0:ne.toFixed(2)]})]}),e.jsxs("div",{className:"grid gap-3 mb-3 sm:grid-flow-col lg:grid-flow-row xl:grid-flow-col payment-selection",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("input",{autoComplete:"off",type:"radio",className:"absolute -translate-y-1/2 radio radio-xs radio-primary left-2 top-1/2 peer",name:"payment",id:"balance",value:"account_balance",defaultChecked:E==="account_balance",onClick:P}),e.jsx("label",{htmlFor:"balance",className:"block px-2 py-4 pl-8 text-nowrap bg-primary/10 peer-checked:bg-primary peer-checked:text-white",children:"Account Balance"})]}),k==="ACTIVE"&&e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("input",{autoComplete:"off",type:"radio",className:"absolute -translate-y-1/2 radio radio-primary radio-xs top-1/2 left-2 peer",name:"payment",id:"card",value:"card",defaultChecked:E==="card",onClick:P}),e.jsxs("label",{className:"block px-2 py-4 pl-8 bg-primary/10 peer-checked:bg-primary peer-checked:text-white",htmlFor:"card",children:["Card ",e.jsx(He,{className:"ml-1"})]})]})]}),c!=="hide"&&e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",checked:h.terms_conditions,id:"terms",onChange:w=>r({...h,terms_conditions:w.target.checked})}),e.jsxs("label",{className:"text-sm font-medium form-check-label",htmlFor:"terms",children:["I have read and accept all"," ",e.jsx("button",{onClick:()=>(u==null?void 0:u.status)==="active"&&v(!0),className:"inline text-primary",children:"Terms & Conditions"})]})]}),x!=="hide"&&e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",checked:h.cancellation_policy,id:"policies",onChange:w=>r({...h,cancellation_policy:w.target.checked})}),e.jsxs("label",{className:"text-sm font-medium form-check-label",htmlFor:"policies",children:["I agree and understand the"," ",e.jsx("button",{onClick:()=>(n==null?void 0:n.status)==="active"&&A(!0),className:"inline text-primary",children:"Cancellation Policies"})]})]}),e.jsx(ye,{isExpired:_,isChecked:h,hold_possible:m}),e.jsx(nt,{})]})}),e.jsx(it,{isActive:I,setIsActive:v,data:u}),e.jsx(ot,{isActive:q,setIsActive:A,data:n})]})};_e.propTypes={validation_data:T.object.isRequired};const Et=()=>{const[a]=Ye(),{site_title:i}=Q.useState(),l=a.get("tracking_id"),{price_view:{show_flight_fare_rules:g}={}}=Q.useState(),{user_data:{member_id:o}}=$.useState(),{axiosInstance:t}=pe(),{data:m,isLoading:d,error:u}=he(["VALIDATION_DATA",l,o],async()=>{var c,x;const n=await t.post("/flight/validation-get-status",{booking_tracking_id:l,member_id:o});if(((c=n.data)==null?void 0:c.status)==="success")return n.data;throw{...n,message:((x=n.data)==null?void 0:x.reason)||"Request failed!"}});if(b.useEffect(()=>{Y.update(n=>{n.booking_tracking_id=l}),F.update(n=>{n.booking_tracking_id=l})},[l]),d)return e.jsx(Te,{});if(u)throw u;return e.jsxs(e.Fragment,{children:[e.jsx(Ee,{children:e.jsxs("title",{children:["Flight Checkout",i?" - "+i:""]})}),e.jsx("main",{className:"container min-h-screen pt-20",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 pt-2 mb-8 lg:grid-cols-7",children:[e.jsx(je,{validation_data:m}),e.jsx(_e,{validation_data:m})]})}),g==="YES"&&e.jsx(Je,{})]})};export{Et as default};
