import{o as U,e as m,m as A,q as e,a5 as z,ab as K,T as D}from"./index-c8ac75dd.js";import{d as q,e as O,p as Q,L as E,c as f,dj as I,m as G,j as J,ad as V,dk as W}from"./App-b4275d2d.js";import{u as X}from"./index.esm-147e3fb4.js";const Y=["supernsn","administrator","manager","report"],Z=["supernsn","administrator"],ee=({email:b})=>{const[i,y]=m.useState(!1),{axiosInstance:t}=q(),{general:p}=U.useState(o=>o.component_version)||{},a=p==null?void 0:p.team,l=async o=>{var d,j,g;if(i)return;y(!0);const M=window.location.origin;try{const u={random_key:K().slice(0,8),email:o,password_reset_url:`${M}/reset-password`},x=await t.post("/user/password-reset",u);if(((d=x.data)==null?void 0:d.status)==="success")D("success","Success",(j=x.data)==null?void 0:j.reason);else throw new Error(((g=x.data)==null?void 0:g.reason)||"Something went wrong")}catch(u){D("error","Failed!",u.message)}finally{y(!1)}};return e.jsx("button",{type:"button",onClick:()=>l(b),className:f("text-white normal-case rounded btn btn-warning btn-xs",i?"btn-outline":""),title:"Send Password",children:a==="3"?e.jsx(e.Fragment,{children:i?e.jsx("span",{className:"animate-spin",children:e.jsx(X,{})}):e.jsx(W,{className:"-rotate-45"})}):e.jsx(e.Fragment,{children:i?"Processing...":"Send Password"})})},re=()=>{var T,k,F,B;const{site_title:b,component_version:i}=U.useState(),{axiosInstance:y}=q(),[t,p]=m.useState([]),[a,l]=m.useState(1),[o,M]=m.useState(""),[d,j]=m.useState(0),{user_data:{login_key:g,member_id:u,email:x}}=A.useState(),{data:h,isLoading:H,error:P}=O({queryKey:["TEAM_MEMBERS",g,u],queryFn:async()=>{const r=await y.post("/user/team-members",{login_key:g,member_id:u});return j(Math.ceil(r.data.length/10)),r.data}});m.useEffect(()=>{var c;if(!h)return;const r=[],n=(c=o==null?void 0:o.toLowerCase())==null?void 0:c.trim();let v=0;h.forEach(s=>{var w,S,_,R;((S=(w=s==null?void 0:s.fullname)==null?void 0:w.toLowerCase())!=null&&S.includes(n)||(R=(_=s==null?void 0:s.email)==null?void 0:_.toLowerCase())!=null&&R.includes(n)||((s==null?void 0:s.isd_code)+(s==null?void 0:s.mobile)).includes(n))&&(s.index=v+1,r.push(s),v++)}),j(Math.ceil(r.length/10));const N=r.slice((a-1)*10,(a-1)*10+10);p(N)},[h,a,o]);const $=r=>{r.preventDefault();const n=r.target.search.value;l(1),M(n)},{user_access_level:L}=((T=A.useState())==null?void 0:T.user_data)||{};if(P)throw P;const C=(k=i==null?void 0:i.general)==null?void 0:k.team;return e.jsxs(e.Fragment,{children:[e.jsx(z,{children:e.jsxs("title",{children:[C==="2"?"Team Members":"Users List"," Team Members",b?" - "+b:""]})}),e.jsx("div",{className:"mb-8 sm:col-span-3 lg:col-span-4",children:H?e.jsxs("div",{className:"flex items-center justify-center h-full gap-2 text-xl",children:[e.jsx(V,{className:"mr-2 animate-spin text-primary"})," ","Loading..."]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col justify-between gap-4 mb-5 md:items-center md:flex-row",children:[e.jsxs("div",{className:"py-3",children:[e.jsx("h3",{className:"text-lg font-medium",children:C==="2"?"Team Members":"Users List"}),e.jsx("p",{className:"text-sm text-neutral",children:"Reset team member password or update profile"})]}),e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs("form",{onSubmit:$,className:"rounded join focus-within:ring-1 ring-primary",children:[e.jsx("input",{autoComplete:"off",type:"text",name:"search",placeholder:"Type name/email/phone number",className:"h-10 min-h-0 text-sm bg-transparent rounded join-item input input-bordered focus:outline-0"}),e.jsx("button",{type:"submit",className:"h-10 min-h-0 rounded join-item btn btn-primary",children:e.jsx(Q,{})})]}),["supernsn","administrator"].includes(L)&&e.jsxs(E,{to:"/settings/create-member",className:"h-10 normal-case rounded btn btn-primary btn-outline min-h-8",children:["Add New ",C==="2"?"Member":"User"]})]})]}),e.jsxs("div",{className:"overflow-auto",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table max-sm:!text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-sm font-medium uppercase text-base-content",children:[e.jsx("th",{children:"Sl"}),e.jsx("th",{children:"User Details"}),e.jsx("th",{children:"Login Email"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:(t==null?void 0:t.length)>0?t.map((r,n)=>{const{user_pic:v,status:N,email:c,fullname:s,user_access_level_title:w,team_member_id:S,index:_}=r;return e.jsxs("tr",{className:"duration-200 cursor-pointer hover:bg-base-100 group",children:[e.jsx("td",{className:"border-0 border-y-8 border-y-base-100 bg-base-200 group-hover:bg-[#eff5f9] duration-200",children:_}),e.jsx("td",{className:"border-0 border-y-8 border-y-base-100 bg-base-200 group-hover:bg-[#eff5f9] duration-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-12 h-12 rounded-full border p-0.5",children:e.jsx("img",{src:v,alt:"",className:"rounded-full"})})}),e.jsxs("div",{className:"text-start",children:[e.jsx("p",{className:"text-sm",children:s}),e.jsx("p",{className:"text-xs",children:w})]})]})}),e.jsx("td",{className:"border-0 text-start border-y-8 border-y-base-100 bg-base-200 group-hover:bg-[#eff5f9] duration-200",children:e.jsx("p",{children:c})}),e.jsx("td",{className:"border-0 border-y-8 border-y-base-100 bg-base-200 group-hover:bg-[#eff5f9] duration-200",children:e.jsxs("div",{className:"flex items-center justify-between gap-5 overflow-hidden",children:[e.jsx("div",{className:f("badge text-white text-xs rounded border-transparent capitalize",N==="active"?"badge-success bg-success/10 text-success":"badge-warning bg-warning/10 text-warning"),children:N}),e.jsxs("div",{className:"flex justify-center gap-3 duration-200 translate-x-full opacity-0 lg:pr-5 group-hover:translate-x-0 group-hover:opacity-100 max-sm:opacity-100 max-sm:translate-x-0",children:[x!==c&&Y.includes(L)&&e.jsx(ee,{email:c}),x===c?e.jsx(E,{to:"/user/profile",className:"text-white normal-case rounded btn btn-error btn-xs",title:"Modify",children:e.jsx(I,{})}):Z.includes(L)?e.jsx(E,{to:`/settings/team/${S}`,className:"text-white normal-case rounded btn btn-primary btn-xs",title:"Modify",children:e.jsx(I,{})}):null]})]})})]},c+n)}):e.jsx("tr",{children:e.jsx("td",{className:"py-5 text-center text-error",colSpan:"100%",children:"No Data"})})})]})}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsxs("div",{className:"text-xs",children:["Showing ",(F=t==null?void 0:t.at(0))==null?void 0:F.index," to"," ",(B=t==null?void 0:t.at(-1))==null?void 0:B.index," of ",h==null?void 0:h.length," ","entries"]}),e.jsxs("div",{className:"flex justify-end text-sm gap-0.5",children:[e.jsx("div",{onClick:()=>a>1&&l(a-1),className:f("inline-flex items-center justify-center w-8 duration-100 cursor-pointer h-7 hover:bg-neutral/10 opacity-0 pointer-events-none",a>1&&"opacity-100 pointer-events-auto"),children:e.jsx(G,{})}),[...Array(d)].map((r,n)=>e.jsx("div",{onClick:()=>l(n+1),className:f("inline-flex items-center justify-center w-8 duration-100 cursor-pointer h-7 hover:bg-neutral/10",n+1===a?"bg-neutral/10":""),children:n+1},n)),e.jsx("div",{onClick:()=>a<d&&l(a+1),className:f("inline-flex items-center justify-center w-8 duration-100 cursor-pointer h-7 hover:bg-neutral/10 opacity-0 pointer-events-none",a<d&&"opacity-100 pointer-events-auto"),children:e.jsx(J,{})})]})]})]})]})})]})};export{re as default};
