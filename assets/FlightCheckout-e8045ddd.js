import{m as G,an as k,l as W,e as f,o as e,ao as U,Q as we,ap as N,I as ee,y as Ce,aq as Fe,ar as ke,as as Me,U as Z,ac as Ie,at as se,u as De,a1 as oe,G as Q,a5 as Te,a6 as Ee}from"./index-c420ef0b.js";import{P as T,K as qe,O as Pe,Q as Re,S as Ae,a as le,T as Be,H as Oe,U as ce,V as Ve,W as Le,X as Ue,Y as He,Z as xe,w as ge,b as Ye,_ as ae,$ as de,a0 as me,a1 as Qe,c as Ge}from"./App-7d589f36.js";import{S as We,a as ze,b as Je,F as $e,Q as Ke,c as Xe}from"./index-d98f079e.js";import{A as Ze,a as ue}from"./AccordionItem-bfe7535f.js";import{T as K}from"./TextInputCheckout-741bb208.js";import{I as re}from"./InputContainerCheckout-a5609bf7.js";import{P as be}from"./PhoneNumberSelect-41df5fb4.js";import{D as te}from"./DateInputCheckout-b19406d6.js";import{D as ea}from"./DropDownSelectCheckout-49e9e4a7.js";import{R as pe}from"./RadioInputCheckout-c66cf26d.js";import{C as aa}from"./CountryWithCodeSelect-93c9693f.js";import{S as ta,E as sa,A as ra,a as la,b as na,P as ia,c as oa,F as ca,d as da}from"./FlightCancellationPolicyModal-0017f312.js";import{S as ma,M as he,a as ua}from"./MultipleFlight2-ac05941a.js";import{P as pa}from"./PrimaryTabsWithIcon-aaa98e0d.js";import{F as ha}from"./FlightItineraryData-61543ad7.js";import{S as xa}from"./SessionTimeOut-f6b0def1.js";import{w as ga}from"./sweetalert2-react-content.es-e6d0ce78.js";import"./InputDate-9af928ff.js";import"./shortcut-buttons-flatpickr.min-77ba4a50.js";import"./SingleSelect-0f8ec965.js";import"./pp-b04e4a77.js";const ba=()=>{const{checkout_form_email_modify:a,checkout_form_contact_modify:o}=G.useState().booking_manage||{},{isd_code:u,contact_no:g,email_address:c}=k.useState(),{user_data:{member_id:t,mobile:p,email:h,isd_code:d}}=W.useState(s=>s);return f.useEffect(()=>{const s=location.origin;k.update(i=>{i.member_id=t,i.contact_no=p,i.email_address=h,i.isd_code=d,i.redirect_url=`${s}/booking-details/flight`})},[t,p,h,d]),e.jsxs("div",{className:"grid grid-cols-1 gap-3 p-3 sm:grid-cols-2",children:[e.jsx(re,{label:"Mobile Number",isRequired:!0,defaultValue:String(u||"")+String(g||""),action:s=>k.update(i=>{i.isd_code=s.isd_code||"",i.contact_no=s.mobile||""}),placeholder:"Enter Mobile Number",Input:be,readOnly:(o==null?void 0:o.toUpperCase())==="DISABLE"&&!!u}),e.jsx(K,{type:"email",label:"E-mail",action:s=>k.update(i=>{i.email_address=s.target.value}),defaultValue:c,placeholder:"example@mail.com",readOnly:(a==null?void 0:a.toUpperCase())==="DISABLE"&&!!c})]})},fe=({pax_id:a,pax_type:o,pax_options:u,isDocOptional:g,age:c})=>{var J,q,_,w,R,A,B,O,I,H,F,x,V,Y,X;const{location_info:{country_code:t,isd_code:p}}=G.useState(),{doc_required:h,frequent_flyer_selection:d,wheelchair_selection:s,pax_dob_required:i,seat_selection:b,meal_selection:y,baggage_selection:S,passport_scan_selection:M,pax_search_selection:E,pax_email_contact_selection:D}=u||{},[C,l]=f.useState(!1),[r,v]=f.useState(!1),{passenger:m}=U.useState(n=>n),z=["MRS","MISS","MS"],P=we().subtract(c,"years").format("YYYY-MM-DD");return f.useEffect(()=>{N(a,{gender:"M",wheelchair_required:"no",pax_id:a,first_name:"",last_name:"",dob:P,doc_no:"",doc_dateofexpiry:"",doc_dateofissue:"",frequent_flyer:"",contact_no:"",email_address:""})},[a,P]),f.useEffect(()=>{N(a,{title:o==="ADT"?"MR":"MSTR",pax_type:o,doc_country:t||"",isd_code:p||""})},[a,o,t,p]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-3",children:[e.jsxs("h6",{className:"mb-4 font-medium",children:[o==="ADT"?e.jsx(qe,{className:"mr-0.5"}):o==="CNN"?e.jsx(Pe,{className:"mr-0.5"}):e.jsx(Re,{className:"mr-0.5"})," ",o==="ADT"?"Adult":o==="CNN"?"Child":"Infant"," ","Traveler ",a]}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"grid gap-3 sm:col-span-2 sm:grid-cols-2 lg:col-span-3 lg:grid-cols-4",children:[e.jsx(pe,{label:"Title",isRequired:!0,defaultValue:((q=(J=m[a])==null?void 0:J.title)==null?void 0:q.toUpperCase())||"MR",action:n=>{N(a,{title:n.target.value,gender:z.includes(n.target.value)?m[a].gender!=="F"?"F":m[a].gender:"M"})},options:o==="ADT"?[{label:"Mr",value:"MR"},{label:"Mrs",value:"MRS"},{label:"Ms",value:"MS"}]:[{label:"Mstr",value:"MSTR"},{label:"Miss",value:"MISS"}]}),e.jsx(pe,{label:"Gender",isRequired:!0,defaultValue:((_=m[a])==null?void 0:_.gender)||"M",action:n=>N(a,{gender:n.target.value,title:n.target.value==="F"?z.includes(m[a].title)===!1?m[a].pax_type==="ADT"?"MRS":"MISS":m[a].title:m[a].pax_type==="ADT"?"MR":"MSTR"}),options:[{label:"Male",value:"M"},{label:"Female",value:"F"}]}),e.jsxs("div",{className:"flex gap-3 sm:col-span-2 max-lg:-order-1 lg:justify-end",children:[S==="active"&&e.jsx("button",{type:"button",onClick:()=>document.getElementById("baggage_modal").showModal(),className:"normal-case shadow btn btn-square btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Additional Baggage",children:e.jsx(ee,{path:Ce,size:1.1})}),b==="active"&&e.jsx("button",{type:"button",onClick:()=>document.getElementById("seat_modal").showModal(),className:"normal-case shadow btn btn-square btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Select Seat",children:e.jsx(ee,{path:Fe,size:1.1})}),y==="active"&&e.jsx("button",{type:"button",onClick:()=>document.getElementById("meal_modal").showModal(),className:"normal-case shadow btn btn-square btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Select Meal",children:e.jsx(Ae,{className:"w-6 h-6"})}),M==="active"&&e.jsx("button",{type:"button",onClick:()=>l(!0),className:"normal-case shadow btn btn-square btn-ghost bg-primary/5 text-primary hover:bg-primary/20 tooltip tooltip-bottom tooltip-primary","data-tip":"Scan Passport",children:e.jsx(ee,{path:ke,size:1.1})}),E==="active"&&e.jsx("button",{type:"button",onClick:()=>v(!0),className:"normal-case shadow btn btn-ghost bg-primary/5 text-primary hover:bg-primary/20 btn-square tooltip tooltip-left tooltip-primary","data-tip":"Existing Passenger",children:e.jsx(ee,{path:Me,size:1.1})})]})]}),e.jsx(K,{label:"First/Given Name",isRequired:!0,action:n=>N(a,{first_name:n.target.value}),isUpperCase:!0,defaultValue:((w=m[a])==null?void 0:w.first_name)||"",placeholder:"John",maxLength:30}),e.jsx(K,{label:"Surname/Family/Last Name",isRequired:!0,action:n=>N(a,{last_name:n.target.value}),isUpperCase:!0,defaultValue:((R=m[a])==null?void 0:R.last_name)||"",placeholder:"Doe",maxLength:30}),i!=="no"&&e.jsx(te,{label:"Date of Birth",isRequired:i!=="optional",action:n=>N(a,{dob:n}),placeholder:"Select Date of birth",defaultValue:(A=m[a])==null?void 0:A.dob}),h!=="no"&&!g&&e.jsxs(e.Fragment,{children:[e.jsx(re,{label:"Document Issue Country",isRequired:h!=="optional",action:n=>{var L;return N(a,{doc_country:((L=n[0])==null?void 0:L.value)||""})},defaultValue:(B=m[a])==null?void 0:B.doc_country,placeholder:"Select Country",Input:aa}),e.jsx(K,{label:"Document Number",isRequired:h!=="optional",action:n=>N(a,{doc_no:n.target.value}),isUpperCase:!0,defaultValue:((O=m[a])==null?void 0:O.doc_no)||"",placeholder:"A0123456789"}),e.jsx(te,{label:"Expiration Date",isRequired:h!=="optional",action:n=>N(a,{doc_dateofexpiry:n}),placeholder:"Select Date",defaultValue:(I=m[a])==null?void 0:I.doc_dateofexpiry}),e.jsx(te,{label:"Date of Document Issuance",action:n=>N(a,{doc_dateofissue:n}),defaultValue:(H=m[a])==null?void 0:H.doc_dateofissue,placeholder:"Select Date"})]}),(d==="active"||d==="optional")&&e.jsx(K,{label:"Frequent Flyer Number",isRequired:d==="active",action:n=>N(a,{frequent_flyer:n.target.value}),isUpperCase:!0,defaultValue:((F=m[a])==null?void 0:F.frequent_flyer)||"",placeholder:"Type frequent flyer number"}),(s==="active"||s==="optional")&&e.jsx(ea,{label:"Wheelchair Required",isRequired:s==="active",options:[{label:"Yes",value:"yes"},{label:"No",value:"no"}],action:n=>{var L;return N(a,{wheelchair_required:((L=n[0])==null?void 0:L.value)||""})},defaultValue:(x=m[a])==null?void 0:x.wheelchair_required,placeholder:"Select"}),D!=="disable"&&e.jsxs(e.Fragment,{children:[e.jsx(re,{label:"Mobile Number",isRequired:!1,defaultValue:String(((V=m[a])==null?void 0:V.isd_code)||"")+String(((Y=m[a])==null?void 0:Y.contact_no)||""),action:n=>N(a,{isd_code:(n==null?void 0:n.isd_code)||"",contact_no:(n==null?void 0:n.mobile)||""}),placeholder:"Enter Mobile Number",Input:be}),e.jsx(K,{type:"email",label:"E-mail",action:n=>N(a,{email_address:n.target.value}),placeholder:"example@mail.com",defaultValue:((X=m[a])==null?void 0:X.email_address)||""})]})]})]}),e.jsx(ta,{isOpenScanPassportModal:C,setIsOpenScanPassportModal:l,pax_id:a}),e.jsx(sa,{isOpenExistingPassengerModal:r,setIsOpenExistingPassengerModal:v,pax_id:a})]})};fe.propTypes={pax_id:T.number,pax_type:T.string,pax_options:T.object};const fa=()=>{const{save_pax:a}=U.useState(),{booking_tracking_id:o,passenger:u}=U.useState(d=>d),[g,c]=f.useState(!1),{member_id:t}=W.useState(d=>d.user_data)||{},{axiosInstance:p}=le(),h=async()=>{var s;if(g)return;c(!0);const d={booking_tracking_id:o,member_id:t,save_pax:"yes",passenger:Object.values(u)};try{const i=await p.post("/flight/update-travellers",d);((s=i==null?void 0:i.data)==null?void 0:s.status)==="success"&&Z("success","Saved!",i.data.reason)}catch(i){Z("error","Failed!",i.message)}finally{c(!1)}};return e.jsxs("div",{className:"flex justify-end gap-4 px-3 py-4",children:[e.jsxs("label",{htmlFor:"save_pax",className:"flex items-center align-middle",children:[e.jsx("input",{autoComplete:"off",type:"checkbox",id:"save_pax",defaultChecked:a==="yes",onChange:d=>U.update(s=>{s.save_pax=d.target.checked?"yes":"no"}),className:"w-3.5 h-3.5 rounded-sm checkbox checkbox-primary"}),e.jsx("span",{className:"text-xs select-none",children:"Save Passenger Information for later"})]}),e.jsx("button",{onClick:h,className:"font-normal normal-case rounded btn btn-sm btn-primary",children:g?e.jsx(Be,{className:"animate-spin"}):"Save Passenger"})]})},je=({flight_data:a})=>{const{search_parameter:{travelers_adult:o,travelers_adult_age:u,travelers_child:g,travelers_child_age:c,travelers_infants:t,travelers_infants_age:p},pax_options:h,supplier:d,flight_group:s}=a||{},i=d==null?void 0:d.currency,b=s==null?void 0:s.every(C=>{var l;return(l=C==null?void 0:C.routes)==null?void 0:l.every(r=>{var v,m;return((v=r==null?void 0:r.origin_airport)==null?void 0:v.country)==="Bangladesh"&&((m=r==null?void 0:r.destination_airport)==null?void 0:m.country)==="Bangladesh"})}),{seat_selection:y,meal_selection:S,baggage_selection:M,pax_save_option:E}=h||{},D=o+g+t;return e.jsxs(e.Fragment,{children:[e.jsxs(Ze,{className:"w-full mb-8 bg-base-200 shadow-md",children:[e.jsxs(ue,{isOpen:!0,header:"Enter Traveler Details",children:[Array(D).fill("").map((C,l)=>{const r=l+1,v=r<=o?"ADT":r-o<=g?"CNN":"INF";return e.jsx(fe,{pax_id:r,pax_type:v,pax_options:h,isDocOptional:(i==null?void 0:i.toLowerCase())==="bdt"&&b,age:v==="ADT"?(u==null?void 0:u.at(l))||30:v==="CNN"?(c==null?void 0:c.at(l-o))||10:(p==null?void 0:p.at(l-o-g))||2},Ie())}),E==="active"&&e.jsx(fa,{})]}),e.jsx(ue,{isOpen:!0,header:"Enter Contact Details",children:e.jsx(ba,{})})]}),M==="active"&&e.jsx(ra,{}),y==="active"&&e.jsx(la,{}),S==="active"&&e.jsx(na,{})]})};je.propTypes={flight_data:T.object.isRequired};const ja=[{id:1,name:"Flight Itinerary",value:"flight_itinerary",icon:e.jsx(He,{})},{id:2,name:"Fare Summary",value:"fare_summary",icon:e.jsx(xe,{})}],ya=[{id:2,name:"Fare Summary",value:"fare_summary",icon:e.jsx(xe,{})}],ye=({flight_data:a})=>{const{user_data:{user_access_level:o}={}}=W.useState(),{system_config:u,supplier_option:g}=G.useState(),{search_result_version:c}=u||{},t=["1","4","5","7"].includes(c)?ja:ya,{show_supplier_option:p}=g||{},[h,d]=f.useState(t[0].value),{flight_group:s,price_breakdown:i}=a||{},[b,y]=f.useState(!1),S=f.useRef(),M=()=>{S.current.style.maxHeight=0,y(!1)},E=()=>{S.current.style.maxHeight=S.current.scrollHeight+"px",y(!0)},D=()=>{b?M():E()},C=Oe.useMediaQuery({query:"(max-width: 640px)"});return e.jsxs("div",{className:"relative px-3 py-4 mb-8 border-t rounded-lg shadow-md border-base-300 bg-base-200",children:[e.jsxs("div",{className:"flex flex-col gap-5 justify-evenly sm:flex-row sm:items-center",children:[c==="1"&&e.jsx("div",{className:"w-full",children:s.map((l,r)=>e.jsxs("div",{children:[r>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(ma,{singleFlightData:l})]},r))}),c==="2"&&e.jsx("div",{className:"w-full",children:s.map((l,r)=>e.jsxs("div",{className:"flex flex-col gap-8",children:[r>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(he,{singleFlightData:l})]},r))}),["3","6"].includes(c)&&e.jsx(e.Fragment,{children:C?e.jsx("div",{className:"w-full",children:s.map((l,r)=>e.jsxs("div",{className:"flex flex-col gap-8",children:[r>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(he,{singleFlightData:l})]},r))}):e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-5 p-1 mb-2 text-sm font-semibold text-center rounded sm:items-center bg-neutral/5 text-neutral",children:[e.jsx("div",{children:"Airline"}),e.jsx("div",{children:"Details"}),e.jsx("div",{children:"Departure"}),e.jsx("div",{children:"Arrival"}),e.jsx("div",{children:"Duration"}),e.jsx("div",{children:"Baggage"})]}),s.map((l,r)=>e.jsxs("div",{className:"flex flex-col gap-4",children:[r>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(ua,{singleFlightData:l})]},r))]})}),c==="4"&&e.jsx("div",{className:"w-full",children:s.map((l,r)=>e.jsxs("div",{children:[r>0&&e.jsx("hr",{className:"my-4 border"}),e.jsx(We,{singleFlightData:l})]},r))}),c==="5"&&e.jsx("div",{className:"w-full space-y-2",children:s.map((l,r)=>e.jsx("div",{children:e.jsx(ze,{singleFlightData:l})},r))}),c==="7"&&e.jsx("div",{className:"w-full space-y-2",children:s.map((l,r)=>e.jsx("div",{children:e.jsx(Je,{singleFlightData:l})},r))}),e.jsx("div",{className:"flex items-center flex-shrink-0 gap-3 justify-evenly",children:e.jsx("div",{className:"flex gap-2 text-center",children:e.jsx("button",{onClick:D,className:"viewDetailsBtn text-nowrap shadow-sm absolute left-1/2 top-full -translate-x-1/2 bg-white text-xs p-0.5 before:content-[''] before:absolute before:top-0 before:left-[-30px] before:border-r-[30px] before:border-r-white before:border-b-[20px] before:border-b-transparent after:content-[''] after:absolute after:top-0 after:right-[-30px] after:border-l-[30px] after:border-l-white after:border-b-[20px] after:border-b-transparent",children:b?e.jsxs(e.Fragment,{children:["Hide Details ",e.jsx(ce,{})]}):e.jsxs(e.Fragment,{children:["View Details ",e.jsx(Ve,{})]})})})})]}),e.jsx("div",{className:"flex items-center justify-end mt-4",children:(u==null?void 0:u.show_cart_quotes)==="YES"&&e.jsxs("button",{onClick:()=>se("quotes",a),className:"addToCartBtn normal-case font-normal btn btn-primary btn-outline border-[#ccc] btn-xs",children:["Quotes",e.jsx(Le,{})]})}),e.jsx("div",{ref:S,className:"overflow-hidden duration-500 details",style:{maxHeight:0},children:e.jsxs("div",{className:"px-3 py-3 content",children:[e.jsx("hr",{className:"my-4 border"}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between mb-5",children:[e.jsx(pa,{items:["supernsn","administrator"].includes(o)&&p==="YES"?[...t,{id:3,name:"Debug",value:"debug",icon:e.jsx(Ue,{})}]:t,activeTab:h,action:l=>{d(l),setTimeout(()=>{S.current.style.maxHeight=S.current.scrollHeight+"px"},100)}}),e.jsxs("button",{onClick:M,className:"ml-auto text-xs normal-case hideDetailsBtn btn btn-sm rounded-3xl",children:["Hide Details",e.jsx(ce,{})]})]}),h==="flight_itinerary"&&["1","4","5","7"].includes(c)&&e.jsx(ha,{flight_group:s}),h==="fare_summary"&&e.jsx($e,{price_breakdown:i}),h==="debug"&&p==="YES"&&e.jsx("div",{className:"p-3 border rounded-lg",children:e.jsx("pre",{children:JSON.stringify(a,null,3)})})]})})]})};ye.propTypes={flight_data:T.object.isRequired};const ve=({validation_data:a})=>{const{data:o}=a;return e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx(ye,{flight_data:o}),e.jsx(je,{flight_data:o}),e.jsx(Ke,{})]})};ve.propTypes={validation_data:T.object.isRequired};const _e=({isExpired:a,isChecked:o,hold_possible:u})=>{var q;const g=k.useState(_=>_),{axiosInstance:c}=le(),[t,p]=f.useState(!1),{payment_type:h}=k.useState(),{booking_tracking_id:d,save_pax:s,passenger:i}=U.useState(_=>_),{user_data:{login_key:b,member_id:y,user_access_level:S}={}}=W.useState(),{checkout_url:M}=((q=G.useState())==null?void 0:q.system_config)||{},E=ga(de),{data:D,isLoading:C,isError:l}=ge({queryKey:["SERVICE_STATUS",b,y],queryFn:async()=>{var _;try{const w=await c.post("/reports/service-status",{login_key:b,member_id:y});return((_=w==null?void 0:w.data)==null?void 0:_.service_status)||null}catch(w){console.error(w)}}}),r=Ye(),v=De(),m=async()=>{var _,w,R,A,B,O;if(!t)try{if(p(!0),o.terms_conditions===!1)throw new Error("Please accept Terms & Conditions");if(o.cancellation_policy===!1)throw new Error("Please accept Cancellation Policy");const I=await c.post("/user/profile",JSON.parse(localStorage.getItem("user_info")));if(!I.data||((_=I.data)==null?void 0:_.status)!=="success"){localStorage.removeItem("user_info"),W.update(x=>{x.token=null,x.user_data=null}),v.invalidateQueries(["SITE_CONFIG"]);return}const H={booking_tracking_id:d,member_id:y,save_pax:s,passenger:Object.values(i)},F=await c.post("/flight/update-travellers",H);if(((w=F==null?void 0:F.data)==null?void 0:w.status)==="success")try{const x=await c.post("/flight/create-booking",g);if(((R=x==null?void 0:x.data)==null?void 0:R.status)==="success")if((B=(A=x==null?void 0:x.data)==null?void 0:A.general)!=null&&B.tracking_id)r(`/booking-details/flight?tracking_id=${x.data.general.tracking_id}`,{replace:!0}),Z("success","Booking Successful",F.data.reason),U.replace(U._getInitialState()),k.replace(k._getInitialState()),oe.replace(oe._getInitialState());else{const{payment_option:V,pay_tracking_id:Y}=x.data;E.fire({html:e.jsx(ia,{payment_options:V,pay_tracking_id:Y,checkout_url:M}),showCancelButton:!1,showConfirmButton:!1,allowOutsideClick:!1,customClass:{htmlContainer:"!m-0",popup:"w-full max-w-3xl !p-0 overflow-hidden"}})}else throw S==="supernsn"?new Error(x.data.reason+`
`+((O=x.data)==null?void 0:O.reason_admin)):new Error(x.data.reason)}catch(x){(await de.fire({title:"Booking Failed!",html:x.message,icon:"error",showCancelButton:!1,showCloseButton:!1,confirmButtonColor:"hsl(var(--p)/1)",confirmButtonText:"Go Back",allowOutsideClick:!1})).isConfirmed&&r(-1,{replace:!0})}else throw new Error(F==null?void 0:F.data.reason)}catch(I){console.error(I),Z("error","Failed!",I.message)}finally{p(!1)}};if(C||l)return e.jsxs("button",{className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",children:[e.jsx(ae,{className:"mr-2 animate-spin"})," Loading..."]});const{block_status:z,flight_block:P,reason:J}=D;return z==="yes"&&P==="yes"?e.jsx("div",{className:"p-3 text-sm border rounded-lg border-error bg-error/10",children:e.jsx("p",{className:"text-error inner-html",dangerouslySetInnerHTML:{__html:J}})}):h?e.jsx(e.Fragment,{children:h==="account_balance"?e.jsx("button",{onClick:m,className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",disabled:a,children:t?e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"mr-2 animate-spin"})," Loading..."]}):u==="yes"?"Hold Flight":"Instant Purchase"}):e.jsx("button",{onClick:m,disabled:a,className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",children:t?e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"mr-2 animate-spin"})," Loading..."]}):"Pay and Reserve"})}):e.jsx("div",{className:"p-3 text-sm border rounded-lg border-error bg-error/10",children:e.jsx("p",{className:"text-error",children:"You don't have enough balance."})})};_e.propTypes={isExpired:T.bool,isChecked:T.object,hold_possible:T.string};const Ne=({validation_data:a})=>{var w,R,A,B,O,I,H,F,x,V,Y,X,n,L,ne,ie;const{price_change:o,search_price:u,validation_price:g,session_expire:c,data:{sell:t,hold_possible:p,pax_options:h},terms:d,cancellation_terms:s,booking_tracking_id:i}=a,{terms_selection:b,cancellation_selection:y}=h||{},[S,M]=f.useState(!1),[E,D]=f.useState(!1),{payment_type:C}=k.useState(),{user_data:l}=W.useState(),[r,v]=f.useState({terms_conditions:!1,cancellation_policy:!1}),[m,z]=f.useState(!1),{price_view:{online_payment_option:P,show_flight_fare_rules:J,show_sell_price:q}={}}=G.useState();f.useEffect(()=>{var j;((j=t==null?void 0:t.total)==null?void 0:j.amount)>(l==null?void 0:l.balance)&&p==="no"&&(P==="ACTIVE"?k.update($=>{$.payment_type="onlinepayment"}):k.update($=>{$.payment_type=null}))},[(w=t==null?void 0:t.total)==null?void 0:w.amount,l==null?void 0:l.balance,p,P]),f.useEffect(()=>{v({terms_conditions:b==="check"||b==="hide",cancellation_policy:y==="check"||y==="hide"})},[b,y]);const _=j=>{var $;(($=t==null?void 0:t.total)==null?void 0:$.amount)>(l==null?void 0:l.balance)&&p==="no"?(j.preventDefault(),j.target.value==="account_balance"?Z("error","Insufficient Balance","Please add balance to your account"):j.target.click()):k.update(Se=>{Se.payment_type=j.target.value})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("div",{className:"p-3 mb-3 border-t rounded-lg shadow-md border-base-300 bg-base-200",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-3 text-xs text-center border rounded bg-primary/10 max-sm:hidden",children:[e.jsx("span",{className:"font-medium py-1.5 px-1 bg-base-300",children:"Search Ref:"})," ",e.jsx("input",{type:"text",value:i,readOnly:!0,className:"bg-transparent cursor-pointer focus:outline-none",onClick:j=>{navigator.clipboard.writeText(i),j.target.value="Copied",setTimeout(()=>{j.target.value=i},3e3)}})]}),(q==null?void 0:q.toUpperCase())==="YES"&&e.jsxs("div",{className:"p-3 mb-3 text-sm rounded-lg bg-primary/10",children:[e.jsxs("h6",{className:"mb-2 font-semibold",children:[e.jsx(me,{className:"mr-1"})," Price: ",o]}),e.jsxs("p",{children:["Updated Price: ",Q(g.currency)," ",g.amount]}),e.jsxs("p",{children:["Search Price: ",Q(u.currency)," ",u.amount]})]}),J==="YES"&&e.jsxs("div",{className:"p-3 mb-3 text-sm rounded-lg bg-base-300",children:[e.jsxs("h6",{className:"mb-2 font-semibold",children:[e.jsx(me,{className:"mr-1"})," Fare Rules & Policy"]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("button",{onClick:()=>se("fare_rules",a),className:"inline-flex text-primary hover:underline",children:"Penalty and Cancellation Information"}),e.jsx("button",{onClick:()=>se("fare_rules",a),className:"inline-flex text-primary hover:underline",children:"Flight Fare rules"})]})]}),e.jsx(xa,{session_expire:c,action:j=>z(j)}),e.jsxs("div",{className:"p-3 mb-3 text-sm rounded-lg bg-base-300",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Fare/Pax type"}),e.jsx("p",{className:"font-medium",children:"Amount"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Base Fare"}),e.jsxs("p",{className:"font-medium",children:[Q((R=t==null?void 0:t.base_fare)==null?void 0:R.currency)," ",(B=Number((A=t==null?void 0:t.base_fare)==null?void 0:A.amount))==null?void 0:B.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Tax"}),e.jsxs("p",{className:"font-medium",children:[Q((O=t==null?void 0:t.tax)==null?void 0:O.currency)," ",(H=Number((I=t==null?void 0:t.tax)==null?void 0:I.amount))==null?void 0:H.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Total"}),e.jsxs("p",{className:"font-medium",children:[Q((F=t==null?void 0:t.total)==null?void 0:F.currency)," ",(V=Number((x=t==null?void 0:t.total)==null?void 0:x.amount))==null?void 0:V.toFixed(2)]})]}),e.jsx("hr",{className:"mb-3 border border-neutral/20"}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsx("p",{children:"Total Fare"}),e.jsx("p",{className:"font-medium",children:"Amount"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("p",{children:"Total Published Fare"}),e.jsxs("p",{className:"font-medium",children:[Q((Y=t==null?void 0:t.total)==null?void 0:Y.currency)," ",(n=Number((X=t==null?void 0:t.total)==null?void 0:X.amount))==null?void 0:n.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 mb-3 rounded-lg bg-primary/10 text-primary",children:[e.jsx("p",{children:"Total Payable"}),e.jsxs("p",{className:"font-medium fs-4",children:[Q((L=t==null?void 0:t.total)==null?void 0:L.currency)," ",(ie=Number((ne=t==null?void 0:t.total)==null?void 0:ne.amount))==null?void 0:ie.toFixed(2)]})]}),e.jsxs("div",{className:"grid gap-3 mb-3 sm:grid-flow-col lg:grid-flow-row xl:grid-flow-col payment-selection",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("input",{autoComplete:"off",type:"radio",className:"absolute -translate-y-1/2 radio radio-xs radio-primary left-2 top-1/2 peer",name:"payment",id:"balance",value:"account_balance",defaultChecked:C==="account_balance",onClick:_}),e.jsx("label",{htmlFor:"balance",className:"block px-2 py-4 pl-8 text-nowrap bg-primary/10 peer-checked:bg-primary peer-checked:text-white",children:"Account Balance"})]}),P==="ACTIVE"&&e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("input",{autoComplete:"off",type:"radio",className:"absolute -translate-y-1/2 radio radio-primary radio-xs top-1/2 left-2 peer",name:"payment",id:"card",value:"onlinepayment",defaultChecked:C==="onlinepayment",onClick:_}),e.jsxs("label",{className:"block px-2 py-4 pl-8 bg-primary/10 peer-checked:bg-primary peer-checked:text-white",htmlFor:"card",children:["Card ",e.jsx(Qe,{className:"ml-1"})]})]})]}),b!=="hide"&&e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",checked:r.terms_conditions,id:"terms",onChange:j=>v({...r,terms_conditions:j.target.checked})}),e.jsxs("label",{className:"text-sm font-medium form-check-label",htmlFor:"terms",children:["I have read and accept all"," ",e.jsx("button",{onClick:()=>(d==null?void 0:d.status)==="active"&&M(!0),className:"inline text-primary",children:"Terms & Conditions"})]})]}),y!=="hide"&&e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",checked:r.cancellation_policy,id:"policies",onChange:j=>v({...r,cancellation_policy:j.target.checked})}),e.jsxs("label",{className:"text-sm font-medium form-check-label",htmlFor:"policies",children:["I agree and understand the"," ",e.jsx("button",{onClick:()=>(s==null?void 0:s.status)==="active"&&D(!0),className:"inline text-primary",children:"Cancellation Policies"})]})]}),e.jsx(_e,{isExpired:m,isChecked:r,hold_possible:p}),e.jsx(oa,{})]})}),e.jsx(ca,{isActive:S,setIsActive:M,data:d}),e.jsx(da,{isActive:E,setIsActive:D,data:s})]})};Ne.propTypes={validation_data:T.object.isRequired};const Ua=()=>{const[a]=Ge(),{site_title:o}=G.useState(),u=a.get("tracking_id"),{price_view:{show_flight_fare_rules:g}={}}=G.useState(),{user_data:{member_id:c}}=W.useState(),{axiosInstance:t}=le(),{data:p,isLoading:h,error:d}=ge(["VALIDATION_DATA",u,c],async()=>{var i,b;const s=await t.post("/flight/validation-get-status",{booking_tracking_id:u,member_id:c});if(((i=s.data)==null?void 0:i.status)==="success")return s.data;throw{...s,message:((b=s.data)==null?void 0:b.reason)||"Request failed!"}});if(f.useEffect(()=>{U.update(s=>{s.booking_tracking_id=u}),k.update(s=>{s.booking_tracking_id=u})},[u]),h)return e.jsx(Te,{});if(d)throw d;return e.jsxs(e.Fragment,{children:[e.jsx(Ee,{children:e.jsxs("title",{children:["Flight Checkout",o?" - "+o:""]})}),e.jsxs("main",{className:"container min-h-screen pt-20",children:[e.jsx("h5",{className:"mb-4 text-xl font-medium",children:"Flight Details"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 mb-8 lg:grid-cols-3",children:[e.jsx(ve,{validation_data:p}),e.jsx(Ne,{validation_data:p})]})]}),g==="YES"&&e.jsx(Xe,{})]})};export{Ua as default};
