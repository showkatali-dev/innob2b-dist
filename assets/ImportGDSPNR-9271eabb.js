import{o as q,e as d,m as H,q as e,a4 as T,a5 as A,H as Y,T as M}from"./index-6d69b58d.js";import{d as O,e as $,o as K,bU as L,V as R,di as Q,S as U}from"./App-3b6aba26.js";import{B as V}from"./index-79d3f2f3.js";import"./RegenerateSearch-eab3ccc1.js";import"./pp-4a7e0421.js";import"./InputDate-0db76aea.js";import"./index-4003e551.js";import"./SingleSelect-32fd53cc.js";import"./PhoneNumberSelect-df093eee.js";import"./sweetalert2-react-content.es-814f85d2.js";import"./index.esm-851edfea.js";import"./FlightItineraryData-26ace1d7.js";import"./ActivityLogs-e96e77fd.js";import"./navigation-d8e893b7.js";import"./navigation-72a31663.js";import"./RefundData-855b2285.js";const me=()=>{var w,I,C,P,D;const{site_title:j,system_config:f}=q.useState(),[c,N]=d.useState(!1),[r,m]=d.useState(null),[E,b]=d.useState(""),[p,y]=d.useState([]),[v,u]=d.useState(null),{member_id:g}=((w=H.useState())==null?void 0:w.user_data)||{},{axiosInstance:S}=O(),{data:n,isLoading:G}=$({queryKey:["GDS_OPTIONS",g],queryFn:async()=>{var a,i,l,t,x,h;const s=await S.post("/secure?pathName=/flight/gds-options",{member_id:g});if(((a=s==null?void 0:s.data)==null?void 0:a.status)==="success")return b((l=(i=s.data.data)==null?void 0:i.at(0))==null?void 0:l.transfer_instruction),y((h=(x=(t=s.data.data)==null?void 0:t.at(0))==null?void 0:x.transfer_airlines_list)==null?void 0:h.split(",")),s.data.data}}),B=K();if((f==null?void 0:f.show_import_gds_pnr)!=="YES")return e.jsx(L,{});if(G)return e.jsx(T,{});const _=async(s="no")=>{var a,i,l;if(!c){u(null),N(!0);try{const t=document.getElementById("import-gds-form"),x=t.supplier_confirmation_id.value,h=t.supplier_partner_code.value;if(await new Promise(o=>{if(s==="no")return o(!0);U.fire({icon:"warning",title:"Are you sure?",text:"You want to import this PNR?",showCancelButton:!0,confirmButtonText:"Yes, import!"}).then(F=>o(F.isConfirmed))})){const o=await S.post("/secure?pathName=/flight/gds-import-pnr",{member_id:g,supplier_confirmation_id:x,supplier_partner_code:h,import_pnr:s});((a=o.data)==null?void 0:a.status)==="success"?s==="yes"?(m(o.data),M("success","Imported Successfully!",((i=o.data)==null?void 0:i.reason)||null),B("/booking-details/flight?tracking_id="+o.data.data.tracking_id)):m(o.data):u((l=o.data)==null?void 0:l.reason)}}catch(t){console.error(t),u(t.message)}finally{N(!1)}}};return e.jsxs("main",{className:"container min-h-screen pt-20",children:[e.jsx(A,{children:e.jsxs("title",{children:["Import GDS PNR",j?" - "+j:""]})}),e.jsxs("form",{onChange:()=>{m(null),u(null)},className:"w-full p-4 pt-2 rounded-md bg-base-200",id:"import-gds-form",onSubmit:s=>s.preventDefault(),children:[e.jsx("h3",{className:"pb-2 text-lg font-semibold",children:"Import GDS PNR"}),e.jsx("hr",{className:"mb-4"}),e.jsxs("div",{className:"grid gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"lg:col-span-3",children:[e.jsxs("div",{className:"grid grid-cols-2 col-span-3 gap-y-4 gap-x-8",children:[e.jsxs("div",{className:"gap-2 form-control",children:[e.jsx("p",{className:"text-sm font-medium text-neutral",children:"Select GDS"}),e.jsx("select",{name:"supplier_partner_code",className:"w-full h-10 text-sm bg-transparent rounded select select-bordered min-h-8 focus:outline-0 focus:border-neutral/30 ",required:!0,onChange:s=>{var a,i,l;b((a=n==null?void 0:n.find(t=>(t==null?void 0:t.supplier_partner_code)===s.target.value))==null?void 0:a.transfer_instruction),y((l=(i=n==null?void 0:n.find(t=>(t==null?void 0:t.supplier_partner_code)===s.target.value))==null?void 0:i.transfer_airlines_list)==null?void 0:l.split(","))},children:n==null?void 0:n.map(s=>e.jsx("option",{value:s==null?void 0:s.supplier_partner_code,children:s==null?void 0:s.title},s==null?void 0:s.supplier_partner_code))})]}),e.jsxs("div",{className:"gap-2 form-control",children:[e.jsx("p",{className:"text-sm font-medium text-neutral",children:"Enter GDS PNR"}),e.jsx("input",{type:"text",name:"supplier_confirmation_id",className:"w-full h-10 text-sm bg-transparent rounded input input-bordered min-h-8 focus:outline-0 focus:border-neutral/30 ",required:!0,placeholder:"GDS PNR"})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 mt-4",children:[(r==null?void 0:r.data)&&!c&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>_("yes"),type:"button",className:`normal-case btn btn-secondary rounded-md shadow shadow-primary/30 min-h-0 h-10 ${c?"pointer-events-none":""}`,children:c?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"mr-2 animate-spin"})," ","Processing..."]}):"Import PNR"}),e.jsx("button",{type:"button",onClick:s=>{m(null),s.target.closest("form").reset()},className:"normal-case btn btn-secondary rounded-md shadow shadow-primary/30 min-h-0 h-10 btn-outline ",children:"Cancel"})]}),e.jsx("button",{type:"button",onClick:()=>_(),className:`normal-case btn btn-primary rounded-md shadow shadow-primary/30 min-h-0 h-10 ${c?"pointer-events-none":""}`,children:c?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"mr-2 animate-spin"})," ","Processing..."]}):"Review"})]})]}),e.jsxs("div",{className:"p-4 space-y-4 border rounded",children:[e.jsxs("div",{className:"gap-2 form-control",children:[e.jsx("h3",{className:"text-sm font-semibold text-info",children:"Instruction Notes"}),e.jsx("p",{className:"text-xs",children:E})]}),(p==null?void 0:p.length)>0&&e.jsxs("div",{className:"gap-2 form-control",children:[e.jsx("h3",{className:"text-sm font-semibold text-info",children:"Airlines"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:p.map((s,a)=>s&&e.jsx("div",{className:"text-xs rounded badge badge-sm badge-secondary",children:s},a))})]})]})]})]}),e.jsxs("div",{className:"relative mt-8",children:[v?e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border rounded-lg border-error bg-error/5 text-error",children:[e.jsx(Q,{className:"text-xl"})," ",e.jsx("span",{children:v})]}):r!=null&&r.data?e.jsx(V,{booking_details:r==null?void 0:r.data,isImportGDSPNR:!0}):null,(r==null?void 0:r.data)&&e.jsxs("div",{className:"absolute right-0 flex items-center h-8 gap-1 py-1 pl-6 pr-3 text-lg font-semibold text-white top-7 bg-secondary bg-gradient-to-r from-secondary-focus to-secondary w-fit",children:[e.jsx("span",{children:"Total Customer Fare:"})," ",e.jsxs("span",{children:[Y((C=(I=r==null?void 0:r.data)==null?void 0:I.price)==null?void 0:C.currency)," ",(D=(P=r==null?void 0:r.data)==null?void 0:P.price)==null?void 0:D.total_amount]}),e.jsx("span",{className:"absolute top-0 left-0 h-0 border-y-[16px] border-x-[16px] border-transparent border-l-white"})]})]})]})};export{me as default};
