import{e as b,o as e,bj as Za,ak as g,m as Ve,G as D,am as ke,b1 as De,l as ot,b0 as ct,Q as Ie,au as _e,U as et,al as at,bk as we,a1 as tt,a6 as dt,at as pt}from"./index-3f51aa04.js";import{a as mt}from"./index.esm-74826613.js";import{cm as ut,x as ee,dl as xt,dm as ht,dn as ft,dp as _t,dq as bt,dr as jt,P as rt,a as Ye,w as Qe,ds as gt,dt as yt,d0 as vt,du as Nt,v as Ge,co as wt,c2 as kt,cn as St,cl as Ct,b5 as Ot,cy as Ft,cz as $t,aV as At,cA as Et,dv as Bt,c as Tt,b as zt,G as It,H as Mt,dw as Lt}from"./App-7d2219c6.js";import{R as Ht,S as qt,b as Rt,a as Pt,P as Dt,F as Vt,c as Ut,d as Qt}from"./Searchbox3-3aec67f5.js";import{f as Yt,h as Gt}from"./index.esm-3c90946e.js";import{d as Wt,R as Xt}from"./RangeSliderInput-c7069082.js";import{C as ae}from"./Checkbox-b27bfa98.js";import{F as it,S as Jt,a as Kt}from"./SearchboxSkeleton-01ce6093.js";import{z as Zt,B as er,n as st,c as ar}from"./index.esm-1b792f18.js";import{a as tr}from"./index.esm-ab6737f4.js";import{f as rr}from"./SuppliersSelection2-5642bad5.js";import{F as sr}from"./FlightItineraryData-9a06484c.js";import{F as nr}from"./index-e501f6c6.js";import"./MultipleFlight2-838c19a3.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./sweetalert2-react-content.es-fff6c100.js";import"./FareTypeSection-cbd78e5a.js";import"./SingleSelect-d84b87ba.js";import"./InputDate-4bfbb72f.js";import"./shortcut-buttons-flatpickr.min-7f1fff53.js";import"./PrimaryTabsWithIcon-2ef7eb54.js";import"./index.esm-d3f84af5.js";const nt=({min:m,max:s,defaultValue:i,value:l,action:c})=>{const[u,d]=b.useState({min:0,max:0});return b.useEffect(()=>{d({min:l[0]||m,max:l[1]||s})},[l,m,s]),e.jsxs("div",{className:"p-1 pt-2",children:[e.jsx("div",{className:"relative min-h-[30px] slider-container",children:e.jsx(Wt,{min:m,max:s,defaultValue:i,onInput:function(f){this.value=f,d({min:f[0],max:f[1]})},rangeSlideDisabled:!0,onThumbDragEnd:function(){c(this.value)},className:"h-1"})}),e.jsxs("div",{className:"flex items-center justify-between text-sm slider-value",children:[e.jsxs("span",{children:["Fri ",Za(u.min)]}),e.jsx("span",{children:Za(u.max)})]})]})},ir=({departureAirport:m,arrivalAirport:s})=>{const[i,l]=b.useState("takeoff"),{take_off:c,landing:u}=g.useState(d=>d.time);return e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(ut,{}),"Time"]})}),e.jsxs("div",{className:"px-0 mt-3 collapse-content",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-1 mb-2",children:[e.jsx("div",{onClick:()=>l("takeoff"),className:ee("cursor-pointer flex items-center justify-center text-sm py-1 rounded border",i==="takeoff"&&"bg-primary text-primary-content border-primary"),children:"Take off"}),e.jsx("div",{onClick:()=>l("landing"),className:ee("cursor-pointer flex items-center justify-center text-sm py-1 rounded border",i==="landing"&&"bg-primary text-primary-content border-primary"),children:"Landing"})]}),i==="takeoff"&&e.jsxs("div",{className:"space-y-2 v3",children:[e.jsxs("h2",{className:"text-sm",children:["Take-off from ",e.jsx("strong",{children:m})]}),e.jsx(nt,{min:0,max:86399,defaultValue:[c.min_time,c.max_time],value:[c.min_time,c.max_time],action:d=>g.update(f=>{f.time.take_off={min_time:d[0],max_time:d[1]}})})]}),i==="landing"&&e.jsxs("div",{className:"space-y-2 v3",children:[e.jsxs("h2",{className:"text-sm",children:["Landing to ",e.jsx("strong",{children:s})]}),e.jsx(nt,{min:0,max:86399,defaultValue:[u.min_time,u.max_time],value:[u.min_time,u.max_time],action:d=>g.update(f=>{f.time.landing={min_time:d[0],max_time:d[1]}})})]})]})]})},lr=()=>{const{refundable:m,non_refundable:s}=g.useState(i=>i.fare_type);return e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(xt,{}),"Fare Type"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsxs("div",{className:"flex flex-col gap-2 text-xs",children:[e.jsx(ae,{label:"Refundable",defaultChecked:m,action:i=>g.update(l=>{l.fare_type.refundable=i})}),e.jsx(ae,{label:"Non Refundable",defaultChecked:s,action:i=>g.update(l=>{l.fare_type.non_refundable=i})})]})})]})},or=()=>e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(ht,{}),"Fare Assistant"]})}),e.jsxs("div",{className:"px-0 mt-3 collapse-content",children:[e.jsxs("label",{className:"gap-2 mb-2 form-control",children:[e.jsx("h2",{className:"text-sm",children:"Payment Method"}),e.jsxs("select",{className:"w-full rounded select select-sm focus:outline-0",children:[e.jsx("option",{value:"",disabled:!0,defaultChecked:!0,children:"Choose an option"}),e.jsx("option",{value:"1",children:"Option 1"}),e.jsx("option",{value:"2",children:"Option 2"})]})]}),e.jsxs("div",{className:"gap-2 form-control",children:[e.jsx("h2",{className:"text-sm",children:"Credit Card Fee"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center text-xs",children:[e.jsx("input",{type:"checkbox",className:"rounded-sm checkbox checkbox-xs checkbox-primary"}),e.jsx("span",{children:"Yes"})]}),e.jsxs("label",{className:"flex items-center text-xs",children:[e.jsx("input",{type:"checkbox",className:"rounded-sm checkbox checkbox-xs checkbox-primary"}),e.jsx("span",{children:"No"})]})]})]})]})]}),cr=({suppliers:m,priceBySuppliers:s,currency:i})=>{const{supplier_option:l}=Ve.useState(),{provider:c}=g.useState();if((l==null?void 0:l.status)==="YES")return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(ft,{}),"Providers"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsx("div",{className:"flex flex-col gap-2 text-xs",children:Object.entries(c).sort().map(([u,d])=>{const{title:f,logo:N}=m.find(M=>M.supplier_code===u)||{};return e.jsx(ae,{label:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("img",{src:N,alt:"",className:"w-5 h-5 p-0.5 rounded-full border"}),e.jsx("span",{className:"line-clamp-1",children:f}),e.jsxs("span",{className:"font-medium whitespace-nowrap text-[10px] ml-auto",children:[D(i)," ",s[u]]})]}),defaultChecked:d,action:M=>g.update(L=>{L.provider[u]=M})},u)})})})]}),e.jsx("hr",{className:"mb-2 -mt-1"})]})},dr=()=>e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(_t,{}),"Flexible Flight Tickets"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsx("div",{className:"flex flex-col gap-2 text-xs",children:e.jsx(ae,{label:"No Change Fees",defaultChecked:!1,action:m=>console.log(m)})})})]}),pr=()=>e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0"}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(bt,{}),"Connecting Airports"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsxs("div",{className:"flex flex-col gap-2 text-xs",children:[e.jsx(ae,{label:"Vienna (VIE)",defaultChecked:!1,action:m=>console.log(m)}),e.jsx(ae,{label:"Manama (BAH)",defaultChecked:!1,action:m=>console.log(m)}),e.jsx(ae,{label:"Brussels (BRU)",defaultChecked:!1,action:m=>console.log(m)})]})})]}),mr=({filterOptions:m,updateFilterOptions:s})=>{const[i,l]=b.useState(!1),[c,u]=b.useState(null),d=(w,F)=>{u(F),w.dataTransfer.setData("text/plain","")},f=()=>{u(null)},N=w=>{w.preventDefault()},M=(w,F)=>{if(!c)return;const Y=m.indexOf(c),V=m.indexOf(F);if(Y!==-1&&V!==-1){const G=[...m];G.splice(Y,1),G.splice(V,0,c),s(G)}},L=b.useRef();return b.useEffect(()=>{const w=F=>{L.current&&!L.current.contains(F.target)&&l(!1)};return document.addEventListener("click",w),()=>document.removeEventListener("mousedown",w)},[]),e.jsxs("div",{className:"relative",ref:L,children:[e.jsx("button",{onClick:()=>l(!i),className:"duration-200 rounded-md btn-xs btn-warning btn btn-square hover:scale-125",children:e.jsx(jt,{className:"animate-spin",style:{animation:"spin 2.5s linear infinite"}})}),e.jsx("div",{className:ee("absolute top-full mt-1 w-fit -translate-x-1/2 bg-base-200 rounded shadow-md",i?"block":"hidden"),children:e.jsx("ul",{className:"rounded join join-vertical border-x",children:m.map(w=>e.jsxs("li",{draggable:!0,onDragStart:F=>d(F,w),onDragEnd:f,onDragOver:N,onDrop:F=>M(F,w),style:{opacity:c===w?.5:1},className:"justify-between font-normal capitalize btn-xs btn join-item border-y-base-content/20 min-w-44",children:[w," ",e.jsx(tr,{className:"text-neutral"})]},w))})})]})},Ue=["price","stops","time","fare type","duration","fare assistant","flexible flight ticket","providers","baggage","airlines","cabin","aircraft","connecting airports"],lt=({filterData:m,additionalData:s})=>{const{flight_search_sidebar:{mobile:{isActive:i}}}=ke.useState(),{axiosInstance:l}=Ye(),{data:c=[],isLoading:u}=Qe("AIRLINES",async()=>{const j=await l.get("/tools/airlines-data");return Object.entries(j.data.data).map(([y,p])=>({value:y,name:p.airline_name}))}),{price:d,duration:f,no_stop_summery:N,baggage_summery:M,operating:L,cabin_class:w,aircraft_names:F}=g.useState(j=>j),{min_price:Y,max_price:V,priceByStops:G,priceBySuppliers:me,priceByAirlines:W,currency:A,departureAirport:Se,arrivalAirport:k}=m,{min_duration:E,max_duration:U}=m,{supplier_option:q}=Ve.useState(),Q=b.useMemo(()=>{var j;return((j=q==null?void 0:q.data)==null?void 0:j.filter(T=>(T==null?void 0:T.supplier_type)==="FLIGHT"&&((s==null?void 0:s.supplier_uid)==="all"||(T==null?void 0:T.supplier_uid)===(s==null?void 0:s.supplier_uid))))||[]},[q==null?void 0:q.data,s==null?void 0:s.supplier_uid]);b.useEffect(()=>{const{min_price:j,max_price:T,min_duration:y,max_duration:p,cabin_class:O,aircraft_names:z,no_stop_summery:$,baggage_summery:ce,departure:xe,arrival:ge,carrier:v,priceBySuppliers:K}=m;g.update(I=>{I.price={min_price:j-5,max_price:T+5},I.duration={min_duration:y-5,max_duration:p+5},Object.keys(K||{}).forEach(h=>{I.provider[h]=!1}),Object.values($).forEach(h=>{I.no_stop_summery[h!=null&&h.includes("1")?1:h!=null&&h.includes("2")?2:h!=null&&h.includes("3")?3:0]=!1}),Object.values(O).forEach(h=>{I.cabin_class[h]=!1}),Object.values(z).forEach(h=>{I.aircraft_names[h]=!1}),Object.values(ce).forEach(h=>{I.baggage_summery[h]=!1}),Object.values(xe.timing_slot).forEach(h=>{I.departure[h]&&(I.departure[h].value=!1)}),Object.values(ge.timing_slot).forEach(h=>{I.arrival[h]&&(I.arrival[h].value=!1)}),Object.values(v.operating).forEach(h=>{I.operating[h]=!1})})},[m]);const[X,te]=b.useState(!1),[t,B]=b.useState(!1),[ue,re]=b.useState(!1),[le,be]=b.useState(!0),[_,J]=b.useState(!0),[se,oe]=b.useState(Ue);b.useEffect(()=>{try{const j=localStorage.getItem("__ff"),T=atob(j),y=JSON.parse(T);oe(y||Ue)}catch{oe(Ue)}},[]);const je=j=>{oe(j)};return u?e.jsx(it,{}):e.jsxs(e.Fragment,{children:[!_&&e.jsxs("button",{onClick:()=>J(!0),className:"flex items-center h-10 gap-4 pl-2 pr-3 text-sm border rounded-md border-primary w-fit",style:{background:"linear-gradient(73deg, hsl(var(--p)/1) 27%, #fff 29%)"},children:[e.jsx(gt,{className:"text-lg text-warning"})," ",e.jsx("span",{children:"Search Filter"})]}),e.jsxs("aside",{className:ee("filter-section fixed lg:translate-x-0 max-w-xs lg:max-w-full max-lg:top-0 max-lg:left-0 max-lg:bottom-0 overflow-visible duration-500 z-30 lg:z-0 bg-base-200 lg:bg-transparent lg:sticky lg:top-20 h-fit lg:rounded-lg lg:shadow-custom2 lg:mb-16 mx-auto",i?"translate-x-0":"translate-x-[-400px]",le?"w-full":"w-[80%]",_?"block":"hidden"),children:[e.jsxs("div",{className:"absolute top-0 left-0 z-10 flex justify-center w-full gap-1 -translate-y-1/2 max-sm:hidden",children:[e.jsx("button",{onClick:()=>be(!le),className:"duration-200 rounded-md btn-xs btn-warning btn btn-square hover:scale-125",children:le?e.jsx(Zt,{}):e.jsx(er,{})}),(s==null?void 0:s.journey_type)!=="MultiCity"&&e.jsx("button",{onClick:()=>ke.update(j=>{j.price_calendar.isActive=!j.price_calendar.isActive}),className:"duration-200 rounded-md btn-xs btn-warning btn btn-square hover:scale-125",children:i?e.jsx(yt,{}):e.jsx(vt,{})}),e.jsx("button",{onClick:()=>J(!1),className:"duration-200 rounded-md btn-xs btn-warning btn btn-square hover:scale-125",children:e.jsx(Nt,{})}),e.jsx(mr,{filterOptions:se,updateFilterOptions:je})]}),e.jsxs("div",{className:"py-4 rounded-lg lg:shadow-lg lg:bg-base-200 max-h-screen lg:max-h-[calc(100vh-80px)] overflow-auto custom-scrollbar px-4 pt-5",children:[e.jsx("button",{onClick:()=>ke.update(j=>{j.flight_search_sidebar.mobile.isActive=!1}),className:"absolute z-30 flex ml-auto btn btn-sm btn-ghost btn-circle bg-red-500/20 hover:bg-red-500 hover:text-white lg:hidden top-1 right-1",children:e.jsx(Ge,{})}),se.map((j,T)=>{let y=null;switch(j){case"price":{y=e.jsxs("div",{className:"-mt-1 rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(Ot,{className:"mr-1"}),"Price Range"]})}),e.jsx("div",{className:"px-0 mt-2 collapse-content v3",children:e.jsx(Xt,{min:Y-5,max:V+5,defaultValue:[Y-5,V+5],value:[d==null?void 0:d.min_price,d==null?void 0:d.max_price],action:p=>g.update(O=>{O.price={min_price:p[0],max_price:p[1]}})})})]});break}case"stops":{y=e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(Ct,{className:"mr-1"}),"Stops"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsx("div",{className:"flex gap-2 text-xs",children:Object.entries(N).sort().map(([p,O])=>e.jsxs("label",{className:"flex flex-col items-center justify-center",children:[e.jsx("input",{type:"checkbox",className:"hidden peer",checked:O,onChange:z=>{g.update($=>{$.no_stop_summery[p]=z.target.checked})}}),e.jsx("span",{className:"flex items-center justify-center w-8 h-6 text-sm border rounded-sm peer-checked:bg-primary peer-checked:text-primary-content peer-checked:border-primary",children:p}),e.jsxs("span",{className:"text-[8px] text-center tracking-tight",children:[D(A)," ",G[p]]})]},p))})})]});break}case"time":{y=e.jsx(ir,{departureAirport:Se,arrivalAirport:k});break}case"duration":{y=e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(St,{className:"mr-1"}),"Duration"]})}),e.jsx("div",{className:"px-0 mt-2 collapse-content v3",children:e.jsx(Ht,{min:E>5?E-5:E,max:U+5,defaultValue:[E-5,U+5],value:[f==null?void 0:f.min_duration,f==null?void 0:f.max_duration],action:p=>g.update(O=>{O.duration={min_duration:p[0],max_duration:p[1]}})})})]});break}case"fare type":{y=e.jsx(lr,{});break}case"fare assistant":{y=e.jsx(or,{});break}case"flexible flight tickets":{y=e.jsx(dr,{});break}case"providers":{y=e.jsx(cr,{suppliers:Q,priceBySuppliers:me,currency:A});break}case"baggage":{y=e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(kt,{className:"mr-1"}),"Baggage"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsxs("div",{className:"flex flex-col gap-2 text-xs",children:[Object.entries(M).sort().slice(0,ue?void 0:3).map(([p,O])=>e.jsx(ae,{label:p,defaultChecked:O,action:z=>g.update($=>{$.baggage_summery[p]=z})},p)),!ue&&Object.entries(M).length>3&&e.jsxs("button",{onClick:()=>re(!0),className:"font-medium text-left text-primary",children:["+",Object.entries(M).length-3," ","Baggage Options"]})]})})]});break}case"airlines":{y=e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(Gt,{}),"Airlines"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsxs("div",{className:"flex flex-col gap-2 text-xs",children:[Object.entries(L).sort().slice(0,t?void 0:4).map(([p,O])=>{var z;return e.jsx(ae,{label:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"line-clamp-1",children:((z=c.find($=>$.value===p))==null?void 0:z.name)||p}),e.jsxs("span",{className:"font-medium whitespace-nowrap text-[10px]",children:[D(A)," ",W[p]]})]}),defaultChecked:O,action:$=>g.update(ce=>{ce.operating[p]=$})},p)}),!t&&Object.entries(L).length>4&&e.jsxs("button",{onClick:()=>B(!0),className:"font-medium text-left text-primary",children:["+",Object.entries(L).length-4," Airlines"]})]})})]});break}case"cabin":{y=e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0",defaultChecked:!0}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(wt,{className:"mr-1"}),"Cabin"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsx("div",{className:"flex flex-col gap-2 text-xs",children:Object.entries(w).sort().map(([p,O])=>e.jsx(ae,{label:p,defaultChecked:O,action:z=>g.update($=>{$.cabin_class[p]=z})},p))})})]});break}case"aircraft":{y=e.jsxs("div",{className:"rounded-none collapse collapse-arrow",children:[e.jsx("input",{type:"checkbox",className:"min-h-0"}),e.jsx("div",{className:"min-h-0 p-0 h-fit collapse-title after:!right-1.5 after:text-neutral/70",children:e.jsxs("h6",{className:"flex items-center gap-1 text-sm font-medium",children:[e.jsx(Yt,{className:"mr-1"}),"Aircraft"]})}),e.jsx("div",{className:"px-0 mt-3 collapse-content",children:e.jsxs("div",{className:"flex flex-col gap-2 text-xs",children:[Object.entries(F).sort().slice(0,X?void 0:4).map(([p,O])=>e.jsx(ae,{label:p,defaultChecked:O,action:z=>g.update($=>{$.aircraft_names[p]=z})},p)),!X&&Object.entries(F).length>4&&e.jsxs("button",{onClick:()=>te(!0),className:"font-medium text-left text-primary",children:["+",Object.entries(F).length-4," ","Aircraft"]})]})})]});break}case"connecting airports":{y=e.jsx(pr,{});break}}return e.jsxs(b.Fragment,{children:[y,T!==se.length-1&&e.jsx("hr",{className:"mb-2 -mt-1"})]},j)})]})]}),i&&e.jsx("div",{onClick:()=>ke.update(j=>{j.flight_search_sidebar.mobile.isActive=!1}),className:"fixed top-0 bottom-0 left-0 right-0 z-20 lg:hidden bg-black/10 backdrop-blur-[2px]"})]})};lt.propTypes={filterData:rt.object.isRequired,additionalData:rt.object.isRequired};const ur=()=>{const{active:m}=ke.useState(k=>k.modal),{data:s}=De.useState(),[i,l]=b.useState(!1),[c,u]=b.useState(!1),[d,f]=b.useState(!1),{user_data:N}=ot.useState(),{member_id:M,partner_from_email_full_name:L,partner_from_email_address:w}=N||{},[F,Y]=Ft(),V=b.useRef(),{axiosInstance:G}=Ye(),{system_config:me}=Ve.useState(),W=()=>{ct(),u(!1)},A=async k=>{var E,U,q;if(k.preventDefault(),!i){l(!0);try{const Q=k.target,X=Q.name.value,te=Q.email.value,t=Q.message.value,B=await G.post("/tools/send-email",{email_subject:"Multiple Flight Sharing with you",email_body:`<!DOCTYPE html>
        <html lang="en">
        
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <style>
                * {
                    padding: 0;
                    margin: 0;
                    box-sizing: border-box;
                    font-size: inherit;
        
                }
        
                body {
                    font-size: 16px;
                    line-height: 20px;
                }
            </style>
        
        </head>
        
        <body>
        
        
            <div
                style="min-height: 100vh; font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; color: #60636b; font-size: 15px;">
        
                <div style="width: 100%; border-radius: 5px; background-color: #fff; font-weight: 500; overflow: hidden;">
        
                    <div style="margin-bottom: 14px; padding: 1rem 1rem 0 1rem;">
                        <h5 style="font-weight: bold; margin-bottom: 10px; font-size: 16px;">Hi, ${X}</h5>
                        <p style="font-size: 14px;">${t}</p>
                    </div>
        
                    <div style="padding: 1rem;">
                        ${s.map(({flight_group:ue,price_breakdown:re})=>{var le,be;return`
                        <div style="padding: 12px; border-radius: 8px; border: 1px solid #f0f0f0;">
        
                            <div style="border: 1px solid #E5E7EB; border-radius: 8px; margin-bottom: 30px;">
                                ${ue.map(_=>`
                                <div>
                                    <div style="padding: 12px; border-bottom: 1px solid #E5E7EB;">
                                        <h6 style="font-weight: 500;">${_.routes[0].origin_airport.city} to
                                            ${_.routes.at(-1).destination_airport.city},
                                            ${Ie(_.routes[0].departure_time).format(me.default_date_format_print)}</h6>
                                    </div>
                                    <div style="padding: 12px;">
                                        ${_.routes.map(J=>{var I,h,Ce,Oe,Fe,$e,Ae,Ee,Be,Te;const{lay_over:se,operating:{carrier_name:oe,carrier:je,flight_number:j,carrier_logo:T},aircraft:{name:y},departure_time:p,origin_airport:{name:O},origin_terminal:z,arrival_time:$,destination_airport:{name:ce,destination_terminal:xe},flight_time:ge,baggages:v,booking_class:K}=J;return`
                                        <div>
        
                                            ${se!=="not-applicable"?`
                                            <div
                                                style="background-color: #f4f4f4; border-radius: 8px; padding: 4px 8px; margin-top: 30px; margin-bottom: 30px; width: fit-content; margin-left: auto; margin-right: auto;">
                                                <p style="text-align: center; font-size: 12px;"><span
                                                        style="color: #dfa33a; font-weight: 700;">Change
                                                        of Airport</span> • Change of planes • ${_e(se)} layover in ${O}</p>
                                            </div>
                                            `:""}
        
                                            <div style="display: flex; margin-bottom: 16px;">
                                                <img style="border: 1px solid #f0f0f0; width: 2.4rem; height: 2.4rem; border-radius: 50%; margin-right: 12px;"
                                                    src="https://gtrs-airlineimages.s3.ap-southeast-1.amazonaws.com/icon/${T}"
                                                    alt="" />
                                                <h6 style="font-weight: 500;">${oe} <span
                                                        style="color: #9BA0B2;">${je} | ${j}</span></h6>
                                            </div>
                                            <table style="width: 100%; margin-bottom: 16px;">
                                                <tr>
                                                    <td>
                                                        <div style="text-align: center;">
                                                            <h4 style="font-size: 24px; font-weight: 600px;">${Ie(p).format("HH:mm")}</h4>
                                                            <p style="font-size: 12px; color: #7a7a7a;">${Ie(p).format(me.default_date_format_print)}</p>
                                                            <p style="font-size: 12px; color: #7a7a7a;">
                                                                ${O}
                                                            </p>
                                                            ${z?`
                                                            <p style="font-size: 10px; color: #b6b6b6;">Terminal
                                                                ${z}</p>
                                                            `:""}
        
                                                        </div>
        
        
                                                    </td>
                                                    <td>
                                                        <div style="flex-shrink: 0; text-align: center;">
                                                            <h6
                                                                style="margin-left: auto; margin-right: auto; font-size: 12px; font-weight: 500; width: fit-content;">
                                                                ${_e(ge)}</h6>
        
                                                            <div
                                                                style="width: 56px; height: 2px; margin-left: auto; margin-right: auto; margin-top: 8px; margin-bottom: 8px; display: flex; background-color: #f97316;">
        
                                                            </div>
        
        
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <div style="text-align: center;">
                                                            <h4 style="font-size: 24px; font-weight: 600px;">${Ie($).format("HH:mm")}</h4>
                                                            <p style="font-size: 12px; color: #7a7a7a;">${Ie($).format(me.default_date_format_print)}</p>
                                                            <p style="font-size: 12px; color: #7a7a7a;">
                                                                ${ce}</p>
        
                                                            ${xe?`
                                                            <p style="font-size: 10px; color: #b6b6b6;">Terminal
                                                                ${xe}</p>
                                                            `:""}
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                            <table style="width: 100%;">
                                                <tr>
                                                    <td style="width: 100%;">
                                                        <div>
                                                            <div
                                                                style="display: flex; gap: 8px; font-size: 12px; color: #0FA976;">
                                                                <p style="font-weight: 500; margin-right: 2px;">
                                                                    Baggage:
                                                                </p>
                                                                <p>
                                                                    ${(h=(I=v==null?void 0:v.checked)==null?void 0:I.ADT)!=null&&h.title?v.checked.ADT.title:"0 pieces"} for ADT
                                                                </p>
        
                                                                ${(Oe=(Ce=v==null?void 0:v.checked)==null?void 0:Ce.CNN)!=null&&Oe.title?`
                                                                <p>
                                                                    ${v.checked.CNN.title}{" "}
                                                                    for CNN
                                                                </p>
                                                                `:""}
        
                                                                ${($e=(Fe=v==null?void 0:v.checked)==null?void 0:Fe.INF)!=null&&$e.title?`
                                                                <p>
                                                                    ${v.checked.INF.title}{" "}
                                                                    for INF
                                                                </p>
                                                                `:""}
                                                            </div>
                                                            <div
                                                                style="display: flex; gap: 8px; font-size: 12px; color: #078db6;">
                                                                <p style="font-weight: 500; margin-right: 2px;">Hand
                                                                    Baggage: ${(Ee=(Ae=v==null?void 0:v.carry_on)==null?void 0:Ae.ADT)!=null&&Ee.title?v.carry_on.ADT.title:"7 kg*"} for ADT</p>
        
                                                              
                                                                <p style="font-weight: 500; margin-right: 2px;">
                                                                    ${((Te=(Be=v==null?void 0:v.carry_on)==null?void 0:Be.CNN)==null?void 0:Te.title)||"7 kg*"}{" "}
                                                                    for
                                                                    CNN
                                                                </p>
                                                            </div>
                                                        </div>
        
                                                    </td>
                                                    <td style="width: fit-content; white-space: nowrap;">
                                                        <div>
                                                            <div style="display: flex; font-size: 12px; color: #eab308;">
                                                                <p style="font-weight: 500; margin-right: 8px;">Cabin Class:
                                                                    <span class="capitalize">${K!=null&&K.cabin_class?K==null?void 0:K.cabin_class:"N/A"}</span>
                                                                </p>
                                                            </div>
                                                            <div style="display: flex; font-size: 12px; color: #078db6;">
                                                                <p
                                                                    style="margin-right: 8px; font-weight: 500; display: flex; align-items: center;">
                                                                    Aircraft: ${y||"N/A"}
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                        `}).join(`
`)}
        
                                    </div>
                                </div>
                                `).join(`
`)}
        
                            </div>
        
        
                            ${d?`
                            <div style="border: 1px solid #e0e0e0; border-radius: 8px; margin-bottom: 30px;">
                                <div style="padding: 12px; border-bottom: 1px solid #e0e0e0;">
                                    <h6 style="font-weight: 500;">Fare breakdown</h6>
                                </div>
                                <div style="width: 100%; padding: 12px; overflow-x: auto;">
                                    <table style="font-size: 14px; border-collapse: collapse; text-align: center; width: 100%;">
                                        <thead>
                                            <tr>
                                                <th style="padding: 8px; border: 1px solid #e0e0e0;">Fare Summary</th>
                                                <th style="padding: 8px; border: 1px solid #e0e0e0;">Base Fare</th>
                                                <th style="padding: 8px; border: 1px solid #e0e0e0;">Taxes + Fees</th>
                                                <th style="padding: 8px; border: 1px solid #e0e0e0;">Per Passenger</th>
                                                <th style="padding: 8px; border: 1px solid #e0e0e0;">Total</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${re==null?void 0:re.map(_=>`
                                            <tr>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;">${_.passenger_type}
                                                </td>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;">
                                                    ${D(_.base_fare.currency)}
                                                    ${_.base_fare.amount}</td>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;">
                                                    ${D(_.tax.currency)} ${_.tax.amount}
                                                </td>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;">
                                                    ${D(_.total.currency)} (
                                                    ${_.total.amount/_.passenger_total} x
                                                    ${_.passenger_total})</td>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;">
                                                    ${D(_.total.currency)} ${_.total.amount}</td>
                                            </tr>
                                            `).join(`
`)}
                                        </tbody>
                                        <tfoot>
                                            <tr>
                                                <th
                                                    style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;text-align: start;">
                                                    Total (
                                                    ${re.map(_=>_.passenger_total).reduce((_,J)=>_+J,0)}
                                                    Travelers)</th>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;"></td>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;"></td>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;"></td>
                                                <td style="padding: 8px; border: 1px solid #e0e0e0; color: #7a7a7a;">
                                                    ${D((be=(le=re[0])==null?void 0:le.total)==null?void 0:be.currency)}
                                                    ${re.map(_=>_.total.amount).reduce((_,J)=>_+J,0)}</td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                            `:""}
        
                        </div>
        
        
                        `}).join(`
`)}
                    </div>
                </div>
            </div>
        
        </body>
        
        </html>`,email_to:{full_name:X,email_addresss:te},email_from:{full_name:L,email_addresss:w}});if(W(),((E=B==null?void 0:B.data)==null?void 0:E.status)==="success")et("success","Sent!",(U=B==null?void 0:B.data)==null?void 0:U.reason);else throw new Error((q=B==null?void 0:B.data)==null?void 0:q.reason)}catch(Q){et("error","Failed!",Q.message)}finally{l(!1)}}},Se=async()=>{var k;try{const E=F||await Y(V.current),U=E==null?void 0:E.match(/^data:image\/([^;]+)/),q=U?U[1]:null,Q=E.replace(/^data:image\/[^;]+;base64,/,""),X=await G.post("/tools/upload-base64-file",{image_type:"data",category:"flight_details",fileExtension:q,documents_image_url:Q,member_id:M});if(((k=X.data)==null?void 0:k.status)==="success"){const{ObjectURL:te}=X.data;navigator.clipboard.writeText(te),u(!0)}}catch(E){console.error(E)}};return e.jsx("div",{className:"modal",open:m==="multiple_flight_share",children:e.jsxs("form",{onSubmit:A,className:"max-w-5xl p-0 rounded-md modal-box bg-base-200",children:[e.jsxs("div",{className:"sticky top-0 flex items-start justify-between px-4 py-2 text-white rounded-t-md bg-primary-focus",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Flight Share"}),e.jsx("button",{onClick:W,type:"button",className:"btn btn-sm btn-circle btn-ghost",children:e.jsx(Ge,{})})]}),e.jsxs("div",{className:"p-5 max-h-[70vh] h-full overflow-auto",children:[e.jsx("div",{className:"grid gap-4",ref:V,children:s.map(k=>{const{flight_group:E,price_breakdown:U}=k;return e.jsxs("div",{className:"p-3 space-y-4 border rounded-lg",children:[e.jsx(sr,{flight_group:E}),d&&e.jsx(nr,{price_breakdown:U})]},k==null?void 0:k.flight_key)})}),e.jsxs("div",{className:"grid grid-cols-3 gap-5 mt-8",children:[e.jsxs("div",{className:"gap-2 form-control",children:[e.jsx("label",{children:"Name:"}),e.jsx("input",{autoComplete:"off",type:"text",className:"h-10 min-h-0 bg-transparent rounded input input-bordered focus:outline-none focus:border-primary",name:"name",placeholder:"Name",required:!0})]}),e.jsxs("div",{className:"gap-2 form-control",children:[e.jsx("label",{children:"Email:"}),e.jsx("input",{autoComplete:"off",type:"email",className:"h-10 min-h-0 bg-transparent rounded input input-bordered focus:outline-none focus:border-primary",name:"email",placeholder:"Email",required:!0})]}),e.jsxs("div",{className:"gap-2 form-control",children:[e.jsx("label",{children:"Price Include"}),e.jsxs("select",{className:"h-10 min-h-0 bg-transparent rounded select select-bordered focus:outline-none focus:border-primary",required:!0,value:d?"yes":"no",onChange:k=>f(k.target.value==="yes"),children:[e.jsx("option",{value:"no",children:"No"}),e.jsx("option",{value:"yes",children:"Yes"})]})]}),e.jsxs("div",{className:"col-span-3 gap-2 form-control",children:[e.jsx("label",{children:"Message:"}),e.jsx("textarea",{className:"py-2 bg-transparent rounded min-h-16 input input-bordered focus:outline-none focus:border-primary",name:"message",placeholder:"Message",required:!0})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 px-4 py-2 mt-2 border-t bg-base-300",children:[e.jsxs("div",{className:"dropdown dropdown-top dropdown-end",children:[e.jsxs("div",{tabIndex:0,role:"button",className:"min-h-0 normal-case btn btn-primary h-11",children:[e.jsx(rr,{})," Share"]}),e.jsx("ul",{tabIndex:0,className:"dropdown-content mb-2 z-[1] menu p-2 shadow bg-base-100 rounded-box w-52",children:e.jsx("li",{className:"flex items-center justify-center px-3 py-3",children:e.jsxs("button",{type:"button",tabIndex:-1,onClick:Se,className:"flex flex-col items-center justify-center gap-2 text-center duration-100 hover:!bg-primary/10 focus:!bg-primary/10 active:scale-90",children:[e.jsx($t,{className:"text-xl text-primary"})," ",e.jsx("span",{className:"text-xs",children:c?"Copied":"Copy Link to Clipboard"})]})})})]}),e.jsx("button",{type:"submit",className:"min-h-0 normal-case btn btn-secondary h-11",children:i?e.jsxs(e.Fragment,{children:[e.jsx(At,{className:"animate-spin"})," Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Et,{})," Send Email"]})})]})]})})},xr=()=>{const{sortBy:m}=g.useState(c=>c.sorting),[s,i]=b.useState(!1),l=b.useRef();return b.useEffect(()=>{const c=u=>{l.current&&!l.current.contains(u.target)&&i(!1)};return document.addEventListener("click",c),()=>document.removeEventListener("mousedown",c)},[]),e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("div",{onClick:()=>i(!s),className:"h-full p-1 rounded shadow cursor-pointer bg-error/30 shadow-error/30",children:e.jsxs("div",{className:"flex items-center justify-center h-full font-medium",children:[e.jsx(Bt,{className:"text-xl"})," Other sort"]})}),e.jsx("div",{className:ee("absolute z-[1] top-full mt-1 w-fit -translate-x-1/2 bg-base-200 rounded shadow-md",s?"block":"hidden"),children:e.jsxs("ul",{className:"rounded join join-vertical border-x",children:[e.jsxs("li",{onClick:()=>g.update(c=>{c.sorting.sortBy="latest_takeof"}),className:"justify-between font-normal capitalize cursor-pointer btn-xs btn join-item border-y-base-content/20 min-w-44",children:["Latest take-off ",m==="latest_takeof"&&e.jsx(st,{})]}),e.jsxs("li",{onClick:()=>g.update(c=>{c.sorting.sortBy="latest_landing"}),className:"justify-between font-normal capitalize cursor-pointer btn-xs btn join-item border-y-base-content/20 min-w-44",children:["Latest landing ",m==="latest_landing"&&e.jsx(st,{})]})]})})]})},hr=({filterData:m})=>{const{sortBy:s}=g.useState(N=>N.sorting),{lowestPrice:i,fastestFlight:l,earliestArrivalTime:c,earliestDepartureTime:u,highestPrice:d,currency:f}=m||{};return e.jsxs("div",{className:"grid grid-cols-6 gap-2 mb-5",children:[e.jsxs("div",{onClick:()=>g.update(N=>{N.sorting.sortBy="cheapest"}),className:ee("p-1 border rounded shadow cursor-pointer bg-secondary/20 shadow-secondary/20 border-transparent",s==="cheapest"&&"border-secondary"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Low Price"}),e.jsx("img",{src:`https://gtrs-airlineimages.s3.ap-southeast-1.amazonaws.com/icon/${i==null?void 0:i.carrier_operating}.png`,alt:"Sabre HE9L - Sandbox",className:"w-4 h-4 border rounded-full"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("h4",{className:"text-xs font-medium",children:[D(f)," ",i==null?void 0:i.total_price]}),e.jsx("span",{className:"text-[10px] text-neutral",children:"|"}),e.jsx("p",{className:"text-[10px] text-neutral",children:_e(i==null?void 0:i.duration)})]})]}),e.jsxs("div",{onClick:()=>g.update(N=>{N.sorting.sortBy="fastest"}),className:ee("p-1 border rounded shadow cursor-pointer bg-success/20 shadow-success/20 border-transparent",s==="fastest"&&"border-success"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Quickest"}),e.jsx("img",{src:`https://gtrs-airlineimages.s3.ap-southeast-1.amazonaws.com/icon/${l==null?void 0:l.carrier_operating}.png`,alt:"Sabre HE9L - Sandbox",className:"w-4 h-4 border rounded-full"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("h4",{className:"text-xs font-medium",children:[D(f)," ",l==null?void 0:l.total_price]}),e.jsx("span",{className:"text-[10px] text-neutral",children:"|"}),e.jsx("p",{className:"text-[10px] text-neutral",children:_e(l==null?void 0:l.duration)})]})]}),e.jsxs("div",{onClick:()=>g.update(N=>{N.sorting.sortBy="arrival_time"}),className:ee("p-1 border rounded shadow cursor-pointer bg-warning/20 shadow-warning/20 border-transparent",s==="arrival_time"&&"border-warning"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Arrival Time"}),e.jsx("img",{src:`https://gtrs-airlineimages.s3.ap-southeast-1.amazonaws.com/icon/${c==null?void 0:c.carrier_operating}.png`,alt:"Sabre HE9L - Sandbox",className:"w-4 h-4 border rounded-full"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("h4",{className:"text-xs font-medium",children:[D(f)," ",c==null?void 0:c.total_price]}),e.jsx("span",{className:"text-[10px] text-neutral",children:"|"}),e.jsx("p",{className:"text-[10px] text-neutral",children:_e(c==null?void 0:c.duration)})]})]}),e.jsxs("div",{onClick:()=>g.update(N=>{N.sorting.sortBy="departure_time"}),className:ee("p-1 border rounded shadow cursor-pointer bg-info/20 shadow-info/20 border-transparent",s==="departure_time"&&"border-info"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Depart Time"}),e.jsx("img",{src:`https://gtrs-airlineimages.s3.ap-southeast-1.amazonaws.com/icon/${u==null?void 0:u.carrier_operating}.png`,alt:"Sabre HE9L - Sandbox",className:"w-4 h-4 border rounded-full"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("h4",{className:"text-xs font-medium",children:[D(f)," ",u==null?void 0:u.total_price]}),e.jsx("span",{className:"text-[10px] text-neutral",children:"|"}),e.jsx("p",{className:"text-[10px] text-neutral",children:_e(u==null?void 0:u.duration)})]})]}),e.jsxs("div",{onClick:()=>g.update(N=>{N.sorting.sortBy="highest_price"}),className:ee("p-1 border rounded shadow cursor-pointer bg-primary/20 shadow-primary/20 border-transparent",s==="highest_price"&&"border-primary"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Highest Price"}),e.jsx("img",{src:`https://gtrs-airlineimages.s3.ap-southeast-1.amazonaws.com/icon/${d==null?void 0:d.carrier_operating}.png`,alt:"Sabre HE9L - Sandbox",className:"w-4 h-4 border rounded-full"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("h4",{className:"text-xs font-medium",children:[D(f)," ",d==null?void 0:d.total_price]}),e.jsx("span",{className:"text-[10px] text-neutral",children:"|"}),e.jsx("p",{className:"text-[10px] text-neutral",children:_e(d==null?void 0:d.duration)})]})]}),e.jsx(xr,{})]})},Lr=()=>{var _,J,se,oe,je,j,T,y,p,O,z,$,ce,xe,ge,v,K,I,h,Ce,Oe,Fe,$e,Ae,Ee,Be,Te,We,Xe,Je,Ke,Ze,ea,aa,ta,ra,sa,na,ia;const{axiosInstance:m}=Ye(),{filteredData:s}=at.useState(r=>r),{price:i,duration:l,baggage_summery:c,no_stop_summery:u,cabin_class:d,aircraft_names:f,departure:N,arrival:M,operating:L,sorting:w,provider:F,time:{take_off:Y,landing:V}}=g.useState(r=>r),{site_title:G,login_required:me,system_config:W,component_version:A}=Ve.useState(),[Se]=Tt(),k=Se.get("tracking_id"),E=zt(),[U,q]=b.useState(!0),[Q,X]=b.useState(null),{data:te=[]}=Qe(["AIRPORTS_DATA"],async()=>(await m.get("/tools/airport-autosuggetion-data")).data),{data:t,isLoading:B,error:ue}=Qe(["SEARCH_RESULT",k],async()=>{var n,o,S,R,ne,he,de,fe,pe,ie,Me,Le,He,qe,Re,Pe;const r=await m.get(`/flight_logs?tracking_id=${k}&base_url=${W!=null&&W.supplier_logs_file_base_url?W==null?void 0:W.supplier_logs_file_base_url:""}&login_required=${me}`);if(!k)return E("/"),null;if(((n=r==null?void 0:r.data)==null?void 0:n.status)==="success"){ke.update(a=>{var ze;a.modal.data=(ze=r.data)==null?void 0:ze.data[0]}),X((o=r.data)==null?void 0:o.message);const ye={},ve={},Ne={},Z={},x={},C={},P={},H={};return(S=r.data)==null||S.data.forEach(a=>{var oa,ca,da,pa,ma,ua,xa,ha,fa,_a,ba,ja,ga,ya,va,Na,wa,ka,Sa,Ca,Oa,Fa,$a,Aa,Ea,Ba,Ta,za,Ia,Ma,La,Ha,qa,Ra,Pa,Da,Va,Ua,Qa,Ya,Ga,Wa,Xa,Ja,Ka;(!ye[(oa=a==null?void 0:a.filter)==null?void 0:oa.no_of_stops]||ye[(ca=a==null?void 0:a.filter)==null?void 0:ca.no_of_stops]>((da=a==null?void 0:a.filter)==null?void 0:da.price))&&(ye[(pa=a==null?void 0:a.filter)==null?void 0:pa.no_of_stops]=(ma=a==null?void 0:a.filter)==null?void 0:ma.price),(!ve[(ua=a==null?void 0:a.supplier)==null?void 0:ua.supplier_code]||ve[(xa=a==null?void 0:a.supplier)==null?void 0:xa.supplier_code]>((ha=a==null?void 0:a.filter)==null?void 0:ha.price))&&(ve[(fa=a==null?void 0:a.supplier)==null?void 0:fa.supplier_code]=(_a=a==null?void 0:a.filter)==null?void 0:_a.price),(!Ne[(ba=a==null?void 0:a.filter)==null?void 0:ba.carrier_operating]||Ne[(ja=a==null?void 0:a.filter)==null?void 0:ja.carrier_operating]>((ga=a==null?void 0:a.filter)==null?void 0:ga.price))&&(Ne[(ya=a==null?void 0:a.filter)==null?void 0:ya.carrier_operating]=(va=a==null?void 0:a.filter)==null?void 0:va.price),(!Z.total_price||Z.total_price>((Na=a==null?void 0:a.filter)==null?void 0:Na.price))&&(Z.total_price=(wa=a==null?void 0:a.filter)==null?void 0:wa.price,Z.duration=(Sa=(ka=a==null?void 0:a.filter)==null?void 0:ka.journey)==null?void 0:Sa.duration,Z.carrier_operating=(Ca=a==null?void 0:a.filter)==null?void 0:Ca.carrier_operating),(!H.total_price||H.total_price<((Oa=a==null?void 0:a.filter)==null?void 0:Oa.price))&&(H.total_price=(Fa=a==null?void 0:a.filter)==null?void 0:Fa.price,H.duration=(Aa=($a=a==null?void 0:a.filter)==null?void 0:$a.journey)==null?void 0:Aa.duration,H.carrier_operating=(Ea=a==null?void 0:a.filter)==null?void 0:Ea.carrier_operating),(!x.duration_seconds||x.duration_seconds>((Ta=(Ba=a==null?void 0:a.filter)==null?void 0:Ba.journey)==null?void 0:Ta.duration_seconds))&&(x.total_price=(za=a==null?void 0:a.filter)==null?void 0:za.price,x.duration_seconds=(Ma=(Ia=a==null?void 0:a.filter)==null?void 0:Ia.journey)==null?void 0:Ma.duration_seconds,x.duration=(Ha=(La=a==null?void 0:a.filter)==null?void 0:La.journey)==null?void 0:Ha.duration,x.carrier_operating=(qa=a==null?void 0:a.filter)==null?void 0:qa.carrier_operating);const ze=new Date((Pa=(Ra=a==null?void 0:a.filter)==null?void 0:Ra.arrival_departure_time)==null?void 0:Pa.slice(0,16)).getTime();(!C.time||C.time>ze)&&(C.time=ze,C.total_price=(Da=a==null?void 0:a.filter)==null?void 0:Da.price,C.duration=(Ua=(Va=a==null?void 0:a.filter)==null?void 0:Va.journey)==null?void 0:Ua.duration,C.carrier_operating=(Qa=a==null?void 0:a.filter)==null?void 0:Qa.carrier_operating);const la=new Date((Ga=(Ya=a==null?void 0:a.filter)==null?void 0:Ya.departure_departure_time)==null?void 0:Ga.slice(0,16)).getTime();(!P.time||P.time>la)&&(P.time=la,P.total_price=(Wa=a==null?void 0:a.filter)==null?void 0:Wa.price,P.duration=(Ja=(Xa=a==null?void 0:a.filter)==null?void 0:Xa.journey)==null?void 0:Ja.duration,P.carrier_operating=(Ka=a==null?void 0:a.filter)==null?void 0:Ka.carrier_operating)}),r.data.filter_data={...r.data.filter_data,priceByStops:ye,priceBySuppliers:ve,priceByAirlines:Ne,currency:(de=(he=(ne=(R=r.data)==null?void 0:R.data[0])==null?void 0:ne.price)==null?void 0:he.total)==null?void 0:de.currency,departureAirport:(Me=(ie=(pe=(fe=r.data)==null?void 0:fe.data[0])==null?void 0:pe.search_parameter)==null?void 0:ie.departure_airport)==null?void 0:Me.at(0),arrivalAirport:(Re=(qe=(He=(Le=r.data)==null?void 0:Le.data[0])==null?void 0:He.search_parameter)==null?void 0:qe.arrival_airport)==null?void 0:Re.at(-1),lowestPrice:Z,highestPrice:H,fastestFlight:x,earliestArrivalTime:C,earliestDepartureTime:P},r.data}else throw{...r,message:((Pe=r.data)==null?void 0:Pe.reason)||"Request failed!"}});b.useEffect(()=>{if(!B){if(t){let r=[...t.data];r=r.filter(n=>n.filter.price>i.min_price&&n.filter.price<i.max_price||!i.min_price||!i.max_price),r=r.filter(n=>!(l!=null&&l.min_duration)||n.filter.journey.duration_seconds>l.min_duration&&n.filter.journey.duration_seconds<l.max_duration),r=r.filter(n=>{var S;const o=we((S=n.filter.departure_departure_time)==null?void 0:S.slice(11,16));return o?o>=Y.min_time&&o<=Y.max_time:!0}),r=r.filter(n=>{var S;const o=we((S=n.filter.arrival_departure_time)==null?void 0:S.slice(11,16));return o?o>=V.min_time&&o<=V.max_time:!0}),r=r.filter(n=>Object.values(F).every(o=>o===!1)?!0:F[n.supplier.supplier_code]===!0),r=r.filter(n=>Object.values(c).every(o=>o===!1)?!0:c[n.filter.baggage_summery]===!0),r=r.filter(n=>{var o,S;return Object.values(u).every(R=>R===!1)?!0:u[n.filter.no_stop_summery.includes("1")?1:(o=n.filter.no_stop_summery)!=null&&o.includes("2")?2:(S=n.filter.no_stop_summery)!=null&&S.includes("3")?3:0]===!0}),r=r.filter(n=>{var o;return Object.values(N).every(S=>S.value===!1)?!0:((o=N[n.filter.departure_timing_slot])==null?void 0:o.value)===!0}),r=r.filter(n=>{var o;return Object.values(M).every(S=>S.value===!1)?!0:((o=M[n.filter.arrival_timing_slot])==null?void 0:o.value)===!0}),r=r.filter(n=>Object.values(L).every(o=>o===!1)?!0:L[n.filter.carrier_operating]===!0),r=r.filter(n=>Object.values(d).every(o=>o===!1)?!0:d[n.filter.cabin_class]===!0),r=r.filter(n=>Object.values(f).every(o=>o===!1)?!0:f[n.filter.aircraft_name]===!0),r=r.map(n=>{var S;return{...n,package_count:((S=[...r].filter(R=>(R==null?void 0:R.filter_unique_filter_code)===(n==null?void 0:n.filter_unique_filter_code)))==null?void 0:S.length)||1}}),r.sort((n,o)=>{var S,R,ne,he,de,fe,pe,ie;return w.sortBy==="cheapest"?n.filter.price-o.filter.price:w.sortBy==="fastest"?n.filter.journey.duration_seconds-o.filter.journey.duration_seconds:w.sortBy==="arrival_time"?we((R=(S=n==null?void 0:n.filter)==null?void 0:S.arrival_departure_time)==null?void 0:R.slice(11,16))-we((he=(ne=o==null?void 0:o.filter)==null?void 0:ne.arrival_departure_time)==null?void 0:he.slice(11,16)):w.sortBy==="departure_time"?we((fe=(de=n==null?void 0:n.filter)==null?void 0:de.departure_departure_time)==null?void 0:fe.slice(11,16))-we((ie=(pe=o==null?void 0:o.filter)==null?void 0:pe.departure_departure_time)==null?void 0:ie.slice(11,16)):o.filter.price-n.filter.price}),at.update(n=>{n.filteredData=r})}q(!1)}},[i,l,t,c,u,N,M,L,w,f,d,B,F,Y,V]),b.useEffect(()=>{var r;if(((r=t==null?void 0:t.data)==null?void 0:r.length)>0&&te.length>0){const{search_parameter:{journey_type:n,non_stop_flight:o,baggage_option:S,booking_class:R,segment:ne,travelers_adult:he,travelers_child:de,travelers_child_age:fe,travelers_infants:pe,travelers_infants_age:ie,preferred_carrier:Me,supplier_uid:Le,fare_type:He,fare_corporate_code:qe,travelers_ptc:Re,fare_option:Pe,fare_account_code:ye,partner_id:ve}}=t.data[0],Ne=window.location.origin,Z=te.reduce((x,C)=>(x[C.code]=C,x),{});tt.update(x=>{x.partner_id=ve,x.fare_type=He,x.fare_corporate_code=qe,x.fare_account_code=ye,x.travelers_ptc=Re,x.fare_option=Pe,x.journey_type=n,x.non_stop_flight=o,x.baggage_option=S,x.booking_class=R,x.travelers_adult=Number(he)||0,x.travelers_child=Number(de)||0,x.travelers_child_age=fe.slice(0,Number(de))||[],x.travelers_infants=Number(pe)||0,x.travelers_infants_age=(ie==null?void 0:ie.slice(0,Number(pe)))||[],ne.forEach((C,P)=>{x.segment[P]={...C,departure_airport_type:C.departure_airport_type,departure_airport:C.departure_airport_type==="AIRPORT"?Z[C.departure_airport]:Object.values(Z).find(H=>H.city_code===C.departure_airport),arrival_airport_type:C.arrival_airport_type,arrival_airport:C.arrival_airport_type==="AIRPORT"?Z[C.arrival_airport]:Object.values(Z).find(H=>H.city_code===C.arrival_airport)}}),x.flight_count=ne.length>2?ne.length:2,x.supplier_uid=Le}),It.get(`${Ne}/airlines_list.json`).then(x=>{const C=Object.keys(x.data.data).map(P=>{const{iata_code:H,airline_name:a}=x.data.data[P];return{label:`${a} (${H})`,value:H}});tt.update(P=>{P.preferred_carrier=Me.map(H=>C.find(a=>a.value===H))||[]})}),le(!1)}},[t,te]),Mt.useMediaQuery({query:"(max-width: 640px)"});const[re,le]=b.useState(!1),{isActive:be}=De.useState();if(ue)throw ue;return e.jsxs("main",{className:"container min-h-screen pt-20",children:[e.jsx(dt,{children:e.jsxs("title",{children:["Flight Search",G?" - "+G:""]})}),!B&&(t!=null&&t.filter_data)?((_=A==null?void 0:A.flight)==null?void 0:_.search_box)==="2"?e.jsx(qt,{}):((J=A==null?void 0:A.flight)==null?void 0:J.search_box)==="3"?e.jsx(Rt,{}):e.jsx(Pt,{}):e.jsx(Jt,{}),((je=(oe=(se=t==null?void 0:t.data)==null?void 0:se.at(0))==null?void 0:oe.search_parameter)==null?void 0:je.journey_type)!=="MultiCity"&&((j=t==null?void 0:t.data)==null?void 0:j.length)>0&&e.jsx(Dt,{search_parameter:(T=t==null?void 0:t.data[0])==null?void 0:T.search_parameter}),!B&&(t==null?void 0:t.filter_data)&&Q&&e.jsx("div",{className:"mb-4 overflow-hidden border rounded-md shadow bg-base-200 border-warning animate-pulse",children:e.jsxs("div",{className:"relative px-3 py-2 bg-warning/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"py-1 text-warning",children:e.jsx(ar,{className:"text-xl"})}),e.jsx("div",{children:e.jsx("p",{className:"text-xs font-normal",children:Q})})]}),e.jsx("button",{onClick:()=>X(null),className:"absolute top-1 right-1 btn btn-ghost btn-circle btn-sm !bg-transparent",children:e.jsx(Ge,{})})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 mt-5 mb-5 lg:grid-cols-4",children:[!B&&(t!=null&&t.filter_data)?((y=A==null?void 0:A.flight)==null?void 0:y.search_filter)==="3"?e.jsx(lt,{filterData:t.filter_data,additionalData:{date:(O=(p=t.data[0])==null?void 0:p.search_parameter)==null?void 0:O.departure_date[0],departure_from:($=(z=t.data[0])==null?void 0:z.search_parameter)==null?void 0:$.departure_airport[0],arrival_to:(ge=(xe=(ce=t.data[0])==null?void 0:ce.search_parameter)==null?void 0:xe.arrival_airport)==null?void 0:ge.at(-1),total_fight:(s==null?void 0:s.length)||0,journey_type:(K=(v=t.data[0])==null?void 0:v.search_parameter)==null?void 0:K.journey_type,tracking_id:k,supplier_uid:(h=(I=t.data[0])==null?void 0:I.search_parameter)==null?void 0:h.supplier_uid}}):((Ce=A==null?void 0:A.flight)==null?void 0:Ce.search_filter)==="2"?e.jsx(Vt,{filterData:t.filter_data,additionalData:{date:(Fe=(Oe=t.data[0])==null?void 0:Oe.search_parameter)==null?void 0:Fe.departure_date[0],departure_from:(Ae=($e=t.data[0])==null?void 0:$e.search_parameter)==null?void 0:Ae.departure_airport[0],arrival_to:(Te=(Be=(Ee=t.data[0])==null?void 0:Ee.search_parameter)==null?void 0:Be.arrival_airport)==null?void 0:Te.at(-1),total_fight:(s==null?void 0:s.length)||0,journey_type:(Xe=(We=t.data[0])==null?void 0:We.search_parameter)==null?void 0:Xe.journey_type,tracking_id:k}}):e.jsx(Ut,{filterData:t.filter_data,additionalData:{date:(Ke=(Je=t.data[0])==null?void 0:Je.search_parameter)==null?void 0:Ke.departure_date[0],departure_from:(ea=(Ze=t.data[0])==null?void 0:Ze.search_parameter)==null?void 0:ea.departure_airport[0],arrival_to:(ra=(ta=(aa=t.data[0])==null?void 0:aa.search_parameter)==null?void 0:ta.arrival_airport)==null?void 0:ra.at(-1),total_fight:(s==null?void 0:s.length)||0,journey_type:(na=(sa=t.data[0])==null?void 0:sa.search_parameter)==null?void 0:na.journey_type,tracking_id:k}}):e.jsx(it,{}),e.jsxs("section",{className:"lg:col-span-3",children:[!B&&(t!=null&&t.filter_data)?e.jsx(hr,{filterData:t.filter_data,currency:t==null?void 0:t.currency,search_parameter:(ia=t==null?void 0:t.data[0])==null?void 0:ia.search_parameter}):e.jsx("div",{className:"h-20 mb-5 skeleton-box"}),U?e.jsx(Kt,{}):e.jsx(Qt,{})]})]}),e.jsx("div",{className:ee("fixed bottom-0 left-0 right-0 bg-base-200 shadow-[0_-10px_15px_-3px_rgb(0_0_0_/_0.1),_0_-4px_6px_-4px_rgb(0_0_0_/_0.1)] duration-200 transition-all",be?"translate-y-0":"translate-y-full"),children:e.jsxs("div",{className:"container flex items-center justify-end gap-4 py-4",children:[e.jsxs("button",{onClick:()=>{pt("multiple_flight_share",s==null?void 0:s.at(0)),De.update(r=>{r.isActive=!1})},className:"h-10 min-h-0 font-normal text-white normal-case rounded-md btn btn-warning",children:[e.jsx(Lt,{})," Share"]}),e.jsxs("button",{onClick:()=>De.update(r=>{r.isActive=!1}),className:"h-10 min-h-0 font-normal normal-case rounded-md hover:!text-white btn btn-warning btn-outline",children:[e.jsx(mt,{})," Cancel"]})]})}),e.jsx(ur,{})]})};export{Lr as default};
