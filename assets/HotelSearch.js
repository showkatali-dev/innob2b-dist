import{e as k,aA as T,o as e,m as Y,aB as fe,I as Oe,aC as Ee,l as $e,aD as J,Q as ae,aE as ie,a8 as W,G as Re,a4 as Ue,O as ne,Y as ot,aF as lt}from"./index.js";import{aK as ct,P as V,p as ge,q as je,c as L,aL as Ze,aM as Ye,e as dt,aN as ht,aO as _e,aP as mt,aQ as be,aR as we,aS as ut,aT as ze,aU as Ge,a4 as ye,s as ve,a as pt,b as xt,t as ft,ai as gt,aj as jt,aV as _t,al as bt,F as wt}from"./App.js";import{F as me,R as Ae,S as Ie,a as yt}from"./SearchboxSkeleton.js";import{f as Ne,d as qe,b as vt}from"./index.esm2.js";import{C as le}from"./Checkbox.js";import{C as Se}from"./CustomPopOver.js";import{a as Je}from"./index.esm4.js";import{P as Ve}from"./PopOverOfPriceHotel.js";import{A as Nt,P as St,I as kt,u as Mt,a as Ct,M as Ot}from"./index.modern.js";import{$ as Fe}from"./index5.js";import{c as Et,d as At,B as It,e as Ft,S as Pt,O as Lt,f as Tt,g as Dt,R as Ht,H as Bt,a as $t,G as Rt,b as Ut}from"./BreakfastOptionSelection.js";import{a as Zt,P as We,S as Yt}from"./SuppliersSelection2.js";import{S as zt,O as Gt}from"./StayDurationAtHotel.js";import{D as qt,a as Jt,b as Vt}from"./drawer.js";import"./CountryWithCodeSelect.js";import"./SingleSelect.js";import"./PrimaryTabsWithIcon.js";import"./index.esm.js";import"./shortcut-buttons-flatpickr.min.js";const Wt=()=>{const n=k.useRef(),t=k.useCallback(r=>{n.current=setTimeout(async()=>{clearTimeout(n.current),await T.update(a=>{a.property_name=r})},500)},[]),s=k.useCallback(r=>{const a=r.target.value;t(a)},[t]);return e.jsx("div",{className:"px-5",children:e.jsxs("div",{className:"relative mb-5",children:[e.jsx("input",{autoComplete:"off",type:"text",name:"search",onKeyUp:s,className:"w-full h-10 min-h-0 text-sm bg-transparent rounded-lg pl-9 input input-bordered focus:outline-0 focus:border-primary border-neutral/20",placeholder:"Search by property name"}),e.jsx("span",{className:"absolute -translate-y-1/2 top-1/2 left-3",children:e.jsx(ct,{className:"text-lg"})})]})})},ue=({filterData:n,result_count:t=0,occupancies:s,total_night:r,search_duration_seconds:a,isShow:i=!0})=>{var R,U;const{component_version:l}=Y.useState(),{hotel:d}=((R=Y.useState())==null?void 0:R.component_version)||{},[o,c]=k.useState(!0),[u]=ge(),h=je(),{price:x,facilities:f,property_type:b,rating:y,distance:j}=T.useState(),v=n.min_price,m=n.max_price,S=n.min_distance,I=n.max_distance;if(k.useEffect(()=>{const{min_price:w,max_price:N,rating:O,property_type:M,facilities:p,min_distance:g,max_distance:_}=n;T.update(A=>{A.price={min_price:w,max_price:N},A.distance={min_distance:g,max_distance:_},O&&O.forEach(P=>{A.rating[P]=!1}),M&&M.forEach(P=>{A.property_type[P]=!1}),p&&p.forEach(P=>{A.facilities[P]=!1})}),c(!1)},[n]),!i)return;if(o)return e.jsx(me,{});const F=(s==null?void 0:s.reduce((w,N)=>w+Number(N==null?void 0:N.adult)+Number(N==null?void 0:N.child),0))||0,H=u.get("tracking_id"),C=()=>{h(`/hotel/search?tracking_id=${H}&show_favorite=1`)},$=()=>{h(`/hotel/search?tracking_id=${H}`)},B=u.get("show_favorite"),E=(U=l==null?void 0:l.hotel)==null?void 0:U.search_result;return e.jsx("aside",{className:"z-30 max-w-xs overflow-auto duration-500 filter-section lg:translate-x-0 lg:max-w-full max-lg:top-0 max-lg:left-0 max-lg:bottom-0 lg:z-0 lg:bg-base-200 lg:bg-transparent lg:sticky lg:top-20 lg:overflow-auto h-fit lg:rounded-lg lg:shadow-md mb-52",children:e.jsxs("div",{className:"py-5 lg:rounded-lg lg:shadow-lg bg-base-200 h-screen lg:max-h-[calc(100vh-80px)] lg:overflow-auto custom-scrollbar",children:[e.jsxs("div",{className:"px-5 mb-5",children:[e.jsxs("div",{className:"border rounded-lg",children:[e.jsx("div",{className:"px-3 py-2 text-sm font-medium text-center border-b bg-base-100",children:"Best Matched Hotels"}),e.jsx("div",{className:"flex items-center justify-center h-16 px-3 text-4xl font-semibold text-primary",children:t}),e.jsxs("div",{className:"px-3 py-2 text-xs text-center border-b bg-base-100 text-neutral",children:[(d==null?void 0:d.search_result)==="2"&&e.jsxs("p",{children:["Search Duration: ",a]}),e.jsxs("p",{children:["for ",r," ",Number(r)>1?"nights":"night"," ","for ",F," ",F>1?"guests":"guest"]})]})]}),E!=="2"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:B==="1"?$:C,type:"button",className:L("flex items-center w-full h-10 px-4 mt-3 rounded justify-between",B==="1"?"bg-red-500 text-white":"bg-base-200 border"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:L("text-xl",B==="1"?"text-white":"text-red-500")})," ","My favorites",e.jsx(Se,{button:e.jsx("span",{className:"flex items-center justify-center w-4 h-4 p-1 text-xs rounded bg-neutral/5 hover:bg-base-content hover:text-white",children:e.jsx(Ze,{})}),children:e.jsx("div",{className:"max-w-[250px] p-2 pb-0 text-sm text-justify",children:"In order to find the hotels your like in the hotel lists faster, mark them with the heart icon."})})]}),B==="1"&&e.jsx(qe,{})]}),e.jsx("hr",{className:"mb-5"})]})]}),E!=="2"&&e.jsx("div",{className:"px-5 mb-5",children:e.jsxs("div",{className:"relative overflow-hidden rounded",children:[e.jsx("img",{src:"https://media.wired.com/photos/59269cd37034dc5f91bec0f1/191:100/w_1280,c_limit/GoogleMapTA.jpg",className:"object-cover w-full h-36 rounded-2",alt:""}),e.jsx("div",{className:"absolute top-0 left-0 flex items-center justify-center w-full h-full bg-white/10 ",children:e.jsxs("button",{onClick:async()=>{var w;await fe.update(N=>{N.isShow=!0}),(w=document.getElementById("multiple_hotels_map_modal"))==null||w.showModal()},className:"h-10 min-h-0 normal-case rounded shadow-md btn btn-primary shadow-primary/50",children:[e.jsx(Ye,{})," Show on map"]})})]})}),e.jsx("hr",{className:"mb-5"}),e.jsx(Wt,{}),e.jsx("hr",{className:"mb-5"}),E!=="2"&&e.jsx("div",{className:"flex items-center justify-between gap-5 px-5 mt-5 mb-5 lg:mt-0",children:e.jsx("h6",{className:L("font-medium",E==="2"&&"text-sm"),children:"Filters"})}),e.jsxs("div",{className:L("px-5 mb-4",E==="2"&&"hotel-v2"),children:[e.jsxs("h6",{className:L("flex items-center gap-1 mb-3 font-medium",E==="2"&&"text-sm"),children:[e.jsx(dt,{className:"mr-1"}),"Price Range"," ",e.jsxs("span",{className:"text-sm font-normal text-neutral",children:["(",v," - ",m,")"]})]}),e.jsx(Ae,{min:v,max:m,defaultValue:[v,m],value:[x==null?void 0:x.min_price,x==null?void 0:x.max_price],action:w=>T.update(N=>{N.price={min_price:w[0],max_price:w[1]}})})]}),e.jsxs("div",{className:L("px-5",E==="2"&&"hotel-v2"),children:[e.jsxs("h6",{className:L("flex items-center gap-1 mb-3 font-medium",E==="2"&&"text-sm"),children:[e.jsx(ht,{className:"mr-1"}),"Distance"," ",e.jsxs("span",{className:"text-sm font-normal text-neutral",children:["(",S," - ",I,")"]})]}),e.jsx(Ae,{min:S,max:I,defaultValue:[S,I],value:[j==null?void 0:j.min_distance,j==null?void 0:j.max_distance],action:w=>T.update(N=>{N.distance={min_distance:w[0],max_distance:w[1]}})})]}),e.jsx("hr",{className:"mb-5"}),e.jsxs("div",{className:"px-5",children:[e.jsxs("h6",{className:L("flex items-center gap-1 mb-3 font-medium",E==="2"&&"text-sm"),children:[e.jsx(_e,{className:"mr-1"}),"Property Type"]}),e.jsx("div",{className:"flex flex-col gap-3 mb-5 text-xs",children:Object.entries(b).map(([w,N])=>w&&e.jsx(le,{label:w,defaultChecked:N,action:O=>T.update(M=>{M.property_type[w]=O})},w))})]}),e.jsx("hr",{className:"mb-5"}),e.jsxs("div",{className:"px-5",children:[e.jsxs("h6",{className:L("flex items-center gap-1 mb-3 font-medium",E==="2"&&"text-sm"),children:[e.jsx(mt,{className:"mr-1"}),"Star Rating"]}),e.jsx("div",{className:"flex flex-col gap-3 mb-5 text-xs",children:Object.entries(y).map(([w,N])=>e.jsx(le,{label:e.jsxs(e.Fragment,{children:[Array(Math.floor(w)).fill("").map((O,M)=>e.jsx(be,{className:"text-warning"},M)),parseFloat(w)-Math.floor(w)>0&&e.jsx(we,{className:"text-warning"}),e.jsxs("span",{children:[" (",w," star)"]})]}),defaultChecked:N,action:O=>T.update(M=>{M.rating[w]=O})},w))})]}),e.jsx("hr",{className:"mb-5"}),e.jsxs("div",{className:"px-5",children:[e.jsxs("h6",{className:L("flex items-center gap-1 mb-3 font-medium",E==="2"&&"text-sm"),children:[e.jsx(ut,{className:"mr-1"}),"Facilities"]}),e.jsx("div",{className:"flex flex-col gap-3 mb-5 text-xs",children:Object.entries(f).map(([w,N])=>e.jsx(le,{label:w,defaultChecked:N,action:O=>T.update(M=>{M.facilities[w]=O})},w))})]})]})})};ue.propTypes={filterData:V.object.isRequired,result_count:V.number};const Kt=()=>{const{sorting:{sortBy:n}}=T.useState();return e.jsxs("ul",{className:"w-full mb-4 overflow-auto text-sm text-center rounded-md shadow-md join bg-base-200 hide_scrollbar whitespace-nowrap",children:[e.jsx("li",{onClick:()=>T.update(t=>{t.sorting.sortBy="recommended"}),className:`px-4 py-3 cursor-pointer join-item flex-1 border-x border-x-primary/10 ${n==="recommended"?"bg-primary text-white":""}`,children:e.jsx("h6",{className:"font-medium",children:"Recommended"})}),e.jsx("li",{onClick:()=>T.update(t=>{t.sorting.sortBy="cheapest"}),className:`px-4 py-3 cursor-pointer join-item flex-1 border-x border-x-primary/10 ${n==="cheapest"?"bg-primary text-white":""}`,children:e.jsxs("h6",{className:"font-medium",children:["Lowest Price ",e.jsx("span",{className:"text-xs font-normal",children:"(Inc. Tax)"})]})}),e.jsx("li",{onClick:()=>T.update(t=>{t.sorting.sortBy="distance"}),className:`px-4 py-3 cursor-pointer join-item flex-1 border-x border-x-primary/10 ${n==="distance"?"bg-primary text-white":""}`,children:e.jsxs("h6",{className:"font-medium",children:["Distance ",e.jsx("span",{className:"text-xs font-normal",children:"(Near to Far)"})]})}),e.jsx("li",{onClick:()=>T.update(t=>{t.sorting.sortBy="rating"}),className:`px-4 py-3 cursor-pointer join-item flex-1 border-x border-x-primary/10 ${n==="rating"?"bg-primary text-white":""}`,children:e.jsxs("h6",{className:"font-medium",children:["Star Rating"," ",e.jsx("span",{className:"text-xs font-normal",children:"(Hight to Low)"})]})})]})},ke=({hotel:n})=>{const{primary_photo:t,hotel_name:s,facility:r}=n,a=r.map(i=>i.icon);return e.jsxs(Se,{button:e.jsxs("div",{className:"flex items-center gap-2 p-1 text-xs rounded hover:cursor-help w-fit bg-primary/10 text-primary-focus",children:[e.jsx("span",{className:"font-medium",children:"Facilities:"}),a.slice(0,4).map(i=>e.jsx(Oe,{path:Ee[i||"mdiAlphaFCircleOutline"],size:.6},i))]}),children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 mb-1",children:[e.jsx("img",{className:"w-8 h-8 rounded-full",src:t,alt:s}),e.jsx("p",{children:s})]}),e.jsx("h6",{className:"px-3 mb-2 text-sm font-medium text-primary",children:"Facilities:"}),e.jsx("ul",{className:"relative flex flex-col text-xs list-inside rounded-none join join-vertical",children:r.map(i=>e.jsxs("li",{className:"items-center gap-2 py-1 px-4 join-item min-w-[220px] font-medium text-neutral list-item",children:[e.jsx(Oe,{path:Ee[i.icon],size:.8})," ",i.title]},i.title))})]})};ke.propTypes={hotel:V.object.isRequired};const Ke=({hotel:n,search_parameter:t})=>{var O,M;const{supplier_option:s}=Y.useState(),{user_data:r}=$e.useState(),{hotel_name:a,room_title:i,rate_type:l,star_rating:d,currency:o,sell_price:c,distance_km:u,primary_photo:h,address:x,hotel_id:f,total_amount:b,supplier:y,rating_average:j,property_type:v}=n,{supplier_uid:m}=(n==null?void 0:n.supplier)||{},S={hotel_name:a,hotel_image:h,currency:o,sell_price:c,total_amount:b,supplier:y},F=J.useState().some(p=>p.hotel_id===f),{show_supplier_option:H}=s||{},C=()=>{const p=localStorage.getItem("saved_hotels"),g=JSON.parse(p)||[];if(g.some(_=>_.hotel_id===f)===!1){const _={hotel_id:f};g.unshift(_),localStorage.setItem("saved_hotels",JSON.stringify(g)),J.update(()=>g),ae("success","Success","Added to favorite")}},$=()=>{const p=localStorage.getItem("saved_hotels"),_=(JSON.parse(p)||[]).filter(A=>A.hotel_id!==f);localStorage.setItem("saved_hotels",JSON.stringify(_)),J.update(()=>_),ae("success","Success","Removed from favorite")},{checkIn:B,checkOut:E,occupancies:R,guest_nationality:U}=t||{},w=JSON.stringify({hotel_id:f,checkIn:B,checkOut:E,occupancies:R,guest_nationality:U}),N=btoa(w);return e.jsx("div",{className:"duration-100 rounded-md shadow-md hover:shadow-lg bg-base-200",children:e.jsxs("div",{className:"grid grid-cols-1 gap-3 p-3 sm:grid-cols-4 bg-base-500",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:h||"/no_image.jpg",className:"object-cover rounded w-full min-h-full max-h-[180px] h-full min-w-[140px]",alt:""}),F?e.jsx("button",{onClick:$,className:"rounded-full p-1 bg-red-500 text-white text-xl absolute right-1 top-1 z-[2] min-h-0 w-8 h-8 btn hover:bg-red-600 !border-transparent",children:e.jsx(ze,{})}):e.jsx("button",{onClick:C,className:"rounded-full p-1 text-red-500 text-xl bg-base-200 absolute right-1 top-1 z-[2] min-h-0 w-8 h-8 btn !border-transparent",children:e.jsx(Ge,{})})]}),e.jsxs("div",{className:"sm:col-span-3",children:[e.jsxs("div",{className:"flex justify-between items",children:[e.jsxs("div",{className:"flex gap-2 mb-1 w-fit",children:[e.jsxs("div",{className:"flex items-center text-[11px] text-warning",children:[Array(Math.floor(d)).fill("").map((p,g)=>e.jsx(be,{},g)),parseFloat(d)-Math.floor(d)>0&&e.jsx(we,{className:"text-warning"})]}),!!j&&j!=="n/a"&&e.jsxs("span",{className:"block ml-auto text-[11px] text-neutral",children:["(",j," reviews)"]})]}),v&&e.jsxs("div",{className:"rounded-sm bg-secondary/5 text-secondary text-[10px] flex w-fit px-1 items-center justify-center gap-1",children:[e.jsx(_e,{})," ",v]})]}),e.jsx("h6",{className:"font-bold text-md line-clamp-1",children:a}),e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-[13px] text-neutral line-clamp-1",children:x}),u&&e.jsx("p",{className:"text-xs text-neutral",children:e.jsxs("span",{className:"font-medium",children:[e.jsx(Je,{className:"text-base-content"})," Distance:"," ",u," km"]})})]}),e.jsx("div",{className:"px-3 py-2 rounded bg-base-100",children:e.jsxs("div",{className:"flex flex-col justify-between gap-2 md:gap-4 md:flex-row",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-[15px]",children:i}),e.jsx("p",{className:"mb-1 text-xs capitalize text-neutral",children:l==null?void 0:l.toLowerCase()}),e.jsx(ke,{hotel:n})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-wrap items-center mb-1 gap-x-4 gap-y-1 max-sm:justify-between",children:[e.jsx(Ve,{price_data:S}),["supernsn","administrator"].includes(r==null?void 0:r.user_access_level)&&H==="YES"&&e.jsx("div",{className:"text-[10px] bg-neutral/5 text-neutral rounded py-[1px] px-1",children:(M=(O=s==null?void 0:s.data)==null?void 0:O.find(p=>(p==null?void 0:p.supplier_uid)===m))==null?void 0:M.title})]}),e.jsx(ye,{to:`/hotel/details?q=${N}`,target:"_blank",rel:"noreferrer",className:"h-10 min-h-0 font-normal tracking-wide normal-case rounded-md btn btn-primary",children:"View All Rooms"})]})]})})]})]})})};Ke.propTypes={hotel:V.object.isRequired};const Qe=({hotel:n,search_parameter:t})=>{var N,O,M;const{supplier_option:s}=Y.useState(),{user_data:r}=$e.useState(),{hotel_name:a,room_title:i,star_rating:l,currency:d,sell_price:o,distance_km:c,primary_photo:u,address:h,hotel_id:x,total_amount:f,supplier:b,rating_average:y,property_type:j}=n,{supplier_uid:v}=(n==null?void 0:n.supplier)||{},m={hotel_name:a,hotel_image:u,currency:d,sell_price:o,total_amount:f,supplier:b},I=J.useState().some(p=>p.hotel_id===x),{show_supplier_option:F}=s||{},H=()=>{const p=localStorage.getItem("saved_hotels"),g=JSON.parse(p)||[];if(g.some(_=>_.hotel_id===x)===!1){const _={hotel_id:x};g.unshift(_),localStorage.setItem("saved_hotels",JSON.stringify(g)),J.update(()=>g),ae("success","Success","Added to favorite")}},C=()=>{const p=localStorage.getItem("saved_hotels"),_=(JSON.parse(p)||[]).filter(A=>A.hotel_id!==x);localStorage.setItem("saved_hotels",JSON.stringify(_)),J.update(()=>_),ae("success","Success","Removed from favorite")},{checkIn:$,checkOut:B,occupancies:E,guest_nationality:R}=t||{},U=JSON.stringify({hotel_id:x,checkIn:$,checkOut:B,occupancies:E,guest_nationality:R}),w=btoa(U);return e.jsx(ye,{to:`/hotel/details?q=${w}`,target:"_blank",rel:"noreferrer",className:"block duration-100 rounded-md shadow-md hover:ring-1 hover:ring-primary bg-base-200","data-scroll":x,children:e.jsxs("div",{className:"flex gap-3 p-3 bg-base-500",children:[e.jsxs("div",{className:"relative shrink-0",children:[e.jsx("img",{src:u||"/no_image.jpg",className:"object-cover rounded min-h-full max-h-[180px] h-full w-44",alt:""}),I?e.jsx("button",{onClick:p=>{p.preventDefault(),p.stopPropagation(),C()},className:"rounded-full p-1 bg-red-500 text-white text-xl absolute right-1 top-1 z-[2] min-h-0 w-8 h-8 btn hover:bg-red-600 !border-transparent",children:e.jsx(ze,{})}):e.jsx("button",{onClick:p=>{p.preventDefault(),p.stopPropagation(),H()},className:"rounded-full p-1 text-red-500 text-xl bg-base-200 absolute right-1 top-1 z-[2] min-h-0 w-8 h-8 btn !border-transparent",children:e.jsx(Ge,{})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex gap-2 mb-1 w-fit",children:[e.jsxs("div",{className:"flex items-center text-[11px] text-warning",children:[Array(Math.floor(l)).fill("").map((p,g)=>e.jsx(be,{},g)),parseFloat(l)-Math.floor(l)>0&&e.jsx(we,{className:"text-warning"})]}),!!y&&y!=="n/a"&&e.jsxs("span",{className:"block ml-auto text-[11px] text-neutral",children:["(",y," reviews)"]})]}),j&&e.jsxs("div",{className:"rounded-sm bg-secondary/5 text-secondary text-[10px] flex w-fit px-1 items-center justify-center gap-1",children:[e.jsx(_e,{})," ",j]})]}),e.jsx("h6",{className:"font-bold text-md line-clamp-1",children:a}),e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-[13px] text-neutral line-clamp-1",children:h}),c&&e.jsx("p",{className:"text-xs text-secondary mt-0.5",children:e.jsxs("span",{children:[e.jsx(Je,{className:"text-secondary"})," Distance:"," ",(N=Number(c))==null?void 0:N.toFixed(2)," km"]})})]}),e.jsx("div",{className:"w-full px-3 py-2 rounded bg-base-100",children:e.jsxs("div",{className:"flex flex-col justify-between w-full gap-2 md:items-center md:gap-4 md:flex-row",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium line-clamp-1 mb-0.5",children:i}),e.jsx(ke,{hotel:n})]}),e.jsxs("div",{className:"flex flex-col mb-1 sm:items-center gap-x-4 gap-y-1 max-sm:justify-between",children:[e.jsx(Ve,{price_data:m}),["supernsn","administrator"].includes(r==null?void 0:r.user_access_level)&&F==="YES"&&e.jsx("div",{className:"text-[10px] bg-neutral/5 text-neutral rounded py-[1px] px-1 w-fit",children:(M=(O=s==null?void 0:s.data)==null?void 0:O.find(p=>(p==null?void 0:p.supplier_uid)===v))==null?void 0:M.title})]})]})})]})]})})};Qe.propTypes={hotel:V.object.isRequired};const Qt=({search_parameter:n})=>{var o;const[t,s]=k.useState(10),{filteredData:r}=ie.useState(),[a,i]=k.useState([]),{component_version:l}=Y.useState();k.useEffect(()=>{i(r.slice(0,t))},[r,t]),k.useEffect(()=>{const c=()=>{window.innerHeight+window.scrollY>=document.body.offsetHeight-100&&s(u=>u+10)};return window.addEventListener("scroll",c),()=>window.removeEventListener("scroll",c)},[]);const d=(o=l==null?void 0:l.hotel)==null?void 0:o.search_result;return console.log(r),e.jsx("section",{className:"flex flex-col flex-1 gap-4 mb-52",children:a==null?void 0:a.map(c=>d==="2"?e.jsx(Qe,{hotel:c,search_parameter:n},c.hotel_id):e.jsx(Ke,{hotel:c,search_parameter:n},c.hotel_id))})},Pe=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],ce=1,X=8;class Me{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,r]=new Uint8Array(t,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const a=r>>4;if(a!==ce)throw new Error(`Got v${a} data when expected v${ce}.`);const i=Pe[r&15];if(!i)throw new Error("Unrecognized array type.");const[l]=new Uint16Array(t,2,1),[d]=new Uint32Array(t,4,1);return new Me(d,l,i,t)}constructor(t,s=64,r=Float64Array,a){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=r,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const i=Pe.indexOf(this.ArrayType),l=t*2*this.ArrayType.BYTES_PER_ELEMENT,d=t*this.IndexArrayType.BYTES_PER_ELEMENT,o=(8-d%8)%8;if(i<0)throw new Error(`Unexpected typed array class: ${r}.`);a&&a instanceof ArrayBuffer?(this.data=a,this.ids=new this.IndexArrayType(this.data,X,t),this.coords=new this.ArrayType(this.data,X+d+o,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(X+l+d+o),this.ids=new this.IndexArrayType(this.data,X,t),this.coords=new this.ArrayType(this.data,X+d+o,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(ce<<4)+i]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=t)}add(t,s){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=t,this.coords[this._pos++]=s,r}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return pe(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,s,r,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:l,nodeSize:d}=this,o=[0,i.length-1,0],c=[];for(;o.length;){const u=o.pop()||0,h=o.pop()||0,x=o.pop()||0;if(h-x<=d){for(let j=x;j<=h;j++){const v=l[2*j],m=l[2*j+1];v>=t&&v<=r&&m>=s&&m<=a&&c.push(i[j])}continue}const f=x+h>>1,b=l[2*f],y=l[2*f+1];b>=t&&b<=r&&y>=s&&y<=a&&c.push(i[f]),(u===0?t<=b:s<=y)&&(o.push(x),o.push(f-1),o.push(1-u)),(u===0?r>=b:a>=y)&&(o.push(f+1),o.push(h),o.push(1-u))}return c}within(t,s,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:a,coords:i,nodeSize:l}=this,d=[0,a.length-1,0],o=[],c=r*r;for(;d.length;){const u=d.pop()||0,h=d.pop()||0,x=d.pop()||0;if(h-x<=l){for(let j=x;j<=h;j++)Le(i[2*j],i[2*j+1],t,s)<=c&&o.push(a[j]);continue}const f=x+h>>1,b=i[2*f],y=i[2*f+1];Le(b,y,t,s)<=c&&o.push(a[f]),(u===0?t-r<=b:s-r<=y)&&(d.push(x),d.push(f-1),d.push(1-u)),(u===0?t+r>=b:s+r>=y)&&(d.push(f+1),d.push(h),d.push(1-u))}return o}}function pe(n,t,s,r,a,i){if(a-r<=s)return;const l=r+a>>1;Xe(n,t,l,r,a,i),pe(n,t,s,r,l-1,1-i),pe(n,t,s,l+1,a,1-i)}function Xe(n,t,s,r,a,i){for(;a>r;){if(a-r>600){const c=a-r+1,u=s-r+1,h=Math.log(c),x=.5*Math.exp(2*h/3),f=.5*Math.sqrt(h*x*(c-x)/c)*(u-c/2<0?-1:1),b=Math.max(r,Math.floor(s-u*x/c+f)),y=Math.min(a,Math.floor(s+(c-u)*x/c+f));Xe(n,t,s,b,y,i)}const l=t[2*s+i];let d=r,o=a;for(ee(n,t,r,s),t[2*a+i]>l&&ee(n,t,r,a);d<o;){for(ee(n,t,d,o),d++,o--;t[2*d+i]<l;)d++;for(;t[2*o+i]>l;)o--}t[2*r+i]===l?ee(n,t,r,o):(o++,ee(n,t,o,a)),o<=s&&(r=o+1),s<=o&&(a=o-1)}}function ee(n,t,s,r){de(n,s,r),de(t,2*s,2*r),de(t,2*s+1,2*r+1)}function de(n,t,s){const r=n[t];n[t]=n[s],n[s]=r}function Le(n,t,s,r){const a=n-s,i=t-r;return a*a+i*i}const Xt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:n=>n},Te=Math.fround||(n=>t=>(n[0]=+t,n[0]))(new Float32Array(1)),q=2,G=3,he=4,z=5,et=6;class es{constructor(t){this.options=Object.assign(Object.create(Xt),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:s,minZoom:r,maxZoom:a}=this.options;s&&console.time("total time");const i=`prepare ${t.length} points`;s&&console.time(i),this.points=t;const l=[];for(let o=0;o<t.length;o++){const c=t[o];if(!c.geometry)continue;const[u,h]=c.geometry.coordinates,x=Te(se(u)),f=Te(re(h));l.push(x,f,1/0,o,-1,1),this.options.reduce&&l.push(0)}let d=this.trees[a+1]=this._createTree(l);s&&console.timeEnd(i);for(let o=a;o>=r;o--){const c=+Date.now();d=this.trees[o]=this._createTree(this._cluster(d,o)),s&&console.log("z%d: %d clusters in %dms",o,d.numItems,+Date.now()-c)}return s&&console.timeEnd("total time"),this}getClusters(t,s){let r=((t[0]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,t[1]));let i=t[2]===180?180:((t[2]+180)%360+360)%360-180;const l=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)r=-180,i=180;else if(r>i){const h=this.getClusters([r,a,180,l],s),x=this.getClusters([-180,a,i,l],s);return h.concat(x)}const d=this.trees[this._limitZoom(s)],o=d.range(se(r),re(l),se(i),re(a)),c=d.data,u=[];for(const h of o){const x=this.stride*h;u.push(c[x+z]>1?De(c,x,this.clusterProps):this.points[c[x+G]])}return u}getChildren(t){const s=this._getOriginId(t),r=this._getOriginZoom(t),a="No cluster with the specified id.",i=this.trees[r];if(!i)throw new Error(a);const l=i.data;if(s*this.stride>=l.length)throw new Error(a);const d=this.options.radius/(this.options.extent*Math.pow(2,r-1)),o=l[s*this.stride],c=l[s*this.stride+1],u=i.within(o,c,d),h=[];for(const x of u){const f=x*this.stride;l[f+he]===t&&h.push(l[f+z]>1?De(l,f,this.clusterProps):this.points[l[f+G]])}if(h.length===0)throw new Error(a);return h}getLeaves(t,s,r){s=s||10,r=r||0;const a=[];return this._appendLeaves(a,t,s,r,0),a}getTile(t,s,r){const a=this.trees[this._limitZoom(t)],i=Math.pow(2,t),{extent:l,radius:d}=this.options,o=d/l,c=(r-o)/i,u=(r+1+o)/i,h={features:[]};return this._addTileFeatures(a.range((s-o)/i,c,(s+1+o)/i,u),a.data,s,r,i,h),s===0&&this._addTileFeatures(a.range(1-o/i,c,1,u),a.data,i,r,i,h),s===i-1&&this._addTileFeatures(a.range(0,c,o/i,u),a.data,-1,r,i,h),h.features.length?h:null}getClusterExpansionZoom(t){let s=this._getOriginZoom(t)-1;for(;s<=this.options.maxZoom;){const r=this.getChildren(t);if(s++,r.length!==1)break;t=r[0].properties.cluster_id}return s}_appendLeaves(t,s,r,a,i){const l=this.getChildren(s);for(const d of l){const o=d.properties;if(o&&o.cluster?i+o.point_count<=a?i+=o.point_count:i=this._appendLeaves(t,o.cluster_id,r,a,i):i<a?i++:t.push(d),t.length===r)break}return i}_createTree(t){const s=new Me(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let r=0;r<t.length;r+=this.stride)s.add(t[r],t[r+1]);return s.finish(),s.data=t,s}_addTileFeatures(t,s,r,a,i,l){for(const d of t){const o=d*this.stride,c=s[o+z]>1;let u,h,x;if(c)u=tt(s,o,this.clusterProps),h=s[o],x=s[o+1];else{const y=this.points[s[o+G]];u=y.properties;const[j,v]=y.geometry.coordinates;h=se(j),x=re(v)}const f={type:1,geometry:[[Math.round(this.options.extent*(h*i-r)),Math.round(this.options.extent*(x*i-a))]],tags:u};let b;c||this.options.generateId?b=s[o+G]:b=this.points[s[o+G]].id,b!==void 0&&(f.id=b),l.features.push(f)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,s){const{radius:r,extent:a,reduce:i,minPoints:l}=this.options,d=r/(a*Math.pow(2,s)),o=t.data,c=[],u=this.stride;for(let h=0;h<o.length;h+=u){if(o[h+q]<=s)continue;o[h+q]=s;const x=o[h],f=o[h+1],b=t.within(o[h],o[h+1],d),y=o[h+z];let j=y;for(const v of b){const m=v*u;o[m+q]>s&&(j+=o[m+z])}if(j>y&&j>=l){let v=x*y,m=f*y,S,I=-1;const F=((h/u|0)<<5)+(s+1)+this.points.length;for(const H of b){const C=H*u;if(o[C+q]<=s)continue;o[C+q]=s;const $=o[C+z];v+=o[C]*$,m+=o[C+1]*$,o[C+he]=F,i&&(S||(S=this._map(o,h,!0),I=this.clusterProps.length,this.clusterProps.push(S)),i(S,this._map(o,C)))}o[h+he]=F,c.push(v/j,m/j,1/0,F,-1,j),i&&c.push(I)}else{for(let v=0;v<u;v++)c.push(o[h+v]);if(j>1)for(const v of b){const m=v*u;if(!(o[m+q]<=s)){o[m+q]=s;for(let S=0;S<u;S++)c.push(o[m+S])}}}}return c}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,s,r){if(t[s+z]>1){const l=this.clusterProps[t[s+et]];return r?Object.assign({},l):l}const a=this.points[t[s+G]].properties,i=this.options.map(a);return r&&i===a?Object.assign({},i):i}}function De(n,t,s){return{type:"Feature",id:n[t+G],properties:tt(n,t,s),geometry:{type:"Point",coordinates:[ts(n[t]),ss(n[t+1])]}}}function tt(n,t,s){const r=n[t+z],a=r>=1e4?`${Math.round(r/1e3)}k`:r>=1e3?`${Math.round(r/100)/10}k`:r,i=n[t+et],l=i===-1?{}:Object.assign({},s[i]);return Object.assign(l,{cluster:!0,cluster_id:n[t+G],point_count:r,point_count_abbreviated:a})}function se(n){return n/360+.5}function re(n){const t=Math.sin(n*Math.PI/180),s=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return s<0?0:s>1?1:s}function ts(n){return(n-.5)*360}function ss(n){const t=(180-n*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function rs(n,t){var s={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(s[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(n);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(s[r[a]]=n[r[a]]);return s}class D{static isAdvancedMarkerAvailable(t){return google.maps.marker&&t.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(t){return google.maps.marker&&t instanceof google.maps.marker.AdvancedMarkerElement}static setMap(t,s){this.isAdvancedMarker(t)?t.map=s:t.setMap(s)}static getPosition(t){if(this.isAdvancedMarker(t)){if(t.position){if(t.position instanceof google.maps.LatLng)return t.position;if(t.position.lat&&t.position.lng)return new google.maps.LatLng(t.position.lat,t.position.lng)}return new google.maps.LatLng(null)}return t.getPosition()}static getVisible(t){return this.isAdvancedMarker(t)?!0:t.getVisible()}}class xe{constructor({markers:t,position:s}){this.markers=t,s&&(s instanceof google.maps.LatLng?this._position=s:this._position=new google.maps.LatLng(s))}get bounds(){if(this.markers.length===0&&!this._position)return;const t=new google.maps.LatLngBounds(this._position,this._position);for(const s of this.markers)t.extend(D.getPosition(s));return t}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(t=>D.getVisible(t)).length}push(t){this.markers.push(t)}delete(){this.marker&&(D.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class as{constructor({maxZoom:t=16}){this.maxZoom=t}noop({markers:t}){return is(t)}}const is=n=>n.map(s=>new xe({position:D.getPosition(s),markers:[s]}));class ns extends as{constructor(t){var{maxZoom:s,radius:r=60}=t,a=rs(t,["maxZoom","radius"]);super({maxZoom:s}),this.state={zoom:-1},this.superCluster=new es(Object.assign({maxZoom:this.maxZoom,radius:r},a))}calculate(t){let s=!1;const r={zoom:t.map.getZoom()};if(!Fe(t.markers,this.markers)){s=!0,this.markers=[...t.markers];const a=this.markers.map(i=>{const l=D.getPosition(i);return{type:"Feature",geometry:{type:"Point",coordinates:[l.lng(),l.lat()]},properties:{marker:i}}});this.superCluster.load(a)}return s||(this.state.zoom<=this.maxZoom||r.zoom<=this.maxZoom)&&(s=!Fe(this.state,r)),this.state=r,s&&(this.clusters=this.cluster(t)),{clusters:this.clusters,changed:s}}cluster({map:t}){return this.superCluster.getClusters([-180,-90,180,90],Math.round(t.getZoom())).map(s=>this.transformCluster(s))}transformCluster({geometry:{coordinates:[t,s]},properties:r}){if(r.cluster)return new xe({markers:this.superCluster.getLeaves(r.cluster_id,1/0).map(i=>i.properties.marker),position:{lat:s,lng:t}});const a=r.marker;return new xe({markers:[a],position:D.getPosition(a)})}}class os{constructor(t,s){this.markers={sum:t.length};const r=s.map(i=>i.count),a=r.reduce((i,l)=>i+l,0);this.clusters={count:s.length,markers:{mean:a/s.length,sum:a,min:Math.min(...r),max:Math.max(...r)}}}}class ls{render({count:t,position:s},r,a){const l=`<svg fill="${t>Math.max(10,r.clusters.markers.mean)?"#ff0000":"#0000ff"}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">${t}</text>
</svg>`,d=`Cluster of ${t} markers`,o=Number(google.maps.Marker.MAX_ZINDEX)+t;if(D.isAdvancedMarkerAvailable(a)){const h=new DOMParser().parseFromString(l,"image/svg+xml").documentElement;h.setAttribute("transform","translate(0 25)");const x={map:a,position:s,zIndex:o,title:d,content:h};return new google.maps.marker.AdvancedMarkerElement(x)}const c={position:s,zIndex:o,title:d,icon:{url:`data:image/svg+xml;base64,${btoa(l)}`,anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(c)}}function cs(n,t){for(let s in t.prototype)n.prototype[s]=t.prototype[s]}class Ce{constructor(){cs(Ce,google.maps.OverlayView)}}var te;(function(n){n.CLUSTERING_BEGIN="clusteringbegin",n.CLUSTERING_END="clusteringend",n.CLUSTER_CLICK="click"})(te||(te={}));const ds=(n,t,s)=>{s.fitBounds(t.bounds)};class hs extends Ce{constructor({map:t,markers:s=[],algorithmOptions:r={},algorithm:a=new ns(r),renderer:i=new ls,onClusterClick:l=ds}){super(),this.markers=[...s],this.clusters=[],this.algorithm=a,this.renderer=i,this.onClusterClick=l,t&&this.setMap(t)}addMarker(t,s){this.markers.includes(t)||(this.markers.push(t),s||this.render())}addMarkers(t,s){t.forEach(r=>{this.addMarker(r,!0)}),s||this.render()}removeMarker(t,s){const r=this.markers.indexOf(t);return r===-1?!1:(D.setMap(t,null),this.markers.splice(r,1),s||this.render(),!0)}removeMarkers(t,s){let r=!1;return t.forEach(a=>{r=this.removeMarker(a,!0)||r}),r&&!s&&this.render(),r}clearMarkers(t){this.markers.length=0,t||this.render()}render(){const t=this.getMap();if(t instanceof google.maps.Map&&t.getProjection()){google.maps.event.trigger(this,te.CLUSTERING_BEGIN,this);const{clusters:s,changed:r}=this.algorithm.calculate({markers:this.markers,map:t,mapCanvasProjection:this.getProjection()});if(r||r==null){const a=new Set;for(const l of s)l.markers.length==1&&a.add(l.markers[0]);const i=[];for(const l of this.clusters)l.marker!=null&&(l.markers.length==1?a.has(l.marker)||D.setMap(l.marker,null):i.push(l.marker));this.clusters=s,this.renderClusters(),requestAnimationFrame(()=>i.forEach(l=>D.setMap(l,null)))}google.maps.event.trigger(this,te.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(t=>D.setMap(t,null)),this.clusters.forEach(t=>t.delete()),this.clusters=[]}renderClusters(){const t=new os(this.markers,this.clusters),s=this.getMap();this.clusters.forEach(r=>{r.markers.length===1?r.marker=r.markers[0]:(r.marker=this.renderer.render(r,t,s),r.markers.forEach(a=>D.setMap(a,null)),this.onClusterClick&&r.marker.addListener("click",a=>{google.maps.event.trigger(this,te.CLUSTER_CLICK,r),this.onClusterClick(a,r,s)})),D.setMap(r.marker,s)})}}const st=({hotel_info:n,position:t,setMarkerRef:s})=>{const{room_pic:r,hotel_name:a,hotel_id:i,currency:l,sell_price:d}=n||{},[o,c]=k.useState(!1),{occupancies:u,checkIn:h,checkOut:x,guest_nationality:f}=W.useState(),[b,y]=k.useState(null),j=k.useCallback(I=>{I!==null&&(y(I),s(I,i))},[s,i]),v=()=>{c(!0)},m=JSON.stringify({hotel_id:i,checkIn:h,checkOut:x,occupancies:u,guest_nationality:f}),S=btoa(m);return e.jsxs(e.Fragment,{children:[e.jsx(Nt,{ref:j,onClick:v,position:t,title:a,children:e.jsx(St,{background:"hsl(var(--p)/1)",borderColor:"hsl(var(--pf)/1)",glyphColor:"hsl(var(--b2)/1)",children:e.jsxs("div",{className:"cursor-pointer",children:[e.jsx("div",{className:"absolute flex w-3 h-3 -translate-x-1/2 rounded-full bg-white/80 left-1/2 top-2"}),e.jsx("div",{className:"flex items-center justify-center px-2 py-1 -mt-8 bg-white rounded shadow-lg text-primary",children:e.jsxs("p",{className:"text-[10px] font-medium whitespace-nowrap flex gap-1",children:[e.jsx("span",{children:Re(l)})," ",e.jsx("span",{children:d})]})})]})})}),o?e.jsx(kt,{anchor:b,maxWidth:200,onCloseClick:()=>c(!1),children:e.jsxs(ye,{to:`/hotel/details?q=${S}`,target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("img",{className:"w-8 h-8 rounded-full",src:r,alt:""}),e.jsx("h1",{className:"text-sm font-semibold",children:a})]})}):null]})};st.propTypes={hotel_info:V.object,position:V.object.isRequired};const ms=({data:n})=>{const t=Mt(),[s,r]=k.useState({}),a=k.useRef();k.useEffect(()=>{t&&(a.current||(a.current=new hs({map:t})))},[t]),k.useEffect(()=>{var l,d;(l=a.current)==null||l.clearMarkers(),(d=a.current)==null||d.addMarkers(Object.values(s))},[s]);const i=(l,d)=>{l&&s[d]||!l&&!s[d]||r(o=>{if(l)return{...o,[d]:l};{const c={...o};return delete c[d],c}})};return e.jsx(e.Fragment,{children:n.map(l=>{const{hotel_id:d,hotel_name:o,primary_photo:c,latitude:u,longitude:h,sell_price:x,currency:f}=l||{},b={lat:Number(u),lng:Number(h)};return e.jsx(st,{hotel_info:{room_pic:c,hotel_name:o,hotel_id:d,sell_price:x,currency:f},position:b,setMarkerRef:i},d)})})},us=Ue(),ps=()=>{const{system_config:n}=Y.useState(),{filteredData:t}=ie.useState(),{isShow:s}=fe.useState(),r=s?location.hostname==="localhost"?"AIzaSyB41DRUbKWJHPxaFjMAwdrzWzbVKartNGg":n==null?void 0:n.google_map_key:null;if(!r)return null;const{latitude:a,longitude:i}=(t==null?void 0:t.at(0))||{};return e.jsx(Ct,{apiKey:r,children:(t==null?void 0:t.length)>0&&e.jsx("dialog",{id:"multiple_hotels_map_modal",className:"modal",children:e.jsxs("div",{className:"max-w-5xl p-4 rounded-md modal-box bg-base-200",children:[e.jsx("div",{children:e.jsx("button",{onClick:()=>{var l;return(l=document.getElementById("multiple_hotels_map_modal"))==null?void 0:l.close()},className:"absolute z-20 btn btn-sm btn-circle btn-ghost right-2 top-2 text-error bg-black/10",children:"✕"})}),e.jsx("div",{className:"max-h-[70vh] h-full overflow-auto",children:e.jsx(Ot,{mapId:us,center:{lat:Number(a),lng:Number(i)},zoom:10,className:"h-[450px] max-h-[95%]",gestureHandling:"greedy",children:e.jsx(ms,{data:t})})})]})})})},He=()=>{const{checkIn:n,checkOut:t,location:s}=W.useState(),r=ve.useMediaQuery({query:"(max-width: 640px)"}),{partner_option:a}=Y.useState();return e.jsxs("div",{className:"relative z-[9] bg-base-200 px-5 pb-5 pt-4 rounded-2xl shadow-md mb-12 search-box-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-4 text-sm",children:[e.jsx(Et,{}),e.jsxs("div",{className:"flex flex-wrap items-center gap-5 sm:justify-end",children:[e.jsx(At,{}),e.jsx(It,{}),e.jsx("div",{className:"w-fit min-w-[160px]",children:e.jsx(Zt,{supplier_type:"HOTEL"})}),(a==null?void 0:a.status.toLowerCase())==="yes"&&e.jsx("div",{className:"max-w-full w-fit min-w-[160px]",children:e.jsx(We,{supplier_type:"HOTEL"})})]})]}),e.jsxs("div",{className:"grid gap-5 lg:grid-flow-col",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-5 one-way-round-trip",children:[e.jsx(Ft,{label:"Destination",value:s}),e.jsx(Pt,{label:"Stay Duration",minDate:"today",defaultValue:[n,t],action:i=>W.update(l=>{l.checkIn=ne(new Date(i[0])).format("YYYY-MM-DD"),l.checkOut=ne(new Date(i[1])).format("YYYY-MM-DD")})}),e.jsx(Lt,{storeName:"hotel_search_options"}),e.jsx(Tt,{})]}),e.jsx(Dt,{isStatic:!r})]})]})},Be=()=>{const{checkIn:n,checkOut:t,location:s}=W.useState(),r=ve.useMediaQuery({query:"(max-width: 640px)"}),{partner_option:a}=Y.useState();return e.jsxs("div",{className:"relative z-[9] bg-base-200 px-5 pb-5 pt-4 rounded-2xl shadow-md mb-12 search-box-1",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-4 text-sm",children:[e.jsx(Ht,{}),e.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-5",children:[e.jsx(Bt,{}),e.jsx("div",{className:"w-fit min-w-[160px]",children:e.jsx(Yt,{supplier_type:"HOTEL"})}),(a==null?void 0:a.status.toLowerCase())==="yes"&&e.jsx("div",{className:"max-w-full w-fit min-w-[160px]",children:e.jsx(We,{supplier_type:"HOTEL"})})]})]}),e.jsxs("div",{className:"grid gap-5 lg:grid-flow-col",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-5 one-way-round-trip",children:[e.jsx($t,{label:"Destination",value:s}),e.jsx(zt,{label:"Stay Duration",minDate:"today",defaultValue:[n,t],action:i=>W.update(l=>{l.checkIn=ne(new Date(i[0])).format("YYYY-MM-DD"),l.checkOut=ne(new Date(i[1])).format("YYYY-MM-DD")})}),e.jsx(Gt,{storeName:"hotel_search_options"}),e.jsx(Rt,{})]}),e.jsx(Ut,{isStatic:!r})]})]})},xs=({count:n,location:t})=>e.jsxs("div",{className:"flex w-full gap-4 p-3 mb-4 rounded-md shadow-md bg-base-200",children:[e.jsxs("div",{className:"relative flex items-center justify-center w-16 h-16 rounded-full bg-base-100",children:[e.jsx(Ne,{className:"text-4xl text-red-500 sm:text-5xl"}),e.jsx("div",{className:"absolute top-0 left-0 flex items-center justify-center w-full h-full font-semibold text-white sm:text-lg",children:n})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold sm:text-2xl",children:"Your favorite options"}),e.jsxs("p",{className:"text-xs sm:text-sm text-neutral",children:["Your favorite options in ",t]})]})]}),fs=({hotels:n,search_parameter:t})=>{var o;const s=je(),[r]=ge(),a=r.get("tracking_id"),i=r.get("show_favorite"),l=()=>{s(`/hotel/search?tracking_id=${a}&show_favorite=1`)},d=()=>{s(`/hotel/search?tracking_id=${a}`)};return e.jsx("aside",{className:"sticky z-0 w-full max-w-[250px] max-lg:hidden overflow-auto bg-transparent rounded-lg shadow-md bg-base-200 top-20 h-fit mb-52 shrink-0",children:e.jsxs("div",{className:"py-5 lg:rounded-lg lg:shadow-lg bg-base-200 h-screen lg:max-h-[calc(100vh-80px)] lg:overflow-auto custom-scrollbar",children:[e.jsx("div",{className:"px-4 mb-4",children:e.jsxs("button",{onClick:i==="1"?d:l,type:"button",className:L("flex items-center w-full h-10 px-4 rounded justify-between",i==="1"?"bg-red-500 text-white":"bg-base-200 border"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:L("text-xl",i==="1"?"text-white":"text-red-500")})," ","My favorites",e.jsx(Se,{button:e.jsx("span",{className:"flex items-center justify-center w-4 h-4 p-1 text-xs rounded bg-neutral/5 hover:bg-base-content hover:text-white",children:e.jsx(Ze,{})}),children:e.jsx("div",{className:"max-w-[250px] p-2 pb-0 text-sm text-justify",children:"In order to find the hotels your like in the hotel lists faster, mark them with the heart icon."})})]}),i==="1"&&e.jsx(qe,{})]})}),e.jsx("div",{className:"px-5 mb-5",children:e.jsxs("div",{className:"relative overflow-hidden rounded",children:[e.jsx("img",{src:"https://media.wired.com/photos/59269cd37034dc5f91bec0f1/191:100/w_1280,c_limit/GoogleMapTA.jpg",className:"object-cover w-full h-36 rounded-2",alt:""}),e.jsx("div",{className:"absolute top-0 left-0 flex items-center justify-center w-full h-full bg-white/10 ",children:e.jsxs("button",{onClick:async()=>{var c;await fe.update(u=>{u.isShow=!0}),(c=document.getElementById("multiple_hotels_map_modal"))==null||c.showModal()},className:"h-10 min-h-0 normal-case rounded shadow-md btn btn-primary shadow-primary/50",children:[e.jsx(Ye,{})," Show on map"]})})]})}),e.jsx("div",{className:"px-5",children:e.jsx("ul",{className:"pl-4 space-y-2 list-decimal",children:(o=[...n].sort((c,u)=>Number(c==null?void 0:c.sell_price)-Number(u==null?void 0:u.sell_price)))==null?void 0:o.map(c=>e.jsx("li",{className:"gap-2 text-xs duration-200 cursor-pointer list-item hover:text-primary hover:underline",onClick:()=>{const{hotel_id:u}=c||{},{checkIn:h,checkOut:x,occupancies:f,guest_nationality:b}=t||{},y=JSON.stringify({hotel_id:u,checkIn:h,checkOut:x,occupancies:f,guest_nationality:b}),j=btoa(y);window.open(`/hotel/details?q=${j}`,"_blank")},children:e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("span",{className:"font-medium line-clamp-1",children:c==null?void 0:c.hotel_name}),e.jsxs("span",{className:"text-secondary whitespace-nowrap",children:[Re(c==null?void 0:c.currency)," ",c==null?void 0:c.sell_price]})]})},c==null?void 0:c.hotel_id))})})]})})},Ts=()=>{var R,U,w,N,O,M;const{site_title:n,login_required:t,system_config:s,component_version:r}=Y.useState(),{price:a,distance:i,property_name:l,property_type:d,rating:o,facilities:c,sorting:u}=T.useState(),{filteredData:h}=ie.useState(),{axiosInstance:x}=pt(),[f]=ge(),b=f.get("tracking_id"),y=je(),[j,v]=k.useState(null),{data:m,isLoading:S,error:I}=xt(["SEARCH_RESULT_HOTEL",b],async()=>{var g,_,A;if(!b)return y("/"),null;const p=await x.get(`/hotel_logs?tracking_id=${b}&base_url=${s!=null&&s.supplier_logs_file_base_url?s==null?void 0:s.supplier_logs_file_base_url:""}&login_required=${t}`);if(((g=p==null?void 0:p.data)==null?void 0:g.status)==="success")return v((_=p.data)==null?void 0:_.message),p.data.data=p.data.data.map(P=>(P.matched_rating=lt(p.data.search_parameter.location,P.hotel_name,P.address),P)),p.data.data.sort((P,oe)=>oe.matched_rating-P.matched_rating),p.data;throw{...p,message:((A=p.data)==null?void 0:A.reason)||"Request failed!"}}),F=f.get("show_favorite"),H=J.useState();k.useEffect(()=>{if(m){let p=[...m.data];p=F==="1"?p.filter(g=>H.some(_=>(_==null?void 0:_.hotel_id)===g.hotel_id)):p,p=p.filter(g=>{var _,A;return l?(A=(_=g.hotel_name)==null?void 0:_.toLowerCase())==null?void 0:A.includes(l==null?void 0:l.toLowerCase()):!0}),p=p.filter(g=>g.sell_price>=a.min_price&&g.sell_price<=a.max_price),p=p.filter(g=>Number(g.distance_km)>=i.min_distance&&Number(g.distance_km)<=i.max_distance),p=p.filter(g=>Object.values(d).every(_=>_===!1)?!0:d[g.property_type]===!0),p=p.filter(g=>Object.values(o).every(_=>_===!1)?!0:o[g.star_rating]===!0),p=p.filter(g=>Object.values(c).every(_=>_===!1)?!0:g.facility.some(_=>c[(_==null?void 0:_.title)||_]===!0)),p.sort((g,_)=>{switch(u.sortBy){case"cheapest":return g.sell_price-_.sell_price;case"distance":return g.distance_km-_.distance_km;case"rating":return _.star_rating-g.star_rating;default:return 0}}),ie.update(g=>{g.filteredData=p})}},[a,m,d,o,c,u,l,i,F,H]),k.useEffect(()=>{var p;if(((p=m==null?void 0:m.data)==null?void 0:p.length)>0){const{search_parameter:{location:g,radius:_,checkIn:A,checkOut:P,supplier_uid:oe,occupancies:rt,guest_nationality:at,hotel_star_level:it,partner_id:nt}}=m;W.update(Z=>{Z.partner_id=nt,Z.location=g,Z.radius=_,Z.checkIn=A,Z.checkOut=P,Z.occupancies=rt.map(K=>{const Q={};return Q.id=Ue(),Q.adult=Number(K.adult),Q.child=K.child?Number(K.child):0,Q.child_age=K.child_age?K.child_age:[],Q}),Z.supplier_uid=oe,Z.guest_nationality=at,Z.hotel_star_level=it}),B(!1)}},[m]);const C=ve.useMediaQuery({query:"(max-width: 640px)"}),[$,B]=k.useState(!1);if(I)throw I;const E=(R=r==null?void 0:r.hotel)==null?void 0:R.search_result;return e.jsxs("main",{className:"container min-h-screen pt-20",children:[e.jsx(ot,{children:e.jsxs("title",{children:["Hotel Search",n?" - "+n:""]})}),C&&e.jsxs(qt,{open:$,onOpenChange:B,children:[e.jsx(Jt,{asChild:!0,children:e.jsxs("button",{className:"flex items-center justify-center w-full gap-2 px-5 py-4 mb-4 duration-100 rounded-md shadow-md bg-base-200 hover:text-primary lg:hidden",children:[e.jsx(ft,{}),e.jsx("span",{children:"Modify Search"})]})}),e.jsx(Vt,{children:!S&&(m!=null&&m.search_parameter)?((U=r==null?void 0:r.hotel)==null?void 0:U.search_box)==="2"?e.jsx(He,{}):e.jsx(Be,{}):e.jsx(Ie,{})})]}),C&&e.jsxs(gt,{children:[e.jsx(jt,{asChild:!0,children:e.jsxs("button",{className:"flex items-center justify-center w-full gap-2 px-5 py-4 mb-4 duration-100 rounded-md shadow-md bg-base-200 hover:text-primary",children:[e.jsx(_t,{}),e.jsx("span",{children:"Filter"})]})}),e.jsx(bt,{className:"p-0 w-fit",children:!S&&(m!=null&&m.filter)?e.jsx(ue,{filterData:m.filter,result_count:h==null?void 0:h.length,search_duration_seconds:m.search_duration_seconds}):e.jsx(me,{})})]}),!C&&e.jsx(e.Fragment,{children:!S&&(m!=null&&m.search_parameter)?((w=r==null?void 0:r.hotel)==null?void 0:w.search_box)==="2"?e.jsx(He,{}):e.jsx(Be,{}):e.jsx(Ie,{})}),!S&&(m==null?void 0:m.filter_data)&&j&&e.jsx("div",{className:"mb-4 overflow-hidden border rounded-md shadow bg-base-200 border-warning animate-pulse",children:e.jsxs("div",{className:"relative px-3 py-2 bg-warning/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"py-1 text-warning",children:e.jsx(vt,{className:"text-xl"})}),e.jsx("div",{children:e.jsx("p",{className:"text-xs font-normal",children:j})})]}),e.jsx("button",{onClick:()=>v(null),className:"absolute top-1 right-1 btn btn-ghost btn-circle btn-sm !bg-transparent",children:e.jsx(wt,{})})]})}),e.jsxs("div",{className:L("grid grid-cols-1 gap-4 mt-5 mb-5 lg:grid-cols-4"),children:[!S&&(m!=null&&m.filter)?e.jsx(ue,{filterData:m.filter,result_count:h==null?void 0:h.length,search_duration_seconds:m.search_duration_seconds,occupancies:(N=m==null?void 0:m.search_parameter)==null?void 0:N.occupancies,total_night:(O=m==null?void 0:m.search_parameter)==null?void 0:O.total_night,isShow:!C}):e.jsx(me,{}),e.jsxs("section",{className:"lg:col-span-3",children:[!S&&(m!=null&&m.filter)?F?e.jsx(xs,{count:h==null?void 0:h.length,location:(M=m==null?void 0:m.search_parameter)==null?void 0:M.location}):e.jsx(Kt,{}):e.jsx("div",{className:"h-20 mb-5 skeleton-box"}),e.jsx("div",{className:L("lg:flex lg:gap-4"),children:S?e.jsx(yt,{}):e.jsxs(e.Fragment,{children:[e.jsx(Qt,{search_parameter:m==null?void 0:m.search_parameter}),E==="2"&&e.jsx(fs,{hotels:m==null?void 0:m.data,search_parameter:m==null?void 0:m.search_parameter}),e.jsx(ps,{})]})})]})]})]})};export{Ts as default};
