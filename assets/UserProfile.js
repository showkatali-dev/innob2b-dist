import{r as n,s as H,e as O,d as Q,ai as B,g as z,j as e,ab as G,H as L,b5 as W,b6 as J,b7 as K,b as T,b8 as X,k as C}from"./index.js";import{I as Z}from"./InputDate.js";import{C as $}from"./CountryWithCodeSelect.js";import{P as ee}from"./PhoneNumberSelect.js";import"./shortcut-buttons-flatpickr.min.js";import"./SingleSelect.js";const oe=()=>{const[o,u]=n.useState({isd_code:"",mobile:""}),{site_title:p}=H.useState(),[s,E]=n.useState(!1),{user_data:{login_key:i,member_id:d}}=O.useState(),[b,x]=n.useState(!1),{axiosInstance:f}=Q(),_=B(),{data:t,isLoading:k,error:h}=z(["USER_INFO",i,d],async()=>{var l,r;const a=await f.post("/user/profile",{login_key:i,member_id:d});if(((l=a.data)==null?void 0:l.status)==="success"){const{isd_code:c,mobile:m}=a.data.data;return u({isd_code:c,mobile:m}),a.data.data}else throw{...a,message:((r=a.data)==null?void 0:r.reason)||"Request failed!"}}),[F,j]=n.useState("");if(n.useEffect(()=>{t!=null&&t.country&&j(t==null?void 0:t.country)},[t==null?void 0:t.country]),k)return e.jsx(G,{});if(h)throw h;const{fullname:S,email:N,dob:w,gender:y,address:P,city:U,state:I,postal_code:M}=t,V=async a=>{var g;if(a.preventDefault(),!s){E(!0);return}if(b)return;x(!0);const l=a.target,{fullname:r,dob:c,gender:m,address:R,city:A,state:Y,postal_code:q,country:D}=l;try{((g=(await f.post("/user/profile-update",{login_key:i,member_id:d,fullname:r.value,email:N,dob:T(new Date(c.value)).format("YYYY-MM-DD"),gender:m.value,address:R.value,city:A.value,state:Y.value,postal_code:q.value,country:X(D.value),...o})).data)==null?void 0:g.status)==="success"&&(C("success","Success!","Profile was successfully updated"),_.invalidateQueries(["USER_INFO"]))}catch(v){C("error","Error!",v.message)}finally{x(!1)}};return e.jsxs("form",{onSubmit:V,className:"grid grid-cols-1 gap-4 p-4 mb-8 rounded-md shadow lg:grid-cols-2 bg-base-200",children:[e.jsx(L,{children:e.jsxs("title",{children:["User Profile",p?" - "+p:""]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"Email address"})}),e.jsx("input",{autoComplete:"off",type:"email",name:"email",placeholder:"Enter email address",className:"h-10 text-sm bg-transparent rounded input input-bordered focus:outline-0 min-h-8",readOnly:!0,value:N})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"Full name"})}),e.jsx("input",{autoComplete:"off",type:"text",name:"fullname",placeholder:"Enter you full name",className:"h-10 text-sm bg-transparent rounded input input-bordered focus:outline-0 min-h-8",required:!0,defaultValue:S,disabled:!s})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"Mobile"})}),e.jsx(ee,{placeholder:"Enter Mobile Number",className:"!h-10 !text-sm !bg-transparent !rounded input !input-bordered focus:outline-0 min-h-8 !w-full",defaultValue:String(o.isd_code||"")+String(o.mobile||""),action:a=>u(a),disabled:!s})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"Date of Birth"})}),e.jsx(Z,{name:"dob",placeholder:"Select your date of birth",className:"h-10 text-sm bg-transparent rounded input input-bordered focus:outline-0 min-h-8",action:()=>{},defaultValue:w,disabled:!s})]}),e.jsxs("div",{className:"form-control",name:"gender",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"Gender"})}),e.jsxs("label",{htmlFor:"male",className:"flex items-center mb-2 space-x-2 text-sm",children:[e.jsx("input",{autoComplete:"off",type:"radio",id:"male",name:"gender",className:"radio radio-sm radio-primary",value:"Male",defaultChecked:y==="Male",disabled:!s}),e.jsx("span",{children:"Male"})]}),e.jsxs("label",{htmlFor:"female",className:"flex items-center space-x-2 text-sm",children:[e.jsx("input",{autoComplete:"off",type:"radio",id:"female",name:"gender",className:"radio radio-sm radio-primary",value:"Female",defaultChecked:y==="Female",disabled:!s}),e.jsx("span",{children:"Female"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"Address"})}),e.jsx("input",{autoComplete:"off",type:"text",name:"address",placeholder:"Enter Address",className:"h-10 text-sm bg-transparent rounded input input-bordered focus:outline-0 min-h-8",defaultValue:P,disabled:!s})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"City"})}),e.jsx("input",{autoComplete:"off",type:"text",name:"city",placeholder:"Enter city name",className:"h-10 text-sm bg-transparent rounded input input-bordered focus:outline-0 min-h-8",defaultValue:U,disabled:!s})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"State"})}),e.jsx("input",{autoComplete:"off",type:"text",name:"state",placeholder:"Enter state name",className:"h-10 text-sm bg-transparent rounded input input-bordered focus:outline-0 min-h-8",defaultValue:I,disabled:!s})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"Country"})}),e.jsx($,{placeholder:"Enter country name",name:"country",className:"!h-10 text-sm bg-transparent !rounded input input-bordered border-base-content/20 focus:!outline-0 !min-h-8",action:a=>{var l;return j((l=a==null?void 0:a.at(0))==null?void 0:l.value)},defaultValue:F,disabled:!s})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"inline-block label",children:e.jsx("span",{className:"label-text",children:"Postal Code"})}),e.jsx("input",{autoComplete:"off",type:"text",name:"postal_code",placeholder:"Enter zip or postal code",className:"h-10 text-sm bg-transparent rounded input input-bordered focus:outline-0 min-h-8",defaultValue:M,disabled:!s})]})]}),e.jsx("button",{type:"submit",className:"w-full mt-4 normal-case rounded btn btn-sm btn-primary btn-outline",children:b?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"mr-2 animate-spin"})," Updating..."]}):s?e.jsxs(e.Fragment,{children:[e.jsx(J,{})," Update Profile"]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{})," Edit Profile"]})})]})};export{oe as default};
