import{aS as I,e as q,o as e,aT as L,aU as k,l as P,I as J,aV as ce,aW as ie,ae as oe,m as $,Q as K,u as de,U as M,a3 as Y,G as me,a5 as ue,a6 as pe}from"./index-dd20920c.js";import{P as R,K as G,O as U,a as z,w as Q,bR as xe,ag as he,ao as be,$ as X,bS as ge,b9 as fe,bT as je,bU as ye,b as Ne,_ as V,a1 as _e,c as ke}from"./App-4a5e8587.js";import{A as we,a as D}from"./AccordionItem-daa836e8.js";import{R as ve}from"./RadioInputCheckout-4a4b95d5.js";import{T as O}from"./TextInputCheckout-da8c2198.js";import{I as Z}from"./InputContainerCheckout-1c353ead.js";import{P as ee}from"./PhoneNumberSelect-97076c5d.js";import{C as Ce}from"./Checkbox-8e59513f.js";import{a as Se}from"./Room-c67e32a9.js";import{w as Re}from"./sweetalert2-react-content.es-95a238d0.js";import{e as Ie}from"./index.esm-60f450d1.js";import{H as qe}from"./index.esm-eba3237d.js";import{C as W}from"./CustomDivider-c4fc9675.js";import{S as Te}from"./SessionTimeOut-45c91a09.js";import"./index.esm-64083ebb.js";import"./HotelImageSlider-d84d9c65.js";const se=({pax_id:p,pax_type:t,room_id:c,index:a,primaryGuestOnly:o,pax_age:x})=>{var u,h,i;const{passenger:m}=I.useState(),s=c+"_"+p;return q.useEffect(()=>{I.update(b=>{b.passenger[s]={...b.passenger[s],pax_id:String(p),pax_type:t,room_number:String(c),title:"MR",age:x,first_name:a>0?"TBA":"",last_name:a>0?"TBA":""}})},[s,p,t,c,a,x]),a>0&&o?null:e.jsxs("div",{children:[!o&&e.jsxs("h6",{className:"mb-4 font-medium",children:[t==="ADT"?e.jsx(G,{className:"mr-0.5"}):e.jsx(U,{className:"mr-0.5"})," ",t==="ADT"?"Adult":"Child"," ",p]}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsx(ve,{label:"Title",isRequired:!0,defaultValue:((u=m[s])==null?void 0:u.title)||"MR",action:b=>L(s,{title:b.target.value}),options:[{label:"Mr",value:"MR"},{label:"Mrs",value:"MRS"},{label:"Ms",value:"MS"}]}),e.jsx(O,{label:"First/Given Name",isRequired:!0,action:b=>L(s,{first_name:b.target.value}),isUpperCase:!0,defaultValue:((h=m[s])==null?void 0:h.first_name)||"",placeholder:"John"}),e.jsx(O,{label:"Last/Family Name",isRequired:!0,action:b=>L(s,{last_name:b.target.value}),isUpperCase:!0,defaultValue:((i=m[s])==null?void 0:i.last_name)||"",placeholder:"Doe"})]})]})};se.propTypes={room_id:R.number.isRequired,pax_id:R.number.isRequired,pax_type:R.string.isRequired};const Ae=()=>{const{axiosInstance:p}=z(),{tracking_id:t}=I.useState(s=>s),{isd_code:c,contact_no:a,email_address:o}=k.useState(),{user_data:{login_key:x,member_id:m}}=P.useState(s=>s);return Q(["USER_DETAILS",t,x,m],async()=>{var h;const s=await p.post("/user/profile",{login_key:x,member_id:m}),u=location.origin;if(((h=s.data)==null?void 0:h.status)==="success")return k.update(i=>{i.tracking_id=t,i.member_id=s.data.data.member_id,i.contact_no=s.data.data.mobile,i.agency_contact_no=s.data.data.mobile,i.email_address=s.data.data.email,i.agency_email=s.data.data.email,i.agency_isd_code=s.data.data.isd_code,i.isd_code=s.data.data.isd_code,i.redirect_url=`${u}/booking-details/hotel`}),s.data.data}),e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"flex w-full mx-auto mb-3 text-xs badge badge-info bg-info/5 text-info",children:"System will send reservation confirmation email with your branding profile. No price information will be shown there"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(Z,{label:"Mobile Number",isRequired:!0,defaultValue:String(c||"")+String(a||""),action:s=>k.update(u=>{u.isd_code=s.isd_code,u.contact_no=s.mobile}),placeholder:"Enter Mobile Number",Input:ee}),e.jsx(O,{type:"email",label:"Email",action:s=>k.update(u=>{u.email_address=s.target.value}),placeholder:"example@mail.com",defaultValue:o})]})]})},Ee=()=>{const{agency_isd_code:p,agency_contact_no:t,agency_email:c}=k.useState(a=>a);return e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"flex w-full mx-auto mb-3 text-xs badge badge-info bg-info/5 text-info",children:"Below information will send to hotel as contact details"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(Z,{label:"Mobile Number",isRequired:!0,defaultValue:String(p||"")+String(t||""),action:a=>k.update(o=>{o.agency_isd_code=a.isd_code,o.agency_contact_no=a.mobile}),placeholder:"Enter Mobile Number",Input:ee}),e.jsx(O,{type:"email",label:"Email",action:a=>k.update(o=>{o.agency_email=a.target.value}),placeholder:"example@mail.com",defaultValue:c})]})]})},Be=()=>{const{special_requests_notes:p,special_requests:t}=k.useState(c=>c);return e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"flex w-full mx-auto mb-3 text-xs badge badge-warning bg-warning/5 text-warning",children:"**All Special Requests are not guaranteed. It depends on the subjective availability at check-in time"}),e.jsx("div",{className:"grid grid-cols-1 gap-3 mb-4 text-[13px] sm:grid-cols-3",children:t.map((c,a)=>e.jsx(Ce,{label:c.label,defaultChecked:c.requested,action:o=>k.update(x=>{const m=[...x.special_requests];m[a].requested=o,x.special_requests=m})},a))}),e.jsxs("div",{className:"sb-input-container",children:[e.jsx("label",{htmlFor:"remarkNotes",className:"sb-label",children:"Remarks Notes (Special Request Additional Notes)"}),e.jsx("textarea",{id:"remarkNotes",defaultValue:p,onChange:c=>k.update(a=>{a.special_requests_notes=c.target.value}),className:"block w-full p-0 m-0 font-medium bg-transparent rounded-none placeholder:text-neutral/50 outline-0 min-h-12 focus:outline-0",placeholder:"Provide details notes regaring any special requests"})]})]})},Fe=({room:p,room_content:t})=>{var _;const{name:c,meal_option:a,occupancies:o,rate_type:x,amenities:m,price:s}=p,{bed_type:u,room_size:h,views:i,description:b,room_pic:C,additional_images:r,amenities:g,paid_amenities:f}=t||{},j=Re(X),N=()=>{const l={title:c,images:(r==null?void 0:r.map(n=>n==null?void 0:n.url))||[C],amenities:[...m.map(n=>n==null?void 0:n.title)||[],...g||[],...(u==null?void 0:u.map(n=>{var d;return(d=n==null?void 0:n.configuration)==null?void 0:d.map(y=>y==null?void 0:y.type)}))||[]],description:b,paid_amenities:f};j.fire({html:e.jsx(Se,{room:l}),showConfirmButton:!1,showCloseButton:!0,customClass:{popup:"w-full max-w-xl !overflow-hidden",htmlContainer:"!m-0",closeButton:"text-red-500"}})},w=u==null?void 0:u.reduce((l,n)=>(n!=null&&n.description&&l.some(d=>(d==null?void 0:d.description)===(n==null?void 0:n.description))===!1&&l.push(n),l),[]);return e.jsxs("tr",{children:[e.jsx("td",{className:"p-3 align-top border border-neutral/10 min-w-[200px]",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[((_=s==null?void 0:s.promo_tag)==null?void 0:_.description)&&e.jsxs("div",{className:"relative flex px-2 py-1 pr-6 text-xs font-light text-white bg-gradient-to-r from-secondary-focus to-secondary -left-3 w-fit !line-clamp-1",children:[s.promo_tag.description,e.jsx("span",{className:"absolute top-0 right-0 h-0 border-y-[12px] border-x-[12px] border-transparent border-r-white"})]}),C&&e.jsx("img",{src:C||"/no_image.jpg",alt:c,className:"h-[150px] object-cover object-center rounded"}),e.jsxs("h5",{className:"text-[15px] font-medium",children:[o==null?void 0:o.total_room," X ",c]}),e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[h&&e.jsxs("span",{className:"text-[10px] flex items-center px-1 py-0.5 font-medium rounded bg-secondary/10 text-secondary w-fit gap-1",children:[e.jsx(xe,{})," ",e.jsxs("span",{children:[h," m",e.jsx("sup",{children:"2"})]})]}),e.jsx(he,{button:e.jsxs("div",{className:"text-[10px] flex items-center px-1 py-0.5 font-medium rounded bg-secondary/10 text-secondary w-fit gap-0.5",children:[e.jsx("span",{className:"mr-1",children:"Sleeps:"}),Number(o.adult)>0&&[...Array(Number(o.adult))].map((l,n)=>e.jsx(G,{},n)),Number(o.child)>0&&[...Array(Number(o.child))].map((l,n)=>e.jsx(U,{},n))]}),children:e.jsxs("div",{className:"flex flex-col gap-1 px-3 py-2 text-xs",children:[e.jsxs("div",{className:"text-primary",children:[e.jsx(G,{})," Adult: ",o.adult]}),e.jsxs("div",{className:"text-secondary",children:[e.jsx(U,{})," Child: ",o.child]})]})})]}),e.jsx("div",{children:e.jsxs("button",{onClick:()=>N(),className:"px-1 text-xs font-bold text-primary bg-base-200",children:["Room Amenities ",e.jsx(be,{})]})})]})}),e.jsxs("td",{className:"p-3 border border-neutral/10 min-w-[150px]",children:[e.jsxs("ul",{className:"flex flex-col gap-1 text-xs",children:[(w==null?void 0:w.length)>0&&e.jsxs("li",{className:"align-middle list-item text-secondary",children:[e.jsx(Ie,{className:"text-xl"})," ",w.map(l=>l.description).join("/")]}),(!a||(a==null?void 0:a.some(l=>(l==null?void 0:l.included)==="yes"))===!1)&&x&&e.jsxs("li",{className:"align-middle list-item text-secondary",children:[e.jsx(J,{path:ce,size:.8})," ",x]}),(a==null?void 0:a.length)>0&&(a==null?void 0:a.map((l,n)=>e.jsxs("li",{className:"align-middle list-item text-secondary",children:[e.jsx(J,{path:ie,size:.8})," ",l.title]},n))),i==null?void 0:i.map((l,n)=>l&&e.jsxs("li",{className:"align-middle list-item text-secondary",children:[e.jsx(qe,{className:"mr-1"})," ",l]},n))]}),b&&e.jsx("div",{className:"mt-2 text-xs text-neutral line-clamp-[2] inner-html",dangerouslySetInnerHTML:{__html:b}})]})]})},Pe=({validation_data:p})=>{var a,o,x;const t=p==null?void 0:p.data,c=(o=(a=p==null?void 0:p.hotel_contents)==null?void 0:a.data)==null?void 0:o.room_type;return e.jsxs("table",{className:"w-full mb-4 text-sm room-table",children:[e.jsx("thead",{}),e.jsx("tbody",{children:(x=t==null?void 0:t.data)==null?void 0:x.map(m=>{const{room_number:s}=m||{},u=c==null?void 0:c.find(h=>(h==null?void 0:h.room_id)===s);return e.jsx(Fe,{room:m,room_content:u},s)})})]})},ae=({validation_data:p})=>{var u,h,i,b,C;const{search_parameter:{occupancies:t},booking_tracking_id:c,data:a}=p,o=(h=(u=a==null?void 0:a.data)==null?void 0:u.at(0))==null?void 0:h.rate_comments;let x=q.useMemo(()=>0,[]);q.useEffect(()=>(I.update(r=>{r.tracking_id=c}),k.update(r=>{r.tracking_id=c}),()=>{I.update(r=>{r.passenger=I._getInitialState().passenger})}),[c]);const[m,s]=q.useState(!1);return e.jsxs("div",{className:"p-3 rounded-lg lg:col-span-2 bg-base-200",children:[e.jsx(Pe,{validation_data:p}),!!o&&e.jsx("div",{className:"p-2 mb-3 text-sm border rounded-md border-warning/20 text-error",children:e.jsx("div",{className:"relative flex items-end gap-2",children:e.jsxs("div",{children:[e.jsx("h1",{className:"mb-1 text-lg font-semibold text-red-600",children:"***Attention***"}),e.jsx("div",{className:"text-red-400",children:e.jsx("p",{className:" inner-html",dangerouslySetInnerHTML:{__html:oe(o)}})})]})})}),e.jsx("div",{className:"p-2 mb-3 text-sm border border-yellow-100 rounded-md",children:e.jsx("div",{className:"relative flex items-end gap-2",children:e.jsxs("div",{children:[e.jsx("h1",{className:"mb-1 text-lg font-semibold text-yellow-400",children:"Cancellation Policies"}),e.jsx("div",{className:"text-neutral",children:(i=a==null?void 0:a.data)==null?void 0:i.map(r=>{var g,f;return e.jsxs("div",{children:[e.jsx("h1",{className:"font-semibold text-base-content",children:r==null?void 0:r.name}),(f=(g=r==null?void 0:r.cancellation_policies)==null?void 0:g.policy_breakdown)==null?void 0:f.map((j,N)=>e.jsx("p",{className:"text-xs",children:j==null?void 0:j.details},N))]},r==null?void 0:r.room_number)})})]})})}),((b=a==null?void 0:a.data)==null?void 0:b.some(r=>{var g,f,j,N;return((N=(j=(f=(g=r==null?void 0:r.price)==null?void 0:g.purchase)==null?void 0:f.price_breakdown)==null?void 0:j.payable_at_property)==null?void 0:N.length)>0}))&&e.jsx("div",{className:"p-2 mb-3 text-sm border border-blue-100 rounded-md",children:e.jsx("div",{className:"relative flex items-end gap-2",children:e.jsxs("div",{children:[e.jsx("h1",{className:"mb-1 text-lg font-semibold text-blue-400",children:"Payable at Property"}),e.jsx("div",{className:"text-neutral",children:(C=a==null?void 0:a.data)==null?void 0:C.map(r=>{var g,f,j,N,w,_,l,n;return((N=(j=(f=(g=r==null?void 0:r.price)==null?void 0:g.purchase)==null?void 0:f.price_breakdown)==null?void 0:j.payable_at_property)==null?void 0:N.length)>0&&e.jsxs("div",{children:[e.jsx("h1",{className:"font-semibold text-base-content",children:r==null?void 0:r.name}),(n=(l=(_=(w=r==null?void 0:r.price)==null?void 0:w.purchase)==null?void 0:_.price_breakdown)==null?void 0:l.payable_at_property)==null?void 0:n.map(d=>e.jsxs("div",{className:"text-xs",children:[e.jsxs("strong",{children:[d==null?void 0:d.title,":"]})," ",e.jsxs("span",{children:[d==null?void 0:d.currency," ",d==null?void 0:d.amount]})," ",e.jsxs("span",{className:"neutral",children:["(",d==null?void 0:d.remark,")"]})]},d==null?void 0:d.title))]},r==null?void 0:r.room_number)})})]})})}),e.jsxs(we,{className:"w-full mb-8 bg-base-200 border",children:[e.jsxs(D,{isOpen:!0,header:"Enter Guest Details",disabled:!0,children:[e.jsxs("div",{className:"flex items-center gap-4 px-4 pt-2",children:[e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"cursor-pointer label",children:[e.jsx("input",{type:"radio",name:"hotel-checkout-option",className:"mr-2 radio radio-primary radio-sm",checked:!m,onChange:r=>s(!r.target.checked)}),e.jsx("span",{className:"label-text",children:"Primary Guest Only"})]})}),e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"cursor-pointer label",children:[e.jsx("input",{type:"radio",name:"hotel-checkout-option",className:"mr-2 radio radio-primary radio-sm",checked:m,onChange:r=>s(r.target.checked)}),e.jsx("span",{className:"label-text",children:"All Guest"})]})})]}),Array(t.length).fill("").map((r,g)=>{const f=t[g].room,j=Number(t[g].adult),N=t[g].child?Number(t[g].child):0,w=j+N;let _=0,l=0;return e.jsxs("div",{className:"p-3",children:[e.jsxs("h5",{className:"flex items-center px-3 py-2 text-lg font-bold border border-b-0 rounded-t",children:[e.jsx(ge,{className:"mr-1"})," Room ",f]}),e.jsx("div",{className:"p-3 border rounded rounded-t-none",children:e.jsx("div",{className:"flex flex-col gap-8",children:Array(w).fill("").map((n,d)=>{var S,A,E,B;x+=1;const y=d+1<=j?"ADT":"CNN";return _=y==="ADT"?_+1:_,l=y==="CNN"?l+1:l,e.jsx(se,{room_id:f,pax_id:x,pax_type:y,index:d,primaryGuestOnly:!m,pax_age:y==="ADT"?((A=(S=t[g])==null?void 0:S.adult_age)==null?void 0:A[_-1])||"30":((B=(E=t[g])==null?void 0:E.child_age)==null?void 0:B[l-1])||"10"},d)})})})]},g)})]}),e.jsx(D,{isOpen:!0,header:"Enter Primary Guest Contact Details",disabled:!0,children:e.jsx(Ae,{})}),e.jsx(D,{isOpen:!0,header:"Enter Agency Contact Details",disabled:!0,children:e.jsx(Ee,{})}),e.jsx(D,{isOpen:!0,header:"Add Special Requests",disabled:!0,children:e.jsx(Be,{})})]})]})};ae.propTypes={validation_data:R.object.isRequired};const te=({hotel:p,validation_data:t})=>{var j,N,w,_,l;const{search_parameter:c}=t||{},{name:a,address:{full_address:o},primary_photo:x,star_rating:m}=p,{checkIn:s,checkOut:u,occupancies:h}=c,i=h.reduce((n,d)=>n+Number(d.adult),0),b=h.reduce((n,d)=>n+(d.child?Number(d.child):0),0),{system_config:C}=$.useState(),{title:r}=((j=t==null?void 0:t.data)==null?void 0:j.summery)||{},{rate_type:g,bed_option:f}=((w=(N=t==null?void 0:t.data)==null?void 0:N.data)==null?void 0:w.at(0))||{};return e.jsxs("div",{className:"mx-4 overflow-hidden text-sm rounded-lg bg-base-100",children:[e.jsxs("div",{className:"relative before:content-[''] before:absolute before:inset-0 before:bg-gradient-to-b before:from-black/80 before:via-black/20 before:to-transparent booking-summary",children:[e.jsx("img",{src:x,alt:a,className:"w-full min-h-[300px] object-cover object-center"}),e.jsxs("div",{className:"absolute z-10 text-white top-4 left-4",children:[e.jsx("h5",{className:"mb-1 text-xl font-semibold",children:a}),e.jsxs("p",{className:"mb-2 text-warning text-[11px]",children:[Array(Math.floor(m)).fill(0).map((n,d)=>e.jsx(fe,{},d)),e.jsxs("span",{className:"text-white",children:[" (",m," Star)"]})]}),e.jsxs("p",{className:"text-xs text-white/80",children:[e.jsx(je,{className:"mr-1 text-base text-primary"}),o]})]})]}),e.jsxs("div",{className:"p-3",children:[e.jsxs("p",{className:"flex items-center justify-between gap-4 mb-1",children:[e.jsx("span",{children:"Date"}),e.jsxs("span",{children:[K(new Date(s)).format(C.default_date_format_print)," ","to"," ",K(new Date(u)).format(C.default_date_format_print)]})]}),e.jsxs("p",{className:"flex items-center justify-between gap-4 mb-4",children:[e.jsx("span",{children:"Room"}),e.jsx("span",{children:r})]}),e.jsxs("p",{className:"flex items-center justify-end gap-4 mb-2 text-xs",children:[e.jsx("span",{className:"inline-block px-1 rounded bg-neutral/10",children:g}),((_=f==null?void 0:f.at(0))==null?void 0:_.title)&&e.jsx("span",{className:"inline-block px-1 rounded bg-neutral/10",children:(l=f==null?void 0:f.at(0))==null?void 0:l.title})]}),e.jsxs("p",{className:"flex items-center justify-between gap-4 mb-2",children:[e.jsx("span",{children:"Occupancy"}),e.jsxs("span",{children:[h.length," Room(s), ",i," adult(s)"," ",b>0&&`and ${b} children`]})]}),e.jsxs("p",{className:"flex items-center justify-between gap-4 mb-1",children:[e.jsx("span",{className:"fw-medium",children:"Room Fare"}),e.jsx("a",{className:"link-secondary",href:"#",children:e.jsx(ye,{})})]})]})]})};te.propTypes={hotel:R.object.isRequired,search_parameter:R.object.isRequired};const re=({isExpired:p,isChecked:t,hold_possible:c})=>{const{special_requests:a,special_requests_notes:o,...x}=k.useState(y=>y),{axiosInstance:m}=z(),[s,u]=q.useState(!1),{user_data:{member_id:h,login_key:i}}=P.useState(),{tracking_id:b,passenger:C}=I.useState(y=>y),r=a.filter(y=>y.requested).map(y=>y.label).join(", "),g=Ne(),f=de(),{data:j,isLoading:N,isError:w}=Q({queryKey:["SERVICE_STATUS",i,h],queryFn:async()=>{var y;try{const S=await m.post("/reports/service-status",{login_key:i,member_id:h});return((y=S==null?void 0:S.data)==null?void 0:y.service_status)||null}catch(S){console.error(S)}}}),_=async()=>{var y,S,A,E,B;if(!s)try{if(u(!0),t.terms_conditions===!1)throw new Error("Please accept Terms & Conditions");if(t.cancellation_policy===!1)throw new Error("Please accept Cancellation Policy");if(t.rate_terms===!1)throw new Error("Please accept Rate Terms");const F=await m.post("/user/profile",JSON.parse(localStorage.getItem("user_info")));if(!F.data||((y=F.data)==null?void 0:y.status)!=="success"){localStorage.removeItem("user_info"),P.update(v=>{v.token=null,v.user_data=null}),f.invalidateQueries(["SITE_CONFIG"]);return}const ne={tracking_id:b,member_id:h,passenger:Object.values(C)},T=await m.post("/hotel/update-travelers",ne);if(((S=T==null?void 0:T.data)==null?void 0:S.status)==="success")try{const v=await m.post("/hotel/create-booking",{...x,member_id:h,special_requests_notes:`${r?`${r}, `:""} ${o}`.trim()||"n/a"});if(((A=v==null?void 0:v.data)==null?void 0:A.status)==="success")(B=(E=v==null?void 0:v.data)==null?void 0:E.general)!=null&&B.tracking_id?(g(`/booking-details/hotel?tracking_id=${v.data.general.tracking_id}`,{replace:!0}),M("success","Booking Successful",v.data.reason),I.replace(I._getInitialState()),k.replace(k._getInitialState()),Y.replace(Y._getInitialState())):(M("success","Hey buddy! One more step","Please pay now"),setTimeout(()=>{var H;window.location.replace((H=v==null?void 0:v.data)==null?void 0:H.payment_link)},1e3));else throw new Error(v.data.reason)}catch(v){(await X.fire({title:"Booking Failed!",html:v.message,icon:"error",showCancelButton:!1,showCloseButton:!1,confirmButtonColor:"hsl(var(--p)/1)",confirmButtonText:"Go Back",allowOutsideClick:!1})).isConfirmed&&g(-1,{replace:!0})}else throw new Error(T==null?void 0:T.data.reason)}catch(F){console.error(F),M("error","Failed!",F.message)}finally{u(!1)}};if(N)return e.jsxs("button",{className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",children:[e.jsx(V,{className:"mr-2 animate-spin"})," Loading..."]});if(w)return null;const{block_status:l,hotel_block:n,reason:d}=j;return l==="yes"&&n==="yes"?e.jsx("div",{className:"p-3 text-sm border rounded-lg border-error bg-error/10",children:e.jsx("p",{className:"text-error inner-html",dangerouslySetInnerHTML:{__html:d}})}):x!=null&&x.payment_type?e.jsx(e.Fragment,{children:x.payment_type==="account_balance"?e.jsx("button",{onClick:_,className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",disabled:p,children:s?e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"mr-2 animate-spin"})," Loading..."]}):c==="yes"?"Hold Booking":"Confirm Booking"}):e.jsx("button",{onClick:_,disabled:p,className:"w-full btn btn-lg btn-primary btn-outline holdFlightBtn",children:s?e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"mr-2 animate-spin"})," Loading..."]}):"Pay and Reserve"})}):e.jsx("div",{className:"p-3 text-sm border rounded-lg border-error bg-error/10",children:e.jsx("p",{className:"text-error",children:"You don't have enough balance."})})};re.propTypes={isExpired:R.bool.isRequired,isChecked:R.object,hold_possible:R.string.isRequired};const le=({hotel:p,validation_data:t})=>{var j,N,w,_;const{session_expire:c}=t,{currency:a,sell_total_price:o,total_amount:x,hold_possible:m}=((j=t==null?void 0:t.data)==null?void 0:j.summery)||{},{user_data:s}=P.useState(),{payment_type:u}=k.useState(),h=(_=(w=(N=t==null?void 0:t.data)==null?void 0:N.data)==null?void 0:w.at(0))==null?void 0:_.rate_terms,[i,b]=q.useState({terms_conditions:!1,cancellation_policy:!1,rate_terms:!h}),[C,r]=q.useState(!1),{price_view:{online_payment_option:g}={}}=$.useState();q.useEffect(()=>{x>(s==null?void 0:s.balance)&&m==="no"&&(g==="YES"?k.update(l=>{l.payment_type="card"}):k.update(l=>{l.payment_type=null}))},[x,s==null?void 0:s.balance,m,g]);const f=l=>{x>(s==null?void 0:s.balance)&&m==="no"?(l.preventDefault(),l.target.value==="account_balance"?M("error","Insufficient Balance","Please add balance to your account"):l.target.click()):k.update(n=>{n.payment_type=l.target.value})};return e.jsxs("div",{className:"sticky py-4 rounded-lg bg-base-200 h-fit top-5",children:[e.jsx(te,{hotel:p,validation_data:t}),e.jsx(W,{}),e.jsx(Te,{session_expire:c,action:l=>r(l)}),e.jsx(W,{}),e.jsxs("div",{className:"px-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 mb-3 rounded-lg bg-primary/10 text-primary",children:[e.jsx("p",{children:"Total payable"}),e.jsxs("p",{className:"text-lg font-bold",children:[me(a)," ",o]})]}),e.jsxs("div",{className:"grid gap-3 mb-3 sm:grid-flow-col lg:grid-flow-row xl:grid-flow-col payment-selection",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("input",{autoComplete:"off",type:"radio",className:"absolute -translate-y-1/2 radio radio-xs radio-primary left-2 top-1/2 peer",name:"payment",id:"balance",value:"account_balance",defaultChecked:u==="account_balance",onClick:f}),e.jsx("label",{htmlFor:"balance",className:"block px-2 py-4 pl-8 text-nowrap bg-primary/10 peer-checked:bg-primary peer-checked:text-white",children:"Account Balance"})]}),g==="ACTIVE"&&e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("input",{autoComplete:"off",type:"radio",className:"absolute -translate-y-1/2 radio radio-primary radio-xs top-1/2 left-2 peer",name:"payment",id:"card",value:"card",defaultChecked:u==="card",onClick:f}),e.jsxs("label",{className:"block px-2 py-4 pl-8 bg-primary/10 peer-checked:bg-primary peer-checked:text-white",htmlFor:"card",children:["Card ",e.jsx(_e,{className:"ml-1"})]})]})]}),e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",value:"",id:"terms",onChange:l=>b({...i,terms_conditions:l.target.checked})}),e.jsxs("label",{className:"text-sm font-medium form-check-label",htmlFor:"terms",children:["I have read and accept"," ",e.jsx("a",{href:"#",className:"text-primary",children:"Terms & Conditions"})]})]}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",value:"",id:"policies",onChange:l=>b({...i,cancellation_policy:l.target.checked})}),e.jsxs("label",{className:"text-sm font-medium form-check-label",htmlFor:"policies",children:["I agree and understand"," ",e.jsx("a",{href:"#",className:"text-primary",children:"Cancellation Policies"})]})]}),!!h&&e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{autoComplete:"off",className:"rounded checkbox checkbox-xs checkbox-primary",type:"checkbox",value:"",id:"rate_terms",onChange:l=>b({...i,rate_terms:l.target.checked})}),e.jsx("label",{className:"text-sm font-medium form-check-label",htmlFor:"rate_terms",children:h})]}),e.jsx(re,{isExpired:C,isChecked:i,hold_possible:m})]})]})};le.propTypes={hotel:R.object.isRequired,validation_data:R.object.isRequired};const Ze=()=>{const{site_title:p}=$.useState(),[t]=ke(),c=t.get("booking_tracking_id"),{axiosInstance:a}=z(),{user_data:{member_id:o}}=P.useState(),{data:x,isLoading:m,error:s}=Q(["HOTEL_VALIDATE",c,o],async()=>{var b,C;const i=await a.post("/hotel/validation-price-get-detail",{member_id:o,booking_tracking_id:c});if(((b=i.data)==null?void 0:b.status)==="success")return i.data;throw{...i,message:((C=i.data)==null?void 0:C.reason)||"Request failed!"}});if(q.useEffect(()=>{I.update(i=>{i.tracking_id=c}),k.update(i=>{i.tracking_id=c})},[c]),m)return e.jsx(ue,{});if(s)throw s;const{hotel_contents:u,...h}=x||{};return e.jsxs("main",{className:"container min-h-screen pt-20",children:[e.jsx(pe,{children:e.jsxs("title",{children:["Hotel Checkout",p?" - "+p:""]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 mb-8 lg:grid-cols-3",children:[e.jsx(ae,{validation_data:x}),e.jsx(le,{hotel:u==null?void 0:u.data,validation_data:h})]})]})};export{Ze as default};
